<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Protecting a non-forging node - Lisk  SDK  Docs</title>
    <link rel="canonical" href="https://lisk.io/documentation/lisk-sdk/guides/node-management/non-forging-node-protection.html">
    <meta name="generator" content="Antora 2.3.4">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <link rel="stylesheet" href="../../../_/css/site-extra.css">
      <link rel="stylesheet" href="../../../_/css/vendor/docsearch.min.css">
      <!-- fetched from https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css -->
<script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<link rel="icon" href="../../../_/img/favicon.png" type="image/x-icon">
  </head>
  <body class="article">
<script data-cookieconsent="ignore" type="text/javascript" id="GTM">(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({"gtm.start":
          new Date().getTime(),event:"gtm.js"});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!="dataLayer"?"&amp;l="+l:"";j.async=true;
  j.crossOrigin="anonymous";j.src=
          "https://www.googletagmanager.com/gtm.js?id="+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,"script","dataLayer","GTM-NKNKGHL");</script>

<script type="text/javascript" id="Cookiebot" src="https://consent.cookiebot.com/uc.js" data-cbid="e4db29b5-cd94-4bcf-87e4-04f4ca564240" data-blockingmode="manual"></script>
<header class="header">
  <nav class="navbar">
      <div class="navbar-content">
        <div class="navbar-brand">
          <a href="https://lisk.io" title="Lisk.io" class="lisk-logo"></a>
            <span  class="nav-brand__name-area">
              <strong class="nav-brand__name-area__title">SDK</strong>
                        </span>
          <div class="top-versions page-versions">
  <button class="version-menu-toggle top-version-menu-toggle" title="Show other versions of page">5.0.5 (latest)</button>
  <div class="version-menu">
    <a class="version is-current" href="non-forging-node-protection.html">5.0.5 (latest)</a>
    <a class="version is-missing" href="../../v4/index.html">4.0.0</a>
    <a class="version is-missing" href="../../v3/index.html">3.0.2</a>
    <a class="version is-missing" href="../../v2/index.html">2.3.8</a>
  </div>
</div>
          <button class="navbar-burger" data-target="topbar-nav">
            <span></span>
            <span></span>
            <span></span>
          </button>
        </div>
        <div id="topbar-nav" class="navbar-menu">
          <div class="navbar-end">
            <div class="navbar-item has-dropdown is-hoverable">
              <a class="navbar-link" href="">Documentations</a>
              <div class="navbar-dropdown">
                <a class="navbar-item" href="https://lisk.io/documentation/lisk-sdk/">Lisk SDK</a>
                <a class="navbar-item" href="https://lisk.io/documentation/lisk-service/">Lisk Service</a>
                <a class="navbar-item" href="https://lisk.io/documentation/lisk-core/">Lisk Core</a>
              </div>
            </div>
            <div class="navbar-item has-dropdown is-hoverable">
              <a class="navbar-link" href="">Resources</a>
              <div class="navbar-dropdown">
                <a class="navbar-item" href=""><strong>Lisk Service API</strong></a>
                <a class="navbar-item" href="https://lisk.io/documentation/lisk-service/references/api.html">Mainnet</a>
                <a class="navbar-item" href="https://lisk.io/documentation/lisk-service/references/api-testnet.html">Testnet</a>
                <a class="navbar-item" href="https://lisk.io/documentation/lisk-service/references/api-betanet.html">Betanet</a>
                <hr class="navbar-divider">
                <a class="navbar-item" href=""><strong>Lisk Network Explorer</strong></a>
                <a class="navbar-item" target="_blank" href="https://lisk.observer/">Lisk Observer<i class="icofont-external-link"></i></a>
                <a class="navbar-item" target="_blank" href="https://liskscan.io/">LISKscan<i class="icofont-external-link"></i></a>
              </div>
            </div>
          </div>
            <div class="navbar-menu search-box hide-for-print">
              <input id="search-input" type="text" placeholder="Search">
            </div>
        </div>
        <div class="navbar-item navbar-right">
<!--
          <a href="https://lisk.chat" title="Lisk Chat" target="_blank" class="footer__icon icon-discord-2x"></a>
-->
          <a href="https://github.com/LiskHQ" title="Lisk GitHub" target="_blank" class="footer__icon icon-github-2x"></a>
          <span class="control">
            <a class="button is-primary" target="_blank" title="Lisk Dev Forum" href="https://dev.lisk.io/">Get help</a>
          </span>
        </div>
      </div>
  </nav>
</header>
<div class="body-container">
  <div class="body">
<div class="nav-container" data-component="lisk-sdk" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../../index.html">Lisk SDK</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Introduction</span>
<ul class="nav-list">
  <li class="nav-item single-page" data-depth="2">
    <a class="nav-link" href="../../index.html">What is the Lisk SDK?</a>
  </li>
  <li class="nav-item single-page" data-depth="2">
    <a class="nav-link" href="../../quickstart.html">Quickstart</a>
  </li>
  <li class="nav-item single-page" data-depth="2">
    <a class="nav-link" href="../../architecture/index.html">Architectural overview</a>
  </li>
  <li class="nav-item single-page" data-depth="2">
    <a class="nav-link" href="../../architecture/on-chain-architecture.html">On-chain architecture</a>
  </li>
  <li class="nav-item single-page" data-depth="2">
    <a class="nav-link" href="../../architecture/off-chain-architecture.html">Off-chain architecture</a>
  </li>
  <li class="nav-item single-page" data-depth="2">
    <a class="nav-link" href="../../architecture/communication-architecture.html">Communication Architecture</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Development guides</span>
<ul class="nav-list">
  <li class="nav-item single-page" data-depth="2">
    <a class="nav-link" href="../app-development/setup.html">Creating a new blockchain application</a>
  </li>
  <li class="nav-item single-page" data-depth="2">
    <a class="nav-link" href="../app-development/module.html">Creating a new module</a>
  </li>
  <li class="nav-item single-page" data-depth="2">
    <a class="nav-link" href="../app-development/asset.html">Creating a custom asset</a>
  </li>
  <li class="nav-item single-page" data-depth="2">
    <a class="nav-link" href="../app-development/plugin.html">Creating a new plugin</a>
  </li>
  <li class="nav-item single-page" data-depth="2">
    <a class="nav-link" href="../app-development/configuration.html">Configuring a blockchain application</a>
  </li>
  <li class="nav-item single-page" data-depth="2">
    <a class="nav-link" href="../app-development/genesis-block.html">Generating a genesis block</a>
  </li>
  <li class="nav-item single-page" data-depth="2">
    <a class="nav-link" href="../app-development/frontend.html">Communicating with a frontend</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Management guides</span>
<ul class="nav-list">
  <li class="nav-item is-current-page single-page" data-depth="2">
    <a class="nav-link" href="non-forging-node-protection.html">Protecting a non-forging node</a>
  </li>
  <li class="nav-item single-page" data-depth="2">
    <a class="nav-link" href="forging-node-protection.html">Protecting a forging node</a>
  </li>
  <li class="nav-item single-page" data-depth="2">
    <a class="nav-link" href="forging.html">Enabling forging</a>
  </li>
  <li class="nav-item single-page" data-depth="2">
    <a class="nav-link" href="logging.html">Managing logs</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Tutorials</span>
<ul class="nav-list">
  <li class="nav-item single-page" data-depth="2">
    <a class="nav-link" href="../../tutorials/index.html">Tutorials overview</a>
  </li>
  <li class="nav-item single-page" data-depth="2">
    <a class="nav-link" href="../../tutorials/hello-world.html">Hello World</a>
  </li>
  <li class="nav-item single-page" data-depth="2">
    <a class="nav-link" href="../../tutorials/nft.html">Non-fungible token (NFT)</a>
  </li>
  <li class="nav-item single-page" data-depth="2">
    <a class="nav-link" href="../../tutorials/srs.html">Social Recovery System (SRS)</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">References</span>
<ul class="nav-list">
  <li class="nav-item single-page" data-depth="2">
    <a class="nav-link" href="../../references/schemas.html">Schemas</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Lisk Commander</span>
<ul class="nav-list">
  <li class="nav-item single-page" data-depth="3">
    <a class="nav-link" href="../../references/lisk-commander/index.html">What is Lisk Commander?</a>
  </li>
  <li class="nav-item single-page" data-depth="3">
    <a class="nav-link" href="../../references/lisk-commander/commands.html">Commands</a>
  </li>
  <li class="nav-item single-page" data-depth="3">
    <a class="nav-link" href="../../references/lisk-commander/sensitive-inputs.html">Sensitive inputs</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Lisk Elements</span>
<ul class="nav-list">
  <li class="nav-item single-page" data-depth="3">
    <a class="nav-link" href="../../references/lisk-elements/index.html">What is Lisk Elements?</a>
  </li>
  <li class="nav-item single-page" data-depth="3">
    <a class="nav-link" href="../../references/lisk-elements/api-client.html">API client</a>
  </li>
  <li class="nav-item single-page" data-depth="3">
    <a class="nav-link" href="../../references/lisk-elements/bft.html">BFT</a>
  </li>
  <li class="nav-item single-page" data-depth="3">
    <a class="nav-link" href="../../references/lisk-elements/chain.html">Chain</a>
  </li>
  <li class="nav-item single-page" data-depth="3">
    <a class="nav-link" href="../../references/lisk-elements/client.html">Client</a>
  </li>
  <li class="nav-item single-page" data-depth="3">
    <a class="nav-link" href="../../references/lisk-elements/codec.html">Codec</a>
  </li>
  <li class="nav-item single-page" data-depth="3">
    <a class="nav-link" href="../../references/lisk-elements/cryptography.html">Cryptography</a>
  </li>
  <li class="nav-item single-page" data-depth="3">
    <a class="nav-link" href="../../references/lisk-elements/db.html">DB</a>
  </li>
  <li class="nav-item single-page" data-depth="3">
    <a class="nav-link" href="../../references/lisk-elements/genesis.html">Genesis</a>
  </li>
  <li class="nav-item single-page" data-depth="3">
    <a class="nav-link" href="../../references/lisk-elements/p2p.html">P2P</a>
  </li>
  <li class="nav-item single-page" data-depth="3">
    <a class="nav-link" href="../../references/lisk-elements/passphrase.html">Passphrase</a>
  </li>
  <li class="nav-item single-page" data-depth="3">
    <a class="nav-link" href="../../references/lisk-elements/transaction-pool.html">Transaction pool</a>
  </li>
  <li class="nav-item single-page" data-depth="3">
    <a class="nav-link" href="../../references/lisk-elements/transactions.html">Transactions</a>
  </li>
  <li class="nav-item single-page" data-depth="3">
    <a class="nav-link" href="../../references/lisk-elements/tree.html">Tree</a>
  </li>
  <li class="nav-item single-page" data-depth="3">
    <a class="nav-link" href="../../references/lisk-elements/utils.html">Utils</a>
  </li>
  <li class="nav-item single-page" data-depth="3">
    <a class="nav-link" href="../../references/lisk-elements/validator.html">Validator</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Lisk Framework</span>
<ul class="nav-list">
  <li class="nav-item single-page" data-depth="3">
    <a class="nav-link" href="../../references/lisk-framework/index.html">Framework interfaces</a>
  </li>
  <li class="nav-item single-page" data-depth="3">
    <a class="nav-link" href="../../rpc-endpoints.html">RPC endpoints</a>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Default modules</span>
<ul class="nav-list">
  <li class="nav-item single-page" data-depth="4">
    <a class="nav-link" href="../../token-module.html">Token module</a>
  </li>
  <li class="nav-item single-page" data-depth="4">
    <a class="nav-link" href="../../sequence-module.html">Sequence module</a>
  </li>
  <li class="nav-item single-page" data-depth="4">
    <a class="nav-link" href="../../keys-module.html">Keys module</a>
  </li>
  <li class="nav-item single-page" data-depth="4">
    <a class="nav-link" href="../../dpos-module.html">DPoS module</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Default plugins</span>
<ul class="nav-list">
  <li class="nav-item single-page" data-depth="4">
    <a class="nav-link" href="../../references/lisk-framework/http-api-plugin.html">HTTP API plugin</a>
  </li>
  <li class="nav-item single-page" data-depth="4">
    <a class="nav-link" href="../../references/lisk-framework/forger-plugin.html">Forger plugin</a>
  </li>
  <li class="nav-item single-page" data-depth="4">
    <a class="nav-link" href="../../references/lisk-framework/report-misbehavior-plugin.html">Report misbehavior plugin</a>
  </li>
  <li class="nav-item single-page" data-depth="4">
    <a class="nav-link" href="../../references/lisk-framework/monitor-plugin.html">Monitor plugin</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item single-page" data-depth="2">
    <a class="nav-link" href="../../references/glossary.html">Glossary and Abbreviations</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Lisk protocol</span>
<ul class="nav-list">
  <li class="nav-item single-page" data-depth="2">
    <a class="nav-link" href="../../protocol/index.html">What is the Lisk protocol?</a>
  </li>
  <li class="nav-item single-page" data-depth="2">
    <a class="nav-link" href="../../protocol/accounts.html">Accounts</a>
  </li>
  <li class="nav-item single-page" data-depth="2">
    <a class="nav-link" href="../../protocol/transactions.html">Transactions</a>
  </li>
  <li class="nav-item single-page" data-depth="2">
    <a class="nav-link" href="../../protocol/blocks.html">Blocks</a>
  </li>
  <li class="nav-item single-page" data-depth="2">
    <a class="nav-link" href="../../protocol/consensus-algorithm.html">Consensus algorithm</a>
  </li>
  <li class="nav-item single-page" data-depth="2">
    <a class="nav-link" href="../../protocol/network.html">Network</a>
  </li>
  <li class="nav-item single-page" data-depth="2">
    <a class="nav-link" href="../../protocol/appendix.html">Appendix</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Lisk SDK</span>
    <span class="version">5.0.5 (latest)</span>
  </div>
  <ul class="components">
    <li class="component">
      <span class="title">Lisk Core</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../lisk-core/index.html">2.1.6 (latest)</a>
        </li>
        <li class="version">
          <a href="../../../lisk-core/v3/index.html">3.0.0-beta.6</a>
        </li>
        <li class="version">
          <a href="../../../lisk-core/v3-beta.1/index.html">3.0.0-beta.1</a>
        </li>
        <li class="version">
          <a href="../../../lisk-core/v3-beta.0/index.html">3.0.0-beta.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Lisk docs manual</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../lisk-docs-manual/index.html">0.1.0</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <span class="title">Lisk SDK</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../../index.html">5.0.5 (latest)</a>
        </li>
        <li class="version">
          <a href="../../v4/index.html">4.0.0</a>
        </li>
        <li class="version">
          <a href="../../v3/index.html">3.0.2</a>
        </li>
        <li class="version">
          <a href="../../v2/index.html">2.3.8</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Lisk Service</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../lisk-service/index.html">0.3.0 (latest)</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article main">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../index.html" title="Home" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../index.html">Lisk SDK</a></li>
    <li>Management guides</li>
    <li><a href="non-forging-node-protection.html">Protecting a non-forging node</a></li>
  </ul>
</nav>
  <div class="page-versions toolbar-versions">
  <button class="version-menu-toggle" title="Show other versions of page">5.0.5 (latest)</button>
  <div class="version-menu">
    <a class="version is-current" href="non-forging-node-protection.html">5.0.5 (latest)</a>
    <a class="version is-missing" href="../../v4/index.html">4.0.0</a>
    <a class="version is-missing" href="../../v3/index.html">3.0.2</a>
    <a class="version is-missing" href="../../v2/index.html">2.3.8</a>
  </div>
</div>
  <div class="edit-this-page"><a href="https://github.com/LiskHQ/lisk-docs/edit/1075-update-setup-guide/modules/ROOT/pages/guides/node-management/non-forging-node-protection.adoc"><i class="icofont-ui-edit"></i>Edit this Page</a></div>
  </div>
  <div class="content">
<article class="doc">
<h1 class="page">Protecting a non-forging node</h1>
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#setting-up-a-blockchain-application-behind-a-reverse-proxy">Setting up a blockchain application behind a reverse proxy</a>
<ul class="sectlevel2">
<li><a href="#ssl-termination">SSL Termination</a></li>
<li><a href="#rate-limiting">Rate Limiting</a></li>
<li><a href="#multiple-backends">Multiple Backends</a></li>
</ul>
</li>
</ul>
</div>
<div class="sect1">
<h2 id="setting-up-a-blockchain-application-behind-a-reverse-proxy"><a class="anchor" href="#setting-up-a-blockchain-application-behind-a-reverse-proxy"></a>Setting up a blockchain application behind a reverse proxy</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Sometimes, it&#8217;s desirable to run a blockchain application behind a reverse proxy for SSL termination, rate limiting and other reasons.</p>
</div>
<div class="paragraph">
<p><strong>We highly recommended running a reverse proxy for a public web service</strong></p>
</div>
<div class="paragraph">
<p><a href="http://www.haproxy.org/" target="_blank" rel="noopener">HAProxy</a> is one such reverse proxy.</p>
</div>
<div class="paragraph">
<p>An HAProxy configuration has 4 sections, <a href="https://www.haproxy.com/blog/the-four-essential-sections-of-an-haproxy-configuration/" target="_blank" rel="noopener">explained here </a>.
The sections that we are concerned with here are <code>frontend</code> and <code>backend</code>.
We&#8217;ll start out with a very basic config snippet and then build up.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For this example to work, it is assumed that the application uses the default configuration for the WebSocket port, which is <code>8080</code>.</p>
</div>
<div class="paragraph">
<p>If you configured a different port, replace <code>8080</code> with it in the below example.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">frontend f_lisk
        mode http
        bind :80 <i class="conum" data-value="1"></i><b>(1)</b>
        use_backend b_lisk_ws <i class="conum" data-value="2"></i><b>(2)</b>
backend b_lisk_ws
        server lisk_ws 127.0.0.1:8080 <i class="conum" data-value="3"></i><b>(3)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>A new <code>bind</code> line is added, creates a listener on port 80.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>use_backend</code> defines the backend which responds to incoming requests.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td><code>server</code> sets the backend server and expects a name as first argument, and the IP and port as second argument.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This does nothing more than proxy requests coming in at port 80 to your blockchain application WebSocket port.</p>
</div>
<div class="sect2">
<h3 id="ssl-termination"><a class="anchor" href="#ssl-termination"></a>SSL Termination</h3>
<div class="paragraph">
<p>We can add SSL termination by telling it to listen on port 443 and specifying the certificate in the frontend section:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">frontend f_lisk
        mode http
        bind [::]:443 ssl crt /etc/haproxy/ssl/cert.pem alpn h2,http/1.1 <i class="conum" data-value="1"></i><b>(1)</b>
        bind [::]:80 <i class="conum" data-value="2"></i><b>(2)</b>
        http-response set-header Strict-Transport-Security max-age=15768000 <i class="conum" data-value="3"></i><b>(3)</b>
        redirect scheme https code 301 <i class="conum" data-value="4"></i><b>(4)</b>
        use_backend b_lisk_ws</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>A new <code>bind</code> line is added, which
<div class="ulist">
<ul>
<li>
<p>Listens on port 443</p>
</li>
<li>
<p>Specifies the SSL certificate</p>
</li>
<li>
<p>Enables the <a href="../../references/glossary.html#tls-alpn-transport-layer-security-application-layer-protocol-negotiation" class="page">TLS ALPN</a> extension, as described in the HAProxy documentation <a href="https://www.haproxy.com/documentation/aloha/12-5/traffic-management/lb-layer7/tls/" class="bare">https://www.haproxy.com/documentation/aloha/12-5/traffic-management/lb-layer7/tls/</a></p>
</li>
</ul>
</div></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The <code>bind</code> lines were changed so that HAProxy will also listen on ipv6.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The <code>Strict-Transport-Security</code> response header is set to tell web browsers to only access this site over HTTPS</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>A permanent redirect is created for anyone connecting over http to connect via https</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="rate-limiting"><a class="anchor" href="#rate-limiting"></a>Rate Limiting</h3>
<div class="paragraph">
<p>HAProxy is very configurable when it comes to rate limiting.
We&#8217;ll provide a specific example here.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Recommended additional reading:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.haproxy.com/blog/four-examples-of-haproxy-rate-limiting/" class="bare">https://www.haproxy.com/blog/four-examples-of-haproxy-rate-limiting/</a> is a good starting point for further investigation.</p>
</li>
<li>
<p><a href="https://www.haproxy.com/blog/use-haproxy-response-policies-to-stop-threats/" class="bare">https://www.haproxy.com/blog/use-haproxy-response-policies-to-stop-threats/</a></p>
</li>
<li>
<p><a href="https://www.haproxy.com/blog/bot-protection-with-haproxy/" class="bare">https://www.haproxy.com/blog/bot-protection-with-haproxy/</a></p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">frontend f_lisk
        mode http
        bind [::]:443 ssl crt /etc/haproxy/ssl/cert.pem alpn h2,http/1.1
        bind [::]:80
        http-response set-header Strict-Transport-Security max-age=15768000
        redirect scheme https code 301
        rate-limit sessions 500 <i class="conum" data-value="1"></i><b>(1)</b>
        stick-table type ipv6 size 200k expire 10m store gpc0 <i class="conum" data-value="2"></i><b>(2)</b>
        acl repeat_abuses src_get_gpc0(f_lisk) gt 2 <i class="conum" data-value="3"></i><b>(3)</b>
        tcp-request content track-sc0 src <i class="conum" data-value="4"></i><b>(4)</b>
        tcp-request content reject if repeat_abuses <i class="conum" data-value="5"></i><b>(5)</b>
        use_backend b_lisk_ws
backend b_lisk_ws
        stick-table type ipv6 size 200k expire 2m store conn_rate(10s) <i class="conum" data-value="6"></i><b>(6)</b>
        tcp-request content track-sc1 src <i class="conum" data-value="7"></i><b>(7)</b>
        acl exceeds_conn_rate sc1_conn_rate gt 50 <i class="conum" data-value="8"></i><b>(8)</b>
        acl mark_repeat_abuses sc0_inc_gpc0 gt 0 <i class="conum" data-value="9"></i><b>(9)</b>
        http-request deny deny_status 429 if exceeds_conn_rate mark_repeat_abuses <i class="conum" data-value="10"></i><b>(10)</b>
        server lisk_ws 127.0.0.1:8080</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is a bit of a 3-pronged approach to rate limiting.
<code>rate-limit sessions 500</code> limits the number of new sessions per second.
New sessions are queued and accepted in line with the set value, which can be adjusted as needed.</p>
</div>
<div class="paragraph">
<p>The rest of the changes here tell HAProxy to track the connection rate (over a rolling 10 seconds) of up 200k connecting IP addresses, the entries of which will expire after 2 minutes.
If the connection rate of an IP exceeds 50 connections per 10 seconds, a 429 response gets returned and a global counter for that IP gets incremented, to track repeat abuses.
If an IP exceeds this threshold more than twice in a 10 minute period, new connections from that IP will get silently dropped.</p>
</div>
</div>
<div class="sect2">
<h3 id="multiple-backends"><a class="anchor" href="#multiple-backends"></a>Multiple Backends</h3>
<div class="paragraph">
<p>So far, the examples have been just for proxying the Lisk WebSocket RPC endpoint.
The example below will proxy both the WebSocket RPC endpoint and the HTTP API endpoint by hostname (<code>http.lisk.example</code> is a placeholder for whatever your domain is).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For this example to work, it is assumed that the application has the <a href="../../references/lisk-framework/http-api-plugin.html" class="page">HTTP API plugin</a> enabled with the HTTP port set to 4000 (which is the default value).</p>
</div>
<div class="paragraph">
<p>If you configured a different port, replace <code>4000</code> with it in the below example.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can have multiple backends that get served using all kinds of different criteria.
Commonly, this is by <code>Host</code> header to serve more than one site.
We&#8217;ll do this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">frontend f_lisk
        mode http
        bind [::]:443 ssl crt /etc/haproxy/ssl/cert.pem alpn h2,http/1.1
        bind [::]:80
        http-response set-header Strict-Transport-Security max-age=15768000
        redirect scheme https code 301
        rate-limit sessions 500
        stick-table type ipv6 size 200k expire 10m store gpc0
        acl repeat_abuses src_get_gpc0(f_lisk) gt 2
        tcp-request content track-sc0 src
        tcp-request content reject if repeat_abuses
        acl host_http hdr(host) http.lisk.example
        use_backend b_lisk_http if host_http
    default_backend b_lisk_ws
backend b_lisk_ws
        stick-table type ipv6 size 200k expire 2m store conn_rate(10s)
        tcp-request content track-sc1 src
        acl exceeds_conn_rate sc1_conn_rate gt 50
        acl mark_repeat_abuses sc0_inc_gpc0 gt 0
        http-request deny deny_status 429 if exceeds_conn_rate mark_repeat_abuses
        server lisk_ws 127.0.0.1:8080
backend b_lisk_http
        stick-table type ipv6 size 200k expire 2m store conn_rate(10s)
        tcp-request content track-sc2 src
        acl exceeds_conn_rate sc2_conn_rate gt 50
        acl mark_repeat_abuses sc0_inc_gpc0 gt 0
        http-request deny deny_status 429 if exceeds_conn_rate mark_repeat_abuses
        server lisk_http 127.0.0.1:4000</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If you use multiple domains with SSL termination, your certificate will either have to be for those multiple domains or you will have to have multiple certificates, which can be specified with <code>crt-list</code> instead of <code>crt</code> (<a href="https://www.haproxy.com/documentation/aloh" class="bare">https://www.haproxy.com/documentation/aloh</a>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
    <div class="bottom-links">
    <div>
      <a class="bottom-link" href="/documentation/lisk-sdk/guides/app-development/frontend.html"><i class="icofont-double-left icofont-3x"></i>Communicating with a frontend
    </a>
    </div><div>
      <a class="bottom-link" href="/documentation/lisk-sdk/guides/node-management/forging-node-protection.html">Protecting a forging node<i class="icofont-double-right icofont-3x"></i>
      </a>
    </div>
  </div>






<!--{]> pagination}}-->
</article>
<aside class="article-aside hidden" role="navigation">
</aside>


<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
  </div>
</div>
<footer class="footer">
    <div class="footer__container">
        <div class="footer__copyright">
            <div class="institutional-links-2">
                <span class="institutional-links-2__item">Â© 2021 Lisk Foundation</span>
              <ul class="footer-links">
                <li><a class="institutional-links-2__item" href="https://lisk.io/terms-conditions" class="institutional-links-2-item">Terms & Conditions</a></li>
                <li><a class="institutional-links-2__item" href="https://lisk.io/privacy" class="institutional-links-2-item">Privacy Policy</a></li>
                <li><a class="institutional-links-2__item" href="https://lisk.io/contact" class="institutional-links-2-item">Contact</a></li>
              </ul>
            </div>
            <p class="footer__copyright-text">Lisk is a foundation registered in Zug, Switzerland
            </p>
        </div>
        <div class="footer__logo-container">
            <img src="../../../_/img/lisk-logo-light.svg" class="footer__lisk-logo"/>
        </div>
        <div class="community-section">
            <p class="community-section__text">Follow Lisk on: </p>
            <div class="community-section__icons">
                <a href="https://github.com/LiskHQ" title="GitHub" target="_blank" class="footer__icon icon-github"></a>
                <a href="https://twitter.com/LiskHQ" title="Twitter" target="_blank" class="footer__icon icon-twitter"></a>
                <a href="https://lisk.chat" title="Discord" target="_blank" class="footer__icon icon-discord"></a>
                <a href="https://www.reddit.com/r/Lisk/" title="Reddit" target="_blank" class="footer__icon icon-reddit"></a>
                <a href="https://www.facebook.com/LiskHQ" title="Facebook" target="_blank" class="footer__icon icon-facebook"></a>
            </div>
        </div>
    </div>
</footer>
<script src="../../../_/js/site.js"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
<script async src="../../../_/js/vendor/tabs-block-behaviour.js"></script>
<script async src="../../../_/js/vendor/top-versions.js"></script>
<script async src="../../../_/js/vendor/custom.js"></script>
  <script src="../../../_/js/vendor/docsearch.min.js"></script>
  <!-- fetched from https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js -->
  <script>
    function focusSearchInput () { document.querySelector('#search-input').focus() }
    var search = docsearch({
        appId: 'C4SU57KGV9',
      apiKey: '55aa8709b04eb62f08f87571cf77547c',
      indexName: 'lisk-docs-search',
      inputSelector: '#search-input',
      autocompleteOptions: { hint: false, keyboardShortcuts: ['s'] },
      algoliaOptions: { hitsPerPage: 10 }
    }).autocomplete
    search.on('autocomplete:closed', function () { search.autocomplete.setVal() })
    focusSearchInput()
    window.addEventListener('load', focusSearchInput)
  </script>

  </body>
</html>
