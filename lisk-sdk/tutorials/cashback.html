<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Cashback Tutorial :: Docs</title>
    <link rel="canonical" href="https://lisk.io/documentation/lisk-sdk/tutorials/cashback.html">
    <meta name="description" content="The Lisk Cashback tutorial teaches the user how to create a custom transaction based on an already existing transaction type and how to register it with the node application. It further details how to initially set up the Lisk SDK and how to send the newly created transaction type to the network.">
    <meta name="generator" content="Antora 2.2.0">
    <link rel="stylesheet" href="../../_/css/site.css">
    <link rel="stylesheet" href="../../_/css/site-extra.css">
      <link rel="stylesheet" href="../../_/css/vendor/docsearch.min.css">
      <!-- fetched from https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css -->
    <link rel="icon" href="../../favicon.ico" type="image/x-icon">
    <script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
    <!--
    <link href="https://unpkg.com/primer/build/build.css" rel="stylesheet">
-->
<link rel="icon" href="/sites/default/files/favicons/favicon-32x32.png" type="image/png">
  </head>
  <body class="article">
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-NKNKGHL');</script>
<!-- End Google Tag Manager -->
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NKNKGHL"
                  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->

<header class="header">
  <nav class="navbar">
      <div class="navbar-content">
        <div class="navbar-brand">
          <a href="https://lisk.io" class="lisk-logo"></a>
            <span  class="nav-brand__name-area">
              <strong class="nav-brand__name-area__title">SDK Docs</strong>
                          </span>
          <button class="navbar-burger" data-target="topbar-nav">
            <span></span>
            <span></span>
            <span></span>
          </button>
        </div>
        <div id="topbar-nav" class="navbar-menu">
          <div class="navbar-end">
            <div class="navbar-item has-dropdown is-hoverable">
              <a class="navbar-link" href="#">Docs</a>
              <div class="navbar-dropdown">
                <a class="navbar-item" href="https://lisk.io/documentation/lisk-sdk/">Lisk SDK</a>
                <a class="navbar-item" href="https://lisk.io/documentation/lisk-core/">Lisk Core</a>
              </div>
            </div>
              <div class="navbar-item has-dropdown is-hoverable">
                <a class="navbar-link" href="https://lisk.io/documentation/lisk-sdk/tutorials/index.html">Tutorials</a>
                <div class="navbar-dropdown">
                  <a class="navbar-item" href="https://lisk.io/documentation/lisk-sdk/tutorials/hello-world.html">Hello World</a>
                  <a class="navbar-item" href="https://lisk.io/documentation/lisk-sdk/tutorials/transport.html">Supply chain</a>
                </div>
              </div>
              <div class="navbar-item has-dropdown is-hoverable">
                <a class="navbar-link" href="#">Guides</a>
                <div class="navbar-dropdown">
                  <a class="navbar-item" href="https://lisk.io/documentation/lisk-sdk/basic-guides/configuration.html">Configure a blockchain application</a>
                  <a class="navbar-item" href="https://lisk.io/documentation/lisk-sdk/basic-guides/customize.html">Add a custom transaction</a>
                </div>
              </div>
              <div class="navbar-item has-dropdown is-hoverable">
                <a class="navbar-link" href="#">Reference</a>
                <div class="navbar-dropdown">
                  <a class="navbar-item" href="https://lisk.io/documentation/lisk-sdk/reference/api.html">API specification</a>
                  <a class="navbar-item" href="https://lisk.io/documentation/lisk-sdk/reference/config.html">Config reference</a>
                  <a class="navbar-item" href="https://lisk.io/documentation/lisk-sdk/reference/lisk-elements">Lisk Elements</a>
                  <a class="navbar-item" href="https://lisk.io/documentation/lisk-sdk/reference/lisk-commander">Lisk Commander</a>
                  <a class="navbar-item" href="https://lisk.io/documentation/lisk-sdk/reference/lisk-framework">Lisk Framework</a>
                </div>
              </div>
                        <div class="navbar-item has-dropdown is-hoverable">
              <a class="navbar-link" href="#">Resources</a>
              <div class="navbar-dropdown">
                <a class="navbar-item" href="https://lisk.io/roadmap"><i class="icofont-map-pins"></i>Roadmap</a>
                <a class="navbar-item" href="https://lisk.io/research"><i class="icofont-laboratory"></i>Research</a>
                <a class="navbar-item" href="https://lisk.io/blog"><i class="icofont-paper"></i>Blog</a>
                <a class="navbar-item" href="https://lisk.io/apps"><i class="icofont-dashboard-web"></i>Blockchain Apps List</a>
                <a class="navbar-item" href="https://lisk.io/builders-program"><i class="icofont-worker"></i>Lisk Builders Program</a>
                <a class="navbar-item" href="https://dev.lisk.io/"><i class="icofont-penguin-linux"></i>Dev Forum</a>
                <a class="navbar-item" href="https://lisk.io/community"><i class="icofont-people"></i>Community</a>
              </div>
            </div>
            <div class="navbar-item has-dropdown is-hoverable">
              <a class="navbar-link" href="#">Github</a>
              <div class="navbar-dropdown">
                <a class="navbar-item" target="_blank" href="https://github.com/LiskHQ/lisk-sdk">Lisk SDK<i class="icofont-external-link"></i></a>
                <a class="navbar-item" target="_blank" href="https://github.com/LiskHQ/lisk-core">Lisk Core <i class="icofont-external-link"></i></a>
                <a class="navbar-item" target="_blank" href="https://github.com/LiskHQ/lisk-sdk-examples">Example Applications <i class="icofont-external-link"></i></a>
              </div>
            </div>
          </div>
            <div class="navbar-menu">
              <div class="navbar-item hide-for-print">
                <input id="search-input" type="text" placeholder="Search docs">
              </div>
            </div>
        </div>
      </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="lisk-sdk" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">Lisk SDK</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../setup.html">Prerequisites</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../getting-started.html">Getting started</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text"><strong>Basic Guides</strong></span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../basic-guides/configuration.html">Configure a blockchain application</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../basic-guides/customize.html">Add a custom transaction</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text"><strong>Tutorials</strong></span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="index.html">Overview</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="hello-world.html">Hello world</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="transport.html">Supply chain</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="transport0.html"><strong>Part 0:</strong> Installation &amp; setup</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="transport1.html"><strong>Part 1:</strong> Tracking a packet on the blockchain</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="transport2.html"><strong>Part 2:</strong> A simple supply chain management system</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="transport3.html"><strong>Part 3:</strong> How to publish the application</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text"><strong>Reference</strong></span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../reference/api.html">API specification</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../reference/config.html">Configuration reference</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text"><strong>Lisk Commander</strong></span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../reference/lisk-commander/index.html">Overview</a>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../reference/lisk-commander/user-guide.html">User guide</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../reference/lisk-commander/user-guide/commands.html">Command reference</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../reference/lisk-commander/user-guide/lisk-core.html">Lisk Core commands</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../reference/lisk-commander/user-guide/sensitive-inputs.html">Sensitive inputs</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text"><strong>Lisk Elements</strong></span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../reference/lisk-elements/index.html">Overview</a>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../reference/lisk-elements/packages.html">Packages</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../reference/lisk-elements/packages/api-client.html">API client</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../reference/lisk-elements/packages/api-client/accounts.html">Accounts</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../reference/lisk-elements/packages/api-client/blocks.html">Blocks</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../reference/lisk-elements/packages/api-client/dapps.html">DApps</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../reference/lisk-elements/packages/api-client/delegates.html">Delegates</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../reference/lisk-elements/packages/api-client/node.html">Node</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../reference/lisk-elements/packages/api-client/peers.html">Peers</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../reference/lisk-elements/packages/api-client/signatures.html">Signatures</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../reference/lisk-elements/packages/api-client/transactions.html">Transactions</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../reference/lisk-elements/packages/api-client/voters.html">Voters</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../reference/lisk-elements/packages/api-client/votes.html">Votes</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../reference/lisk-elements/packages/client.html">Client</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../reference/lisk-elements/packages/constants.html">Constants</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../reference/lisk-elements/packages/cryptography.html">Cryptography</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../reference/lisk-elements/packages/passphrase.html">Passphrase</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../reference/lisk-elements/packages/transactions.html">Transactions</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text"><strong>Lisk Framework</strong></span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../reference/lisk-framework/index.html">Overview</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Lisk SDK</span>
    <span class="version">2.3.7 (latest)</span>
  </div>
  <ul class="components">
    <li class="component">
      <span class="title">Lisk Core</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../lisk-core/index.html">2.1.5 (latest)</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <span class="title">Lisk SDK</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">2.3.7 (latest)</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main>
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Lisk SDK</a></li>
    <li><a href="cashback.html">Cashback Tutorial</a></li>
  </ul>
</nav>
<button class="toc-toggle"></button>
  <div class="edit-this-page"><a href="https://github.com/LiskHQ/lisk-docs/edit/docs-sdk-2.3.7/modules/ROOT/pages/tutorials/cashback.adoc">Edit this Page</a></div>
  </div>
<article class="doc">
<h1 class="page">Cashback Tutorial</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>A simple application which rewards the users for sending tokens.
The cashback reward tokens are freshly minted, and in turn increase the absolute amount of tokens within the network.</p>
</div>
<div class="paragraph">
<p>The Cashback Application implementation steps are shown below:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Steps 1-5</strong> describes the node-side implementation of the blockchain application.</p>
</li>
<li>
<p><strong>Step 6</strong> shows how to interact with the network from the (blockchain) client-side using a node script.</p>
</li>
<li>
<p><strong>Step 7</strong> explains how to override specific config values.</p>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Please see the <strong>full code example</strong> of the <a href="https://github.com/LiskHQ/lisk-sdk-examples/tree/development/cashback">Cashback App on Github</a>.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_1_installation_setup"><a class="anchor" href="#_1_installation_setup"></a>1. Installation &amp; Setup</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Firstly, create the root folder for the Cashback Application and initialize the project:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">mkdir cashback <i class="conum" data-value="1"></i><b>(1)</b>
cd cashback <i class="conum" data-value="2"></i><b>(2)</b>
npm init --yes <i class="conum" data-value="3"></i><b>(3)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Create the root folder for the blockchain application.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Navigate into the root folder.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Initialize the manifest file of the project.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The next step is to install the <code>lisk-sdk</code> package and add it to the project&#8217;s dependencies.</p>
</div>
<div class="sect2">
<h3 id="_supported_platforms"><a class="anchor" href="#_supported_platforms"></a>Supported Platforms</h3>
<div class="ulist">
<ul>
<li>
<p>Ubuntu 16.04 (LTS) x86_64</p>
</li>
<li>
<p>Ubuntu 18.04 (LTS) x86_64</p>
</li>
<li>
<p>MacOS 10.13 (High Sierra)</p>
</li>
<li>
<p>MacOS 10.14 (Mojave)</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_dependencies"><a class="anchor" href="#_dependencies"></a>Dependencies</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Dependencies</th>
<th class="tableblock halign-left valign-top">Version</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Node.js</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10.17.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PostgreSQL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10+</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Redis (optional)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5+</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Python</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
If some of the dependencies are missing, please go to <a href="../setup.html#pre_install" class="page">Lisk SDK - Pre-Install</a> and follow the pre-installation steps for the SDK.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">npm install --save lisk-sdk <i class="conum" data-value="1"></i><b>(1)</b>
npm install --save @liskhq/lisk-validator @liskhq/lisk-cryptography @liskhq/lisk-transactions @liskhq/lisk-constants <i class="conum" data-value="2"></i><b>(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Install the Lisk SDK as a dependency for the node server side.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Install Lisk Elements dependencies for the client side scripts.</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>It is necessary to create a database before starting.
The default database name is lisk_dev, so for the development purposes, a command <code>createdb lisk_dev --owner lisk</code> can be used.
The default database user and password are as follows: lisk and password.
Naturally they can both be changed in the configuration of the Lisk SDK.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Please note: It is important to start with a fresh database.</p>
</div>
<div class="tabset is-loading">
<div class="ulist tabs">
<ul>
<li>
<p><a id="tabset1_postgres-system-wide"></a>Postgres system-wide</p>
</li>
<li>
<p><a id="tabset1_postgres-with-docker"></a>Postgres with Docker</p>
</li>
</ul>
</div>
<div class="content">
<div class="tab-pane" aria-labelledby="tabset1_postgres-system-wide">
<div class="paragraph">
<p>For the <strong>system-wide Postgres</strong> installation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">psql -c "DROP DATABASE lisk_dev"
psql -c "CREATE DATABASE lisk_dev OWNER lisk"</code></pre>
</div>
</div>
</div>
<div class="tab-pane" aria-labelledby="tabset1_postgres-with-docker">
<div class="paragraph">
<p>If you have installed <a href="../setup.html#_option_a_postgres_with_docker" class="page">Postgres with Docker</a>, please run the following commands:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">docker exec -ti lisk_sdk_db psql -h localhost -U lisk -d postgres -c "DROP DATABASE lisk_dev"
docker exec -ti lisk_sdk_db psql -h localhost -U lisk -d postgres -c "CREATE DATABASE lisk_dev OWNER lisk"</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Create the file <code>index.js</code>, which will hold the logic to initialize and start the blockchain application.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_2_configure_the_application"><a class="anchor" href="#_2_configure_the_application"></a>2. Configure the application</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The next step is to provide the basic information about the application to be built.</p>
</div>
<div class="paragraph">
<p>Open the file <code>index.js</code> that was created with the previous step, and insert the following code:</p>
</div>
<div class="listingblock">
<div class="title">Contents of index.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-js hljs" data-lang="js">const { Application, genesisBlockDevnet, configDevnet } = require('lisk-sdk'); <i class="conum" data-value="1"></i><b>(1)</b>

configDevnet.app.label = 'cashback-blockchain-app'; <i class="conum" data-value="2"></i><b>(2)</b>
//configDevnet.components.storage.user = '&lt;username&gt;'; <i class="conum" data-value="3"></i><b>(3)</b>
// configDevnet.components.storage.password = 'password'; <i class="conum" data-value="4"></i><b>(4)</b>

const app = new Application(genesisBlockDevnet, configDevnet); <i class="conum" data-value="5"></i><b>(5)</b>

app <i class="conum" data-value="6"></i><b>(6)</b>
    .run()
    .then(() =&gt; app.logger.info('App started...'))
    .catch(error =&gt; {
        console.error('Faced error in application', error);
        process.exit(1);
    });</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
See the complete file on Github: <a href="https://github.com/LiskHQ/lisk-sdk-examples/tree/development/cashback/index.js">cashback/index.js</a>.
</td>
</tr>
</table>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Require application class, the default genesis block and the default config for the application.
The necessary dependencies from the <code>lisk-sdk</code> package are required.
The most important one is the <code>Application</code> class, which is used in &lt;5&gt; shown above to create the application instance.
The application instance will start the whole application at the bottom of <code>index.js</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Set the name of the blockchain application.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>In case a different user than 'lisk' was used to access the database <code>lisk_dev</code>, it is necessary to update the username in the config.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Uncomment this and replace <code>password</code> with the new password.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>The application instance is created.
By sending the parameters for the <a href="../basic-guides/configuration.html#genesis_block" class="page">genesis block</a> and the <a href="https://github.com/LiskHQ/lisk-sdk/blob/development/sdk/src/samples/config_devnet.json">configuration template</a>, the application is configured with the most basic configurations to start the network.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>The code block below starts the application and does not need to be changed.</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If it is required to change any of the values for <code>configDevnet</code>, please see the <a href="../reference/config.html#config_object" class="page">full list of configurations</a> for Lisk SDK and overwrite them as described in <a href="#step7">step 7</a>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>After adding the code block above, save and close <code>index.js</code>.
At this point it is now possible to start both the node and network, in order to to verify that the setup was successful:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">node index.js | npx bunyan -o short</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>node index.js</code> will start the node, and <code>| npx bunyan -o short</code> will pretty-print the logs in the console.</p>
</div>
<div class="paragraph">
<p>If everything is correct, the following logs will be displayed:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ node index.js | npx bunyan -o short
14:01:39.384Z  INFO lisk-framework: Booting the application with Lisk Framework(0.1.0)
14:01:39.391Z  INFO lisk-framework: Starting the app - cashback-blockchain-app
14:01:39.392Z  INFO lisk-framework: Initializing controller
14:01:39.392Z  INFO lisk-framework: Loading controller
14:01:39.451Z  INFO lisk-framework: Old PID: 7707
14:01:39.452Z  INFO lisk-framework: Current PID: 7732
14:01:39.467Z  INFO lisk-framework: Loading module lisk-framework-chain:0.1.0 with alias "chain"
14:01:39.613Z  INFO lisk-framework: Event network:bootstrap was subscribed but not registered to the bus yet.
14:01:39.617Z  INFO lisk-framework: Event network:bootstrap was subscribed but not registered to the bus yet.
14:01:39.682Z  INFO lisk-framework: Modules ready and launched
14:01:39.683Z  INFO lisk-framework: Event network:event was subscribed but not registered to the bus yet.
14:01:39.684Z  INFO lisk-framework: Module ready with alias: chain(lisk-framework-chain:0.1.0)
14:01:39.684Z  INFO lisk-framework: Loading module lisk-framework-network:0.1.0 with alias "network"
14:01:39.726Z  INFO lisk-framework: Blocks 1886
14:01:39.727Z  INFO lisk-framework: Genesis block matched with database
14:01:39.791Z ERROR lisk-framework: Error occurred while fetching information from 127.0.0.1:5000
14:01:39.794Z  INFO lisk-framework: Module ready with alias: network(lisk-framework-network:0.1.0)
14:01:39.795Z  INFO lisk-framework: Loading module lisk-framework-http-api:0.1.0 with alias "http_api"
14:01:39.796Z  INFO lisk-framework: Module ready with alias: http_api(lisk-framework-http-api:0.1.0)
14:01:39.797Z  INFO lisk-framework:
  Bus listening to events [ 'app:ready',
    'app:state:updated',
    'chain:bootstrap',
    'chain:blocks:change',
    'chain:signature:change',
    'chain:transactions:change',
    'chain:rounds:change',
    'chain:multisignatures:signature:change',
    'chain:multisignatures:change',
    'chain:delegates:fork',
    'chain:loader:sync',
    'chain:dapps:change',
    'chain:registeredToBus',
    'chain:loading:started',
    'chain:loading:finished',
    'network:bootstrap',
    'network:event',
    'network:registeredToBus',
    'network:loading:started',
    'network:loading:finished',
    'http_api:registeredToBus',
    'http_api:loading:started',
    'http_api:loading:finished' ]
14:01:39.799Z  INFO lisk-framework:
  Bus ready for actions [ 'app:getComponentConfig',
    'app:getApplicationState',
    'app:updateApplicationState',
    'chain:calculateSupply',
    'chain:calculateMilestone',
    'chain:calculateReward',
    'chain:generateDelegateList',
    'chain:updateForgingStatus',
    'chain:postSignature',
    'chain:getForgingStatusForAllDelegates',
    'chain:getTransactionsFromPool',
    'chain:getTransactions',
    'chain:getSignatures',
    'chain:postTransaction',
    'chain:getDelegateBlocksRewards',
    'chain:getSlotNumber',
    'chain:calcSlotRound',
    'chain:getNodeStatus',
    'chain:blocks',
    'chain:blocksCommon',
    'network:request',
    'network:emit',
    'network:getNetworkStatus',
    'network:getPeers',
    'network:getPeersCountByFilter' ]
14:01:39.800Z  INFO lisk-framework: App started...
14:01:39.818Z  INFO lisk-framework: Validating current block with height 1886
14:01:39.819Z  INFO lisk-framework: Loader-&gt;validateBlock Validating block 10258884836986606075 at height 1886
14:01:40.594Z  INFO lisk-framework: Lisk started: 0.0.0.0:4000
14:01:40.600Z  INFO lisk-framework: Verify-&gt;verifyBlock succeeded for block 10258884836986606075 at height 1886.
14:01:40.600Z  INFO lisk-framework: Loader-&gt;validateBlock Validating block succeed for 10258884836986606075 at height 1886.
14:01:40.600Z  INFO lisk-framework: Finished validating the chain. You are at height 1886.
14:01:40.601Z  INFO lisk-framework: Blockchain ready
14:01:40.602Z  INFO lisk-framework: Loading 101 delegates using encrypted passphrases from config
14:01:40.618Z  INFO lisk-framework: Forging enabled on account: 8273455169423958419L
14:01:40.621Z  INFO lisk-framework: Forging enabled on account: 12254605294831056546L
14:01:40.624Z  INFO lisk-framework: Forging enabled on account: 14018336151296112016L
14:01:40.627Z  INFO lisk-framework: Forging enabled on account: 2003981962043442425L
[...]</pre>
</div>
</div>
<div class="paragraph">
<p>To stop the blockchain process, press <span class="keyseq"><kbd>CTRL</kbd>+<kbd>C</kbd></span>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_3_create_a_new_transaction_type"><a class="anchor" href="#_3_create_a_new_transaction_type"></a>3. Create a new transaction type</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To create a new <a href="../basic-guides/customize.html" class="page">custom transaction type</a> , such as  <code>CashbackTransaction</code> please see the description shown below:
This extends the pre-existing transaction type <code>TransferTransaction</code>.
The difference between the regular <code>TransferTransaction</code> and the <code>CashbackTransaction</code>, is that the Cashback transaction type also pays out a 10% bonus reward to its sender.</p>
</div>
<div class="paragraph">
<p>For example, if Alice sends 100 tokens to Bob as a Cashback transaction, Bob would receive the 100 tokens and Alice would receive an additional 10 tokens as a cashback.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../_images/cashback_diagram.png" alt="Business logic of a cashback transaction"></span></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If a comparison is made with the methods below with the methods implemented in the <code>HelloTransaction</code>, it is evident that fewer methods are used for the <code>CashbackTransaction</code>.
This is due to the fact that the <code>CashbackTransaction</code> is extended from an already existing transaction type <code>TransferTransaction</code>.
As a result, all required methods are implemented already inside the <code>TransferTransaction</code> class, and it is only necessary to overwrite/extend explicitly the methods required to be customized.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p><strong>General advice:</strong> Please be aware that if the custom transaction type is extended from an already existing Transaction type, the logic might by affected by future changes in the codebase of the transaction type, from whereby it was extended from.
Therefore, it is recommended to keep an eye on future changes for the transaction type, or alternatively just use the <a href="../basic-guides/customize.html#interface" class="page">BaseTransaction</a> as the basis for the required transaction type.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To execute this, create and open the file <code>cashback_transaction.js</code> and insert the following code shown below:</p>
</div>
<div class="listingblock">
<div class="title">Contents of cashback_transaction.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-js hljs" data-lang="js">const {
    transactions: { TransferTransaction },
    BigNum,
} = require('lisk-sdk');

class CashbackTransaction extends TransferTransaction {

    /**
    * Set the Cashback transaction TYPE to `11`.
    * The first 10 types, from `0-9` is reserved for the default Lisk Network functions.
    * Type `10` was used previously for the `HelloTransaction`, so it is set to `11`, but any other integer value (that is not already used by another transaction type) is a valid value.
    */
    static get TYPE () {
        return 11;
    }

    /**
    * Set the `CashbackTransaction` transaction FEE to 0.1 LSK.
    * Every time a user posts a transaction to the network, the transaction fee is paid to the delegate who includes the transaction into a block that the delegate forges.
    */
    static get FEE () {
        return `${10 ** 7}`;
    };

    /**
    * The CashbackTransaction adds an inflationary 10% to senders account.
    * Invoked as part of the apply() step of the BaseTransaction and block processing.
    */
    applyAsset(store) {
        super.applyAsset(store);

        const sender = store.account.get(this.senderId);
        const updatedSenderBalanceAfterBonus = new BigNum(sender.balance).add(
            new BigNum(this.amount).div(10)
        );
        const updatedSender = {
            ...sender,
            balance: updatedSenderBalanceAfterBonus.toString(),
        };
        store.account.set(sender.address, updatedSender);

        return [];
    }

    /**
    * Inverse of applyAsset().
    * Undoes the changes made in `applyAsset` step: It sends the transaction amount back to the sender and substracts 10% of the transaction amount from the senders account balance.
    */
    undoAsset(store) {
        super.undoAsset(store);

        const sender = store.account.get(this.senderId);
        const updatedSenderBalanceAfterBonus = new BigNum(sender.balance).sub(
            new BigNum(this.amount).div(10)
        );
        const updatedSender = {
            ...sender,
            balance: updatedSenderBalanceAfterBonus.toString(),
        };
        store.account.set(sender.address, updatedSender);

        return [];
    }
}

module.exports = CashbackTransaction;</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
See the file on Github: <a href="https://github.com/LiskHQ/lisk-sdk-examples/blob/development/cashback/cashback_transaction.js">cashback/cashback_transaction.js</a>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>After adding the code block above, save and close <code>cashback_transaction.js</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_4_register_the_new_transaction_type"><a class="anchor" href="#_4_register_the_new_transaction_type"></a>4. Register the new transaction type</h2>
<div class="sectionbody">
<div class="paragraph">
<p>At this stage the current project should contain the following file structure:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>cashback
├── cashback_transaction.js
├── index.js
├── node_modules
└──package.json</pre>
</div>
</div>
<div class="paragraph">
<p>Add the new transaction type to the application by registering it to the application instance inside of <code>index.js</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
It is only necessary to add 2 new lines (number &lt;2&gt; and &lt;7&gt;) shown below to your existing <code>index.js</code>, to register the new transaction type.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Contents of index.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-js hljs" data-lang="js">const { Application, genesisBlockDevnet, configDevnet} = require('lisk-sdk'); <i class="conum" data-value="1"></i><b>(1)</b>
const CashbackTransaction = require('./cashback_transaction'); <i class="conum" data-value="2"></i><b>(2)</b>

configDevnet.app.label = 'cashback-blockchain-app'; <i class="conum" data-value="3"></i><b>(3)</b>
//configDevnet.components.storage.user = '&lt;username&gt;'; <i class="conum" data-value="4"></i><b>(4)</b>
configDevnet.components.storage.password = 'password'; <i class="conum" data-value="5"></i><b>(5)</b>

const app = new Application(genesisBlockDevnet, configDevnet); <i class="conum" data-value="6"></i><b>(6)</b>

app.registerTransaction(CashbackTransaction); <i class="conum" data-value="7"></i><b>(7)</b>

app <i class="conum" data-value="8"></i><b>(8)</b>
    .run()
    .then(() =&gt; app.logger.info('App started...'))
    .catch(error =&gt; {
        console.error('Faced error in application', error);
        process.exit(1);
    });</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
See the file on Github: <a href="https://github.com/LiskHQ/lisk-sdk-examples/tree/development/cashback/index.js">cashback/index.js</a>.
</td>
</tr>
</table>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Require application class, the default genesis block and the default config for the application.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><strong>New line</strong>: Require the newly created transaction type 'CashbackTransaction'.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Change the label of the app.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>If a different user name than 'lisk' to access the database lisk_dev was used, then it is necessary to update the username in the config.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Replace the existing password with the password for the database user.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Create the application instance.</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td><strong>New line</strong>: Register the 'CashbackTransaction'.</td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td>The code block below starts the application and does not need to be changed.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>After adding the 2 new lines to your <code>index.js</code> file, save and close it.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_5_start_the_network"><a class="anchor" href="#_5_start_the_network"></a>5. Start the network</h2>
<div class="sectionbody">
<div class="paragraph">
<p>It is now possible to start the customized blockchain network for the first time.</p>
</div>
<div class="paragraph">
<p>The parameter <code>configDevnet</code>, which is passed to the <code>Application</code> instance in step 3, is preconfigured to start the node with a set of dummy delegates, that have enabled forging by default.</p>
</div>
<div class="paragraph">
<p>These dummy delegates stabilize the new network and make it possible to test out the basic functionality of the network with only one node immediately.</p>
</div>
<div class="paragraph">
<p>This creates a simple Devnet, which is beneficial during development of the blockchain application.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The dummy delegates can be replaced with real delegates later.
To accomplish this, the users are required to create new secret accounts, and register themselves as delegates on the network.
Then the account(s) with the most tokens need to unvote the dummy delegates, and vote for the newly registered delegates instead.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To start the network, execute the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">node index.js | npx bunyan -o short</code></pre>
</div>
</div>
<div class="paragraph">
<p>Check the logs to verify that the network has started successfully.</p>
</div>
<div class="paragraph">
<p>If an error occurs the process should stop, and the error with the debug information will be displayed.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_6_interact_with_the_network"><a class="anchor" href="#_6_interact_with_the_network"></a>6. Interact with the network</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Now the network is running, try to send a <code>CashbackTransaction</code> in order to check that the node accepts this.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>As the blockchain process is running in the current console window, it is necessary to open a new window to proceed with the tutorial.
Ensure to navigate into the root folder of the blockchain application in the new console window.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In the new terminal window, create a new folder <code>client</code>, this will hold the client-side scripts.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">cd cashback <i class="conum" data-value="1"></i><b>(1)</b>
mkdir client <i class="conum" data-value="2"></i><b>(2)</b>
cd client <i class="conum" data-value="3"></i><b>(3)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Open the root folder of the Cashback application.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Create the folder for the client-side scripts inside the cashback folder.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Navigate into the client folder.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Inside the <code>client</code> folder, create the file that will hold the code to create the transaction object: <code>print_sendable_cashback.js</code></p>
</div>
<div class="paragraph">
<p>Open the file <code>print_sendable_cashback.js</code> and insert the following code:</p>
</div>
<div class="listingblock">
<div class="title">Content of client/print_sendable_cashback.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-js hljs" data-lang="js">const CashbackTransaction = require('../cashback_transaction');
const transactions = require('@liskhq/lisk-transactions');
const { EPOCH_TIME } = require('@liskhq/lisk-constants');

const getTimestamp = () =&gt; {
    // check config file or curl localhost:4000/api/node/constants to verify your epoc time
    const millisSinceEpoc = Date.now() - Date.parse(EPOCH_TIME);
    const inSeconds = ((millisSinceEpoc) / 1000).toFixed(0);
    return  parseInt(inSeconds);
};

const tx = new CashbackTransaction({
    amount: `${transactions.utils.convertLSKToBeddows('2')}`,
    fee: `${transactions.utils.convertLSKToBeddows('0.1')}`,
    recipientId: '10881167371402274308L', //delegate genesis_100
    timestamp: getTimestamp(),
});

tx.sign('wagon stock borrow episode laundry kitten salute link globe zero feed marble');

console.log(tx.stringify());
process.exit(0);</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
See the complete file on Github: <a href="https://github.com/LiskHQ/lisk-sdk-examples/blob/development/cashback/client/print_sendable_cashback.js">cashback/client/print_sendable_cashback.js</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This script will print the transaction in the console, when executed.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Python’s <code>json.tool</code> is used to prettify the output
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">node print_sendable_cashback.js | python -m json.tool</code></pre>
</div>
</div>
<div class="paragraph">
<p>The generated transaction object should look like this:</p>
</div>
<div class="listingblock">
<div class="title">Signed Transaction object</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
   "id":"5372254888441494149",
   "amount":"200000000",
   "type":11,
   "timestamp":3,
   "senderPublicKey":"c094ebee7ec0c50ebee32918655e089f6e1a604b83bcaa760293c61e0f18ab6f",
   "senderId":"16313739661670634666L",
   "recipientId":"10881167371402274308L",
   "fee":"10000000",
   "signature":"0a3f41cc529f9de523cadc7db64e9436014d1b10ca2158bbce0469e8e76dfd021358496440da43acaf64d0223d3514609fc1aa41646be56353207d88a03b1305",
   "signatures":[],
   "asset":{}
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now a sendable transaction object exists, send it to the node and it will be processed by analyzing the logs.</p>
</div>
<div class="paragraph">
<p>The HTTP API of the node is now utilized, and the created transaction object is now posted to the transaction endpoint of the API.</p>
</div>
<div class="paragraph">
<p>Before posting the transaction it is recommended to check the balances of the sender and recipient, in order to verify that the transaction was applied correctly:</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Ensure the node is running, before sending any API requests.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To check the account balance of the sender, execute the following commands below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">curl -X GET "http://localhost:4000/api/accounts?address=16313739661670634666L" -H "accept: application/json" | python -m json.tool</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Response from api/accounts endpoint with initial balance of the sender</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "meta": {
    "offset": 0,
    "limit": 10
  },
  "data": [
    {
      "address": "16313739661670634666L",
      "publicKey": "c094ebee7ec0c50ebee32918655e089f6e1a604b83bcaa760293c61e0f18ab6f",
      "balance": "10000000000000000",
      "secondPublicKey": ""
    }
  ],
  "links": {}
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Checking the account balance of the recipient:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">curl -X GET "http://localhost:4000/api/accounts?address=10881167371402274308L" -H "accept: application/json" | python -m json.tool</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>It is possible the account data of <code>10881167371402274308L</code> contains more info than the account data of <code>16313739661670634666L</code>.
This is simply because <code>10881167371402274308L</code> is a registered delegate.
Therefore additional information such as the delegates name and the vote weight are stored in the accounts database entry.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Response from api/accounts endpoint with the initial balance of the recipient</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "meta": {
    "offset": 0,
    "limit": 10
  },
  "data": [
    {
      "address": "10881167371402274308L",
      "publicKey": "addb0e15a44b0fdc6ff291be28d8c98f5551d0cd9218d749e30ddb87c6e31ca9",
      "balance": "0",
      "secondPublicKey": "",
      "delegate": {
        "username": "genesis_100",
        "vote": "9999999680000000",
        "rewards": "1500000000",
        "producedBlocks": 26,
        "missedBlocks": 0,
        "rank": 70,
        "productivity": 100,
        "approval": 100
      }
    }
  ],
  "links": {}
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Due to the fact that the API of every node is only accessible from the localhost by default, it is necessary to execute this query on the same server that the node is running on, unless the config to <a href="#step7">make your API accessible</a> to others, or to the public was changed.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Ensure the node is running, before sending the transaction.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">POST the transaction to the local node</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">node print_sendable_cashback.js | tee &gt;(curl -X POST -H "Content-Type: application/json" -d @- localhost:4000/api/transactions) <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Posts the tx object to the node and displays it on the console.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If the node accepted the transaction, the response should be as follows:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>{"meta":{"status":true},"data":{"message":"Transaction(s) accepted"},"links":{}}</pre>
</div>
</div>
<div class="paragraph">
<p>To verify that the transaction was included in a block:</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Use the  <code>id</code>   of the transaction object which was posted to the node in the previous step.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Example Transaction API Request</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">curl -X GET "http://localhost:4000/api/transactions?id=5372254888441494149" -H "accept: application/json" | python -m json.tool</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Exmaple Response</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "meta": {
    "offset": 0,
    "limit": 10,
    "count": 1
  },
  "data": [
    {
      "id": "5372254888441494149",
      "height": 2048,
      "blockId": "12427514488773581697",
      "type": 11,
      "timestamp": 3,
      "senderPublicKey": "c094ebee7ec0c50ebee32918655e089f6e1a604b83bcaa760293c61e0f18ab6f",
      "recipientPublicKey": "addb0e15a44b0fdc6ff291be28d8c98f5551d0cd9218d749e30ddb87c6e31ca9",
      "senderId": "16313739661670634666L",
      "recipientId": "10881167371402274308L",
      "amount": "100000000",
      "fee": "10000000",
      "signature": "0a3f41cc529f9de523cadc7db64e9436014d1b10ca2158bbce0469e8e76dfd021358496440da43acaf64d0223d3514609fc1aa41646be56353207d88a03b1305",
      "signatures": [],
      "asset": {},
      "confirmations": 5
    }
  ],
  "links": {}
}</code></pre>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p>In this example, the sender was sending 2 LSK to the recipient, and paid a transaction fee of 0.1 LSK.<br>
Simultaneously, the sender receives a cashback of 10% of the transaction amount: 2 LSK * 10% = 0.2 LSK.</p>
</div>
<div class="paragraph">
<p>As a result, the recipient should receive a credit of 2 LSK, and <strong>the sender&#8217;s balance should then be reduced by 1.9 LSK</strong><br>
(-2 LSK, plus a credit of 0.1 LSK [= 0.2 LSK (cashback) - 0.1 LSK (tx fee)] = -1.9 LSK).</p>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The balance of an account is stored in Beddows.
1 LSK = 100000000(= 10^8) Beddows.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Verify that the sender&#8217;s account balance is reduced by 1.9 LSK by executing the following command below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">curl -X GET "http://localhost:4000/api/accounts?address=16313739661670634666L" -H "accept: application/json" | python -m json.tool</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Response from the api/accounts endpoint with the updated sender&#8217;s balance</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "meta": {
    "offset": 0,
    "limit": 10
  },
  "data": [
    {
      "address": "16313739661670634666L",
      "publicKey": "c094ebee7ec0c50ebee32918655e089f6e1a604b83bcaa760293c61e0f18ab6f",
      "balance": "9999999810000000",
      "secondPublicKey": ""
    }
  ],
  "links": {}
}</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Verify that the recipient&#8217;s account received the credit of 2 LSK by executing the following command below</dt>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">curl -X GET "http://localhost:4000/api/accounts?address=10881167371402274308L" -H "accept: application/json" | python -m json.tool</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Response from the api/accounts endpoint with the updated recipient&#8217;s balance</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "meta": {
    "offset": 0,
    "limit": 10
  },
  "data": [
    {
      "address": "10881167371402274308L",
      "publicKey": "addb0e15a44b0fdc6ff291be28d8c98f5551d0cd9218d749e30ddb87c6e31ca9",
      "balance": "200000000",
      "secondPublicKey": "",
      "delegate": {
        "username": "genesis_100",
        "vote": "9999999680000000",
        "rewards": "1500000000",
        "producedBlocks": 26,
        "missedBlocks": 0,
        "rank": 70,
        "productivity": 100,
        "approval": 100
      }
    }
  ],
  "links": {}
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the balances are equal to the expected values, then it is verified with the new custom transaction type <code>CashbackTransaction</code> , and is successfully integrated into the application.</p>
</div>
<div class="paragraph">
<p>For further interaction with the network, it is possible to run the process in the background by executing the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">cd cashback <i class="conum" data-value="1"></i><b>(1)</b>
pm2 start --name cashback index.js <i class="conum" data-value="2"></i><b>(2)</b>
pm2 stop cashback <i class="conum" data-value="3"></i><b>(3)</b>
pm2 start cashback <i class="conum" data-value="4"></i><b>(4)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Navigate into the root folder of the Cashback application.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Add the application to pm2 under the name 'cashback'.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Stop the cashback app.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Start the cashback app.</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>PM2 needs to be installed on the system in order to run these commands.
Please see <a href="../setup.html#_pre_installation" class="page">SDK Pre-Install section</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="step7"><a class="anchor" href="#step7"></a>7. Customize the default configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The new project should have now the following file structure:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>cashback
├── client
│   └── print_sendable_cashback.js
├── cashback_transaction.js
├── index.js
├── node_modules
└── package.json</pre>
</div>
</div>
<div class="paragraph">
<p>To run the script remotely, change the configuration before creating the <code>Application</code> instance in order to make the API accessible as shown below:</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
For more configuration options, please see the <a href="../reference/config.html#config_object" class="page">full list of configurations</a> for Lisk SDK.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-js hljs" data-lang="js">const { Application, genesisBlockDevnet, configDevnet} = require('lisk-sdk'); <i class="conum" data-value="1"></i><b>(1)</b>
const CashbackTransaction = require('./cashback_transaction'); <i class="conum" data-value="2"></i><b>(2)</b>

configDevnet.app.label = 'cashback-blockchain-app'; <i class="conum" data-value="3"></i><b>(3)</b>
//configDevnet.components.storage.user = '&lt;username&gt;'; <i class="conum" data-value="4"></i><b>(4)</b>
//configDevnet.components.storage.password = 'password'; <i class="conum" data-value="5"></i><b>(5)</b>

configDevnet.modules.http_api.access.public = true; <i class="conum" data-value="6"></i><b>(6)</b>
//configDevnet.modules.http_api.access.whitelist.push('1.2.3.4'); <i class="conum" data-value="7"></i><b>(7)</b>

const app = new Application(genesisBlockDevnet, configDevnet); <i class="conum" data-value="8"></i><b>(8)</b>

app.registerTransaction(CashbackTransaction); <i class="conum" data-value="9"></i><b>(9)</b>

app <i class="conum" data-value="10"></i><b>(10)</b>
    .run()
    .then(() =&gt; app.logger.info('App started...'))
    .catch(error =&gt; {
        console.error('Faced error in application', error);
        process.exit(1);
    });</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Require application class, the default genesis block and the default config for the application.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Require the newly created transaction type 'CashbackTransaction'.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Set the name of your blockchain application.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>In case a different user than <code>lisk</code> is used to access to the database lisk_dev, it is necessary to update the username in the config.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Uncomment this and replace <code>password</code> with the new password for your database user.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Make the API accessible from everywhere.</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>Example how to make the API accessible for specific IP addresses: add 1.2.3.4 IP address as whitelisted.</td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td>Create the application instance.</td>
</tr>
<tr>
<td><i class="conum" data-value="9"></i><b>9</b></td>
<td>Register the 'CashbackTransaction'.</td>
</tr>
<tr>
<td><i class="conum" data-value="10"></i><b>10</b></td>
<td>The code block below starts the application and does not need to be changed.</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p><strong>Optional:</strong> After the first successful verification, it is possible to reduce the default console log level (info), and file log level (debug).
This can be completed by sending a copy of the config object <code>configDevnet</code> with the customized config for the logger component as shown below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-js hljs" data-lang="js">configDevnet.components.logger.fileLogLevel = "error"; <i class="conum" data-value="1"></i><b>(1)</b>
configDevnet.components.logger.consoleLogLevel = "none"; <i class="conum" data-value="2"></i><b>(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>This will log errors and also fatal errors in the log file.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>This will result in no logs being visible in the console.</td>
</tr>
</table>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For the next step a wallet software can be used.
For example, a customized <a href="https://lisk.io/wallet">Lisk Desktop</a>, so that the users can utilize the new transaction type.</p>
</div>
<div class="paragraph">
<p>Please also see the following section: <a href="../../lisk-core/interact-with-network.html" class="page">Interact with the network</a>.</p>
</div>
</div>
</div>

</article>
<aside class="article-aside hidden" role="navigation">
    <h3 class="toc-title">On this page:</h3>
    <div id="article-toc"></div>
</aside>
</main>
</div>
<footer class="footer">
    <div class="footer__container">
        <div class="footer__copyright">
            <div class="institutional-links-2">
                <span class="institutional-links-2__item">© 2020 Lisk Foundation</span>
                <a class="institutional-links-2__item" href="https://lisk.io/terms-conditions" class="institutional-links-2-item">Terms & Conditions</a>
                <a class="institutional-links-2__item" href="https://lisk.io/privacy" class="institutional-links-2-item">Privacy Policy</a>
            </div>
            <p class="footer__copyright-text">Lisk is a foundation registered in Zug, Zwitserland
            </p>
        </div>
        <div class="footer__logo-container">
            <img src="../../_/img/lisk-logo-light.svg" class="footer__lisk-logo"/>
        </div>
        <div class="community-section">
            <p class="community-section__text">Follow Lisk on: </p>
            <div class="community-section__icons">
                <a href="https://github.com/LiskHQ" target="_blank" class="footer__icon icon-github"></a>
                <a href="https://www.youtube.com/channel/UCuqpGfg_bOQ8Ja4pj811PWg/featured" target="_blank" class="footer__icon icon-youtube"></a>
                <a href="https://www.reddit.com/r/Lisk/" target="_blank" class="footer__icon icon-reddit"></a>
                <a href="https://www.linkedin.com/company/lisk/" target="_blank" class="footer__icon icon-linkedin"></a>
                <a href="https://twitter.com/LiskHQ" target="_blank" class="footer__icon icon-twitter"></a>
                <a href="https://www.facebook.com/LiskHQ" target="_blank" class="footer__icon icon-facebook"></a>
            </div>
        </div>
    </div>
</footer>
<script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.10.0/tocbot.min.js"></script>
<script src="../../_/js/site.js"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
<script async src="../../_/js/vendor/tabs-block-behaviour.js"></script>
<script>
    tocbot.init( {
        tocSelector: '#article-toc',
        contentSelector: 'article',
        headingSelector: 'h1, h2, h3, h4, h5',
        collapseDepth: 3,
        positionFixedSelector: null,
        scrollSmooth: true,
        scrollSmoothDuration: 420
    } );
    var tocList = document.getElementById( 'article-toc' ).getElementsByClassName( 'toc-list' );
    if ( tocList && tocList.length > 0 && tocList[0].childNodes.length > 0 ) {
        document.getElementById( 'article-toc' ).parentNode.classList.remove( 'hidden' );
    }
</script>
  <script src="../../_/js/vendor/docsearch.min.js"></script>
  <!-- fetched from https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js -->
  <script>
    function focusSearchInput () { document.querySelector('#search-input').focus() }
    var search = docsearch({
        appId: 'C4SU57KGV9',
      apiKey: '55aa8709b04eb62f08f87571cf77547c',
      indexName: 'lisk-docs-search',
      inputSelector: '#search-input',
      autocompleteOptions: { hint: false, keyboardShortcuts: ['s'] },
      algoliaOptions: { hitsPerPage: 10 }
    }).autocomplete
    search.on('autocomplete:closed', function () { search.autocomplete.setVal() })
    focusSearchInput()
    window.addEventListener('load', focusSearchInput)
  </script>

  </body>
</html>
