<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Part 4: How to publish the application :: Lisk documentation</title>
    <link rel="canonical" href="https://lisk.com/documentation/lisk-sdk/v4/tutorials/supply-chain/part4.html">
    <link rel="prev" href="part3.html">
    <link rel="next" href="../../references/index.html">
    <meta name="description" content="This part of the Lisk supply chain tutorial describes how to publish the application &amp; make it portable including further improvements.">
    <meta name="generator" content="Antora 3.1.1">

  <link id="theme" rel="stylesheet" title="Default" href="../../../../_/css/site.css">
  <link rel="stylesheet" title="Dark" href="../../../../_/css/dark-site.css">

    <script>var uiRootPath = '../../../../_'</script>
    <script src="../../../../_/js/vendor/medium-zoom.js"></script>
    <script type="text/javascript" id="Cookiebot" src="https://consent.cookiebot.com/uc.js" data-cbid="e4db29b5-cd94-4bcf-87e4-04f4ca564240" data-blockingmode="manual"></script>

<link rel="icon" href="../../../../_/img/favicon.png" type="image/x-icon">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <div class="top-logo">
        <a href="../../../.." class="lisk-logo"></a>
        <a href="../../../.." class="docs-logo"></a>
      </div>
      <!--<a class="navbar-item" href="https://lisk.com/documentation">Lisk documentation</a>-->
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">APIs</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="../../../../api/lisk-node-http.html">Lisk node HTTP API</a>
            <a class="navbar-item" href="../../../../api/lisk-node-rpc.html">Lisk node RPC API</a>
            <a class="navbar-item" href="../../../../api/lisk-service-http.html">Lisk Service HTTP API</a>
            <a class="navbar-item" href="../../../../api/lisk-service-rpc.html">Lisk Service RPC API</a>
            <a class="navbar-item" href="../../../../api/lisk-service-pubsub.html">Lisk Service Pub/Sub API</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Explorers</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://lisk.observer/" target="_blank">Lisk Observer</a>
            <a class="navbar-item" href="https://liskscan.com/" target="_blank">LiskScan</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Products</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="../../../../lisk-sdk/">Lisk SDK</a>
            <a class="navbar-item" href="../../../../lisk-service/">Lisk Service</a>
            <a class="navbar-item" href="../../../../lisk-core/">Lisk Core</a>
            <a class="navbar-item" href="https://lisk.com/wallet" target="_blank">Lisk Wallets</a>
          </div>
        </div>
        <button onclick="switch_style('toggle')" id="theme-toggle" class="theme-toggle navbar-item"></button>
        <!-- <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="#">Download</a>
          </span>
        </div> -->
      </div>
    </div>
  </nav>
</header>
<div class="toolbar" role="navigation">
  <button class="nav-toggle"></button>
  <div class="components-versions">
      <div class="page-components">
    <button class="component-menu-toggle" title="Show other documentations">Lisk SDK</button>
    <div class="component-menu">
        <a class="component" href="../../../../lisk-core/index.html">Lisk Core</a>
        <a class="component" href="../../../../lisk-docs-manual/index.html">Lisk docs manual</a>
        <a class="component" href="../../../../index.html">Lisk Documentation</a>
        <a class="component is-current" href="../../../index.html">Lisk SDK</a>
        <a class="component" href="../../../../lisk-service/index.html">Lisk Service</a>
    </div>
  </div>
    <span></span>
    <div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">3.0.2</button>
  <div class="version-menu">
    <a class="version is-missing" href="../../../index.html">5.2.2 (latest)</a>
    <a class="version" href="../../../v4/tutorials/supply-chain/part4.html">4.0.0</a>
    <a class="version is-current" href="part4.html">3.0.2</a>
  </div>
</div>
  </div>
  <span></span>
  <span></span>
  <a href="../../../../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../index.html">Lisk SDK</a></li>
    <li><a href="../index.html">Tutorials</a></li>
    <li><a href="index.html">Supply Chain</a></li>
    <li><a href="part4.html">Part 4: How to publish the application</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/LiskHQ/lisk-docs/edit/docs-sdk-3.0.2/modules/ROOT/pages/tutorials/supply-chain/part4.adoc"><img class="pencil">Edit this Page</a></div>
  </div>
<div class="body">
<div class="nav-container" data-component="lisk-sdk" data-version="v3">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../../index.html">Lisk SDK</a></h3>
<ul class="nav-list">
  <li class="nav-item parent" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../setup.html">Prerequisites</a>
  </li>
  <li class="nav-item parent" data-depth="1">
    <button class="nav-item-toggle"></button>
        <span>
    <a class="nav-link" href="../../guides/index.html">Guides</a>
        </span>
<ul class="nav-list">
  <li class="nav-item parent" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Application development</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../guides/app-development/configuration.html">Configure a blockchain application</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../guides/app-development/custom-transactions.html">Create a custom transaction</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../guides/app-development/test-transaction.html">Test a transaction</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../guides/app-development/interact-with-api.html">Interact with the API</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../guides/app-development/broadcast.html">Broadcast a transaction</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../guides/app-development/frontend.html">Connect a frontend</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../guides/app-development/launch.html">Launch a blockchain application</a>
  </li>
</ul>
  </li>
  <li class="nav-item parent" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Node management</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../guides/node-management/forging.html">Enable forging</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../guides/node-management/api-access.html">API access</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../guides/node-management/enable-ssl.html">Enable SSL</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../guides/node-management/logging.html">Logging</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item parent" data-depth="1">
    <button class="nav-item-toggle"></button>
        <span>
    <a class="nav-link" href="../index.html">Tutorials</a>
        </span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../hello-world.html">Hello World</a>
  </li>
  <li class="nav-item parent" data-depth="2">
    <button class="nav-item-toggle"></button>
        <span>
    <a class="nav-link" href="index.html">Supply Chain</a>
        </span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="part1.html">Part 1: Installation &amp; setup</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="part2.html">Part 2: Track a packet on the blockchain</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="part3.html">Part 3: A simple supply chain management system</a>
  </li>
  <li class="nav-item is-current-page" data-depth="3">
    <a class="nav-link" href="part4.html">Part 4: How to publish the application</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item parent" data-depth="1">
    <button class="nav-item-toggle"></button>
        <span>
    <a class="nav-link" href="../../references/index.html">References</a>
        </span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../references/api-specification.html">API specification</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../references/config.html">Configuration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../references/changelog.html">Developer changelog</a>
  </li>
  <li class="nav-item parent" data-depth="2">
    <button class="nav-item-toggle"></button>
        <span>
    <a class="nav-link" href="../../references/lisk-commander/index.html">Lisk Commander</a>
        </span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../references/lisk-commander/commands.html">Commands</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../references/lisk-commander/lisk-core-commands.html">Lisk Core commands</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../references/lisk-commander/sensitive-inputs.html">Sensitive inputs</a>
  </li>
</ul>
  </li>
  <li class="nav-item parent" data-depth="2">
    <button class="nav-item-toggle"></button>
        <span>
    <a class="nav-link" href="../../references/lisk-elements/index.html">Lisk Elements</a>
        </span>
<ul class="nav-list">
  <li class="nav-item parent" data-depth="3">
    <button class="nav-item-toggle"></button>
        <span>
    <a class="nav-link" href="../../references/lisk-elements/api-client.html">API client</a>
        </span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../references/lisk-elements/api-client/accounts.html">Accounts</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../references/lisk-elements/api-client/blocks.html">Blocks</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../references/lisk-elements/api-client/dapps.html">DApps</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../references/lisk-elements/api-client/delegates.html">Delegates</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../references/lisk-elements/api-client/node.html">Node</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../references/lisk-elements/api-client/peers.html">Peers</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../references/lisk-elements/api-client/signatures.html">Signatures</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../references/lisk-elements/api-client/transactions.html">Transactions</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../references/lisk-elements/api-client/voters.html">Voters</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../references/lisk-elements/api-client/votes.html">Votes</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../references/lisk-elements/client.html">Client</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../references/lisk-elements/constants.html">Constants</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../references/lisk-elements/cryptography.html">Cryptography</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../references/lisk-elements/p2p.html">P2P</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../references/lisk-elements/passphrase.html">Passphrase</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../references/lisk-elements/transaction-pool.html">Transaction pool</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../references/lisk-elements/transactions.html">Transactions</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../references/lisk-elements/validator.html">Validator</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../references/lisk-framework/index.html">Lisk Framework</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Lisk SDK</span>
    <span class="version">3.0.2</span>
  </div>
  <ul class="components">
    <li class="component">
      <a class="title" href="../../../../lisk-core/index.html">Lisk Core</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../lisk-core/index.html">3.0.4 (latest)</a>
        </li>
        <li class="version">
          <a href="../../../../lisk-core/v2/index.html">2.1.7</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../lisk-docs-manual/index.html">Lisk docs manual</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../lisk-docs-manual/index.html">0.1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../index.html">Lisk Documentation</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../index.html">default</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <a class="title" href="../../../index.html">Lisk SDK</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../index.html">5.2.2 (latest)</a>
        </li>
        <li class="version">
          <a href="../../../v4/index.html">4.0.0</a>
        </li>
        <li class="version is-current">
          <a href="../../index.html">3.0.2</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../lisk-service/index.html">Lisk Service</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../lisk-service/index.html">0.6.4 (latest)</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Part 4: How to publish the application</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>In part 4, the next steps required after the initial development of the application are covered here.</p>
</div>
</div>
<div id="toc" class="toc">
<div id="toctitle">Part 4 includes:</div>
<ul class="sectlevel1">
<li><a href="#make-it-portable">1. Make it portable</a></li>
<li><a href="#connect-more-nodes">2. Connect more nodes</a>
<ul class="sectlevel2">
<li><a href="#set-up-an-additional-seed-node">2.1. Set up an additional seed node</a></li>
<li><a href="#create-a-new-config-suited-for-the-node-application">2.2. Create a new config suited for the node application</a></li>
<li><a href="#publish-the-application">2.3. Publish the application</a></li>
<li><a href="#connect-nodes-and-verify">2.4. Connect nodes and verify</a></li>
</ul>
</li>
<li><a href="#replace_delegates">3. Replace genesis delegates with real ones</a></li>
<li><a href="#write-tests-for-custom-transactions">4. Write tests for custom transactions</a></li>
<li><a href="#further-improvements">5. Further improvements</a></li>
</ul>
</div>
</div>
<div class="sect1">
<h2 id="make-it-portable"><a class="anchor" href="#make-it-portable"></a>1. Make it portable</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Currently the packet is not actually portable, as it requires a power source which is established by a USB connection to the computer.</p>
</div>
<div class="paragraph">
<p>Firstly, to ensure portability can be achieved an independent power source is required, such as a battery that can provide the Raspberry Pi with adequate power to enable the packet to be tracked.</p>
</div>
<div class="paragraph">
<p>Secondly, it is necessary for the tracking script to be automatically enabled after the Raspberry Pi boot process has been executed.</p>
</div>
<div class="paragraph">
<p>This can easily be achieved on the Raspberry Pi by installing <code>pm2</code> globally using the following commands listed below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">npm install pm2 -g
pm2 startup</code></pre>
</div>
</div>
<div class="paragraph">
<p>This should print the applicable command in the terminal window.
Copy and paste it in the terminal again to complete the setup of the <code>pm2</code> startup script.</p>
</div>
<div class="paragraph">
<p>Start the tracking script with <code>pm2</code>.</p>
</div>
<div class="listingblock">
<div class="title">Run the following command inside the <code>light_alarm</code> folder on the Raspberry Pi as shown below:</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">pm2 start --name lightAlarm index.js</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Add the tracking script to the list of processes, that will be started automatically when the Raspberry Pi is started as shown below:</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">pm2 save</code></pre>
</div>
</div>
<div class="paragraph">
<p>After this has been performed, log out from the Raspberry Pi, disconnect it from the computer and connect it to an external portable power source.
After the boot process has finished (approximately 1-2 minutes), then the tracking script will start running, which in turn will check the light sensor every second.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="connect-more-nodes"><a class="anchor" href="#connect-more-nodes"></a>2. Connect more nodes</h2>
<div class="sectionbody">
<div class="paragraph">
<p>During development it is both necessary and convenient to have a rather centralized network with only one node connected.</p>
</div>
<div class="paragraph">
<p>Once the development has reached the point of concept or a usable product stage, it will be necessary to add more nodes to the network, and hence offer other potential users the opportunity to join the newly created blockchain network.</p>
</div>
<div class="paragraph">
<p>After completion of part 4, the set up should appear as shown below in the following diagram: <a href="part3.html" class="xref page">Part 3: A simple supply chain tracking system</a>.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../../_images/launch-seed_node.png" alt="One node diagram"></span></p>
</div>
<div class="paragraph">
<p>The next step is to add one more node to the network that communicates between the seed node, the IoT and the client application as shown in the next diagram below:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../../_images/launch-2_nodes.png" alt="More nodes diagram"></span></p>
</div>
<div class="sect2">
<h3 id="set-up-an-additional-seed-node"><a class="anchor" href="#set-up-an-additional-seed-node"></a>2.1. Set up an additional seed node</h3>
<div class="paragraph">
<p>When setting up a new node, each new node will firstly connect to the seed nodes when booting for the first time.
Starting from the seed node, a new node will discover the rest of the network by requesting their peer list.
This is followed by the peer lists of the newly discovered peers and so on.</p>
</div>
<div class="paragraph">
<p>The seed node is a node that is specified in the config of the node application under <code>modules.network.seedPeers</code> and this should remain connected to the network.</p>
</div>
<div class="paragraph">
<p>Furthermore, it is also convenient to have the genesis delegates actively forging on the seed node, in case the network does not yet have enough real delegates who can take the forging spots.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
The exposed <code>configDevnet</code> object is a good template for the config of a seed node, as it already includes the credentials from all of the 101 genesis delegates, and automatically enables forging for all of them.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="create-a-new-config-suited-for-the-node-application"><a class="anchor" href="#create-a-new-config-suited-for-the-node-application"></a>2.2. Create a new config suited for the node application</h3>
<div class="paragraph">
<p>Exchange the <code>configDevnet</code> object that was passed to the node during the development with the customized version.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>It is recommended to create a config object with all the options that are different to the default config options.
To check the default config options, go to the <a href="../../guides/app-development/configuration.html" class="xref page">configuration page</a> or check it directly in the code listed below:<br>
<code>lisk-framework/src/modules/MODULE_NAME/defaults/config.js</code>.<br>
The same for the components as shown below:<br>
<code>lisk-framework/src/components/COMPONENT_NAME/defaults/config.js</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Most of the configurations can stay the same as defined in the default config options.
However, please note that there is one option that should be updated: <strong>The seed node(s)</strong>.</p>
</div>
<div class="paragraph">
<p>So to add <code>1.2.3.4</code> as a seed node, add an object (or several objects), with the 2 properties <code>ip</code> and <code>wsPort</code> to the <code>seedPeers</code> list as displayed below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-js hljs" data-lang="js">const app = new Application(genesisBlockDevnet, {
    modules: {
        network: {
            seedPeers: [{ ip: '1.2.3.4', wsPort: 5000}]
        }
    }
});</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>By default, the forging delegates list is empty.<br>
This is intended, as the genesis delegates are only needed to set up a working development environment.
Subsequently it is recommended that the <code>delegates</code> list is empty, so that the users can input their own credentials in the case whereby they wish to activate forging on their node.</p>
</div>
<div class="paragraph">
<p>For example, for a proof of concept, in order to provide the already activated forging delegates inside the config; please use the devnet genesis delegates in <a href="https://github.com/LiskHQ/lisk-sdk/blob/3.0.2/sdk/src/samples/config_devnet.json" target="_blank" rel="noopener">configDevnet</a> or create your own genesis delegates and add them to the config.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="publish-the-application"><a class="anchor" href="#publish-the-application"></a>2.3. Publish the application</h3>
<div class="paragraph">
<p>Add the code for the customized <code>node</code> application (including the custom transactions), to a public code repository.
For example, on  <a href="https://github.com/" target="_blank" rel="noopener">Github</a> or <a href="https://about.gitlab.com/" target="_blank" rel="noopener">Gitlab</a>.</p>
</div>
<div class="paragraph">
<p>This provides everyone the opportunity to download the application and deploy it on a server in order to connect with the network.</p>
</div>
<div class="paragraph">
<p>The code should include at least the following files listed below:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/LiskHQ/lisk-sdk-examples/blob/v4/archive/3.x/transport/node/index.js" target="_blank" rel="noopener">index.js</a> : The code that initializes and starts the node application.</p>
</li>
<li>
<p><a href="https://github.com/LiskHQ/lisk-sdk-examples/blob/v4/archive/3.x/transport/node/package.json" target="_blank" rel="noopener">package.json</a>: A project file that lists all needed dependencies, (this should include <code>lisk-sdk</code> as a dependency).</p>
</li>
<li>
<p><a href="https://github.com/LiskHQ/lisk-sdk-examples/tree/v4/archive/3.x/transport/transactions" target="_blank" rel="noopener">transactions/</a>: A folder containing all required custom transactions.</p>
</li>
<li>
<p><code>README</code> : A Readme file which describes the most important steps to setup the node.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="connect-nodes-and-verify"><a class="anchor" href="#connect-nodes-and-verify"></a>2.4. Connect nodes and verify</h3>
<div class="paragraph">
<p>Add a second node to the network.</p>
</div>
<div class="paragraph">
<p>This new node will not have any forging activated, it is only required to talk via the API with the <code>client</code> application, and over the websocket connection to the seed node.
Therefore, at present the seed node is the only node at this point that can forge new blocks.
This is due to the fact that all the genesis delegates are actively forging on it.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
How to replace the genesis delegates with real delegates is covered in the next section <a href="#replace_delegates">Replace genesis delegates with real ones</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To set up the node, install the node application on a new server.
Just follow the instructions of the README, that was created in the previous step.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Do not forget to open the corresponding <a href="../../setup.html#ports" class="xref page">ports</a> for HTTP and WS communication!
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Once a new node is set up, update the API endpoint in the <a href="https://github.com/LiskHQ/lisk-sdk-examples/blob/v4/archive/3.x/transport/client/app.js#L14" target="_blank" rel="noopener">client</a> application to target the new node as shown below:</p>
</div>
<div class="listingblock">
<div class="title">Snippet of client/app.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-js hljs" data-lang="js">// Constants
const API_BASEURL = 'http://134.209.234.204:4000'; <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Add the correct IP and port to the newly added node.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If the client application has the API endpoint of the new node, it will receive transactions from the client.
The transactions will be visible in the logs, (if the log level is at least <code>info</code>).</p>
</div>
<div class="paragraph">
<div class="title">Logs of newly added node</div>
<p><span class="image"><img src="../../_images/synching_node.png" alt="Synching non forging node"></span></p>
</div>
<div class="paragraph">
<p>In the logs shown above it can be seen that the seed node was already 3 blocks ahead when the second node was started.
It first synchronizes the missing blocks up to the current height and then broadcasts the received transactions from the client app to the seed node, whereby the delegates can then add the transactions to blocks and forge them.</p>
</div>
<div class="paragraph">
<p>These new blocks are broadcast again to the new node, and the client application can display the data based on the API calls that it sends to the new node.</p>
</div>
<div class="paragraph">
<div class="title">Log of the seed node with the forging genesis delegates:</div>
<p><span class="image"><img src="../../_images/forging_node.png" alt="Forging node logs"></span></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Please be aware that broadcast errors can occur.</div>
<div class="paragraph">
<p>Sometimes errors occur when broadcasting transactions between the nodes.
There is no cause for concern here, as the node will re-start the sync process again; and in the majority of cases it is successful on the next attempt.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../../_images/common-sync-issue.png" alt="Common sync issue"></span></p>
</div>
<div class="paragraph">
<p>In the above image the block at height 284 is not accepted because of an invalid block timestamp.
As a result, the following blocks are also discarded by the node.</p>
</div>
<div class="paragraph">
<p>Anomalies like this can occur within the network.
The node can usually resolve these issues on its own by starting a new sync process, whereby it requests the missing blocks from one of its peer nodes.</p>
</div>
<div class="paragraph">
<p>As shown in the logs above, the blocks at height 284, 285 and 286 are displayed as discarded.
At this point the node realizes it is not in sync with the other nodes, and therefore starts the sync process.
This can also be seen in the above logs, <code>Starting sync</code>.
During the sync process the missing blocks are received from the peers and added to the database of the node.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="replace_delegates"><a class="anchor" href="#replace_delegates"></a>3. Replace genesis delegates with real ones</h2>
<div class="sectionbody">
<div class="paragraph">
<p>During development of the Lisk Transport application, one node was enabled for forging for all 101 genesis delegates.</p>
</div>
<div class="paragraph">
<p>After the release of the first version of the blockchain application, it is necessary that real delegates take the forging slots of the genesis delegates.
The network will become stable and decentralized for the first time when at least 51 real delegates are actively forging in the network.</p>
</div>
<div class="paragraph">
<p>To join the network as a new delegate, follow the steps listed below:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create your own private account on the network.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p><a href="../../references/lisk-commander/commands.html#create_account" class="xref page">Generate the account credentials</a></p>
</li>
<li>
<p>Send some funds (at least enough to register as a delegate), to the newly generated address in order to to initialize your account in the network.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Register a delegate.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p><a href="../../references/lisk-commander/commands.html#delegate_registration" class="xref page">Generate the delegate registration object</a>.</p>
</li>
<li>
<p>Broadcast the delegate registration to the network as shown below:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">export SECRET_PASSPHRASE=123456 <i class="conum" data-value="1"></i><b>(1)</b>
lisk transaction:create:delegate lightcurve -p=env:SECRET_PASSPHRASE | tee &gt;(curl -X POST -H "Content-Type: application/json" -d @- 1.2.3.4:4000/api/transactions) <i class="conum" data-value="2"></i><b>(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Replace <code>123456</code> with the secret passphrase.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Replace <code>1.2.3.4</code> with the IP of a node with a public API.</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Set up a node: Follow the steps in the <code>README</code> file of the application, (alternatively read the Lisk tutorials, as this process is basically identical).</p>
</li>
<li>
<p><a href="../../../../lisk-core/management/forging.html#forging_enable_disable" class="xref page">Enable forging for the newly created delegate on the node</a></p>
</li>
<li>
<p>People become convinced to vote for a delegate in the network, if the delegate has the following attributes:</p>
<div class="ulist">
<ul>
<li>
<p>Is helpful.</p>
</li>
<li>
<p>Is accountable.</p>
</li>
<li>
<p>Is sharing rewards.</p>
</li>
<li>
<p>Is offering useful services or tools.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/launch-3_nodes.png" alt="3 nodes diagram">
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>How to replace a genesis delegate</p>
</div>
<div class="paragraph">
<p>If a delegate joins the network at a very early stage, they will probably replace one of the genesis delegates.
The genesis delegates are voted in by the genesis account which holds all the tokens on the initial network start.
The genesis account votes with these tokens for the genesis delegates, in order to stabilize the network during the development.</p>
</div>
<div class="paragraph">
<p>Therefore, when replacing a genesis delegate, the new delegate will need to convince the person who controls the genesis account of the network; which will be most likely the application developer.</p>
</div>
<div class="paragraph">
<p>Later when the majority of the existing tokens are distributed among the different private accounts, the new delegate needs to gain the trust of the community in order to be voted into a forging position.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="write-tests-for-custom-transactions"><a class="anchor" href="#write-tests-for-custom-transactions"></a>4. Write tests for custom transactions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The more complex the logic inside the custom transactions, the more complicated it becomes to verify that the custom transaction logic is working as expected.</p>
</div>
<div class="paragraph">
<p>Therefore it is recommended to write <strong>unit tests</strong>, that verify the logic of the transaction type.</p>
</div>
<div class="paragraph">
<p>Especially for verifying the code of the <code>undoAsset()</code> function, it is convenient to write unit tests.
This is due to the fact that the code in the <code>undoAsset</code> function is only executed, if the node discovers itself on a fork with the main chain.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>To be on a fork means that the node added some different blocks to the chain than its peers.
In order to sync again with the network, it has to remove the blocks that are different, and undo the transactions inside these blocks.
To undo the transaction, the <code>undoAsset()</code> function will be called for each transaction inside of the blocks that need to be discarded.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To test if the transaction is undone correctly write a unit test as shown below:</p>
</div>
<div class="listingblock">
<div class="title">Example: Unit test for the undoAsset() function of the RegisterPacketTransaction</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-js hljs" data-lang="js">const RegisterPacketTransaction = require('../register-packet');
const transactions = require('@liskhq/lisk-transactions');
const { when } = require('jest-when');

const dateToLiskEpochTimestamp = date =&gt; (
    Math.floor(new Date(date).getTime() / 1000) - Math.floor(new Date(Date.UTC(2016, 4, 24, 17, 0, 0, 0)).getTime() / 1000)
);

describe('RegisterPacket Transaction', () =&gt; {
    let storeStub;
    beforeEach(() =&gt; {
        storeStub = {
            account: {
                get: jest.fn(),
                set: jest.fn(),
            },
        };
    });

    test('it should undo the state for register packet correctly', async () =&gt; {
        // Arrange
        const senderId = 'senderXYZ';
        const asset = {
            security: transactions.utils.convertLSKToBeddows('10'),
            minTrust: 0,
            postage: transactions.utils.convertLSKToBeddows('10'),
            packetId: 'not important',
        };

        const mockedPacketAccount = {
            address: 'xyz123',
        };
        const mockedSenderAccount = {
            address: 'abc123',
            balance: '10000000000', // 100 LSK
        };

        when(storeStub.account.get)
            .calledWith(asset.packetId)
            .mockReturnValue(mockedPacketAccount);

        when(storeStub.account.get)
            .calledWith(senderId)
            .mockReturnValue(mockedSenderAccount);

        // Act
        const tx = new RegisterPacketTransaction({
            senderId,
            asset,
            recipientId: 'xyzL',
            timestamp: dateToLiskEpochTimestamp(new Date()),
        });
        tx.undoAsset(storeStub);

        // Assert
        expect(storeStub.account.set).toHaveBeenNthCalledWith(
            1,
            mockedPacketAccount.address,
            {
                address: mockedPacketAccount.address,
                balance: 0,
                asset: null,
            }
        );

        expect(storeStub.account.set).toHaveBeenNthCalledWith(
            2,
            mockedSenderAccount.address,
            {
                address: mockedSenderAccount.address,
                balance: new transactions.utils.BigNum(mockedSenderAccount.balance).add(
                    new transactions.utils.BigNum(asset.postage)
                ).toString()
            }
        );
    });
});</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">What else needs to be tested?</dt>
<dd>
<p>Is writing unit tests really enough to ensure the functionality of a custom transaction ?<br>
<strong>Short answer: The unit tests are sufficient.</strong><br>
<strong>Explanation:</strong> You may wonder if it is required to write additional functional and integration tests.
Be aware that the correct reading and writing of the data to the database is already part of the Lisk SDK software testing, and therefore it is not needed to test it again for your new custom transaction.
Therefore unit tests are generally sufficient to test the functionality of a custom transaction.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="further-improvements"><a class="anchor" href="#further-improvements"></a>5. Further improvements</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Connect more sensors to secure the travel of the packet.
For example, implement a <code>TemperatureAlarm</code> or <code>HumidityAlarm</code>  to the <code>LightAlarm</code> transaction type.</p>
</div>
<div class="paragraph">
<p>Alternatively, let the network know the current location of the packet by transmitting the GPS location in a certain time interval.</p>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="part3.html">Part 3: A simple supply chain management system</a></span>
  <span class="next"><a href="../../references/index.html">References</a></span>
</nav>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <div class="footerdiv">
    <p>© 2022 Lisk Foundation</p>
    <!-- <div class="community-section">
      <p class="community-section__text">Follow Lisk on: </p>
      <div class="community-section__icons"> -->
    <div class="community_icons">
        <a href="https://lisk.chat" title="Discord" target="_blank" class="footer_icon icon-discord"><p>Discord</p></a>
        <a href="https://dev.lisk.com" title="Discourse" target="_blank" class="footer_icon icon-discourse"><p>Discourse</p></a>
        <a href="https://github.com/LiskHQ" title="GitHub" target="_blank" class="footer_icon icon-github"><p>GitHub</p></a>
  <!--    </div> -->
    </div>
  </div>
</footer>
<script src="../../../../_/js/site.js"></script>
<script async src="../../../../_/js/vendor/highlight.js"></script>
<script async src="../../../../_/js/vendor/tabs-block-behaviour.js"></script>
<script async src="../../../../_/js/vendor/swagger-ui.js"></script>
<script async src="../../../../_/js/vendor/component-versions.js"></script>
<script src="../../../../_/js/vendor/custom.js"></script>
  </body>
</html>
