<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>How to create a command :: Lisk documentation</title>
    <link rel="canonical" href="https://liskhq.github.io/lisk-docs/beta/build-blockchain/module/command.html">
    <link rel="prev" href="stores.html">
    <link rel="next" href="endpoints-methods.html">
    <meta name="generator" content="Antora 3.1.1">

  <link id="theme" rel="stylesheet" title="Default" href="../../../_/css/site.css">
  <link rel="stylesheet" title="Dark" href="../../../_/css/dark-site.css">

    <script>var uiRootPath = '../../../_'</script>
    <script src="../../../_/js/vendor/medium-zoom.js"></script>
    <script type="text/javascript" id="Cookiebot" src="https://consent.cookiebot.com/uc.js" data-cbid="e4db29b5-cd94-4bcf-87e4-04f4ca564240" data-blockingmode="manual"></script>

<link rel="icon" href="../../../_/img/favicon.png" type="image/x-icon">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <div class="top-logo">
        <a href="../../.." class="lisk-logo"></a>
        <a href="../../.." class="docs-logo"></a>
      </div>
      <!--<a class="navbar-item" href="https://liskhq.github.io/lisk-docs">Lisk documentation</a>-->
        <div id="docsearch" class="navbar-menu search-box hide-for-print">
          <!--<input id="search-input-toolbar" type="text" placeholder="Search me ...">-->
        </div>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">APIs</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="../../../api/lisk-node-http.html">Lisk node HTTP API</a>
            <a class="navbar-item" href="../../../api/lisk-node-rpc.html">Lisk node RPC API</a>
            <a class="navbar-item" href="../../../api/lisk-service-http.html">Lisk Service HTTP API</a>
            <a class="navbar-item" href="../../../api/lisk-service-rpc.html">Lisk Service RPC API</a>
            <a class="navbar-item" href="../../../api/lisk-service-pubsub.html">Lisk Service Pub/Sub API</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Explorers</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://lisk.observer/" target="_blank">Lisk Observer</a>
            <a class="navbar-item" href="https://liskscan.com/" target="_blank">LiskScan</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Products</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="../../../lisk-sdk/">Lisk SDK</a>
            <a class="navbar-item" href="../../../lisk-service/">Lisk Service</a>
            <a class="navbar-item" href="../../../lisk-core/">Lisk Core</a>
            <a class="navbar-item" href="https://lisk.com/wallet" target="_blank">Lisk Wallets</a>
          </div>
        </div>
        <button onclick="switch_style('toggle')" id="theme-toggle" class="theme-toggle navbar-item"></button>
        <!-- <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="#">Download</a>
          </span>
        </div> -->
      </div>
    </div>
  </nav>
</header>
<div class="toolbar" role="navigation">
  <button class="nav-toggle"></button>
  <div class="components-versions">
      <div class="page-components">
    <button class="component-menu-toggle" title="Show other documentations">Lisk Documentation</button>
    <div class="component-menu">
        <a class="component" href="../../../lisk-core/index.html">Lisk Core</a>
        <a class="component" href="../../../lisk-docs-manual/index.html">Lisk docs manual</a>
        <a class="component is-current" href="../../../index.html">Lisk Documentation</a>
        <a class="component" href="../../../lisk-sdk/index.html">Lisk SDK</a>
        <a class="component" href="../../../lisk-service/index.html">Lisk Service</a>
    </div>
  </div>
    <span></span>
    <div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">beta</button>
  <div class="version-menu">
    <a class="version is-missing" href="../../../index.html">default</a>
    <a class="version is-current" href="command.html">beta</a>
  </div>
</div>
  </div>
  <span></span>
  <span></span>
  <a href="../../../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../index.html">Lisk Documentation</a></li>
    <li><a href="../index.html">Build Blockchain</a></li>
    <li><a href="index.html">How to create a module</a></li>
    <li><a href="command.html">3. How to create a command</a></li>
  </ul>
</nav>
    <div id="docsearch-toolbar" class="search-box hide-for-print toolbar-search">
      <!--<input id="search-input" type="text" placeholder="Search me ...">-->
    </div>
  <div class="edit-this-page"><a href="https://github.com/LiskHQ/lisk-docs/edit/1531-update-enable-forging/docs/modules/ROOT/pages/build-blockchain/module/command.adoc"><img class="pencil">Edit this Page</a></div>
  </div>
<div class="body">
<div class="nav-container" data-component="ROOT" data-version="beta">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../../index.html">Lisk Documentation</a></h3>
<ul class="nav-list">
  <li class="nav-item parent" data-depth="0">
<ul class="nav-list">
  <li class="nav-item parent" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Introduction</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../intro/what-is-blockchain.html">What is blockchain?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../intro/how-blockchain-works.html">How blockchain works</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../intro/blockchain-scalability.html">Blockchain Scalability</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../intro/lisk-products.html">Lisk products</a>
  </li>
</ul>
  </li>
  <li class="nav-item parent" data-depth="1">
    <button class="nav-item-toggle"></button>
        <span>
    <a class="nav-link" href="../../understand-blockchain/index.html">Understand Lisk Blockchain</a>
        </span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../understand-blockchain/state-machine.html">State machine</a>
  </li>
  <li class="nav-item parent" data-depth="2">
    <button class="nav-item-toggle"></button>
        <span>
    <a class="nav-link" href="../../understand-blockchain/interoperability/index.html">Lisk Interoperability</a>
        </span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../understand-blockchain/interoperability/communication.html">Cross-chain communication</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../understand-blockchain/interoperability/sidechain-registration-and-recovery.html">Sidechain Registration &amp; Recovery</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../understand-blockchain/blocks-txs.html">Blocks and Transactions</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../understand-blockchain/sdk/modules-commands.html">Modules and Commands</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../understand-blockchain/sdk/plugins.html">Plugins</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../understand-blockchain/sdk/rpc.html">Communicating to a Lisk node via RPC</a>
  </li>
</ul>
  </li>
  <li class="nav-item parent" data-depth="1">
    <button class="nav-item-toggle"></button>
        <span>
    <a class="nav-link" href="../index.html">Build Blockchain</a>
        </span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../create-sidechain-app.html">Creating a new sidechain application</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../configuration.html">Sidechain client configuration</a>
  </li>
  <li class="nav-item parent" data-depth="2">
    <button class="nav-item-toggle"></button>
        <span>
    <a class="nav-link" href="index.html">How to create a module</a>
        </span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="configuration.html">1. How to create a module configuration</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="stores.html">2. How to create stores</a>
  </li>
  <li class="nav-item is-current-page" data-depth="3">
    <a class="nav-link" href="command.html">3. How to create a command</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="endpoints-methods.html">4. How to create endpoints and methods</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="blockchain-event.html">5. How to create a blockchain event</a>
  </li>
</ul>
  </li>
  <li class="nav-item parent" data-depth="2">
    <button class="nav-item-toggle"></button>
        <span>
    <a class="nav-link" href="../plugin/index.html">How to create a plugin</a>
        </span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../plugin/schema-types.html">1. Defining off-chain data structures</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../plugin/offchain-db.html">2. Setting up an Off-chain database</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../plugin/configuring-plugin.html">3. Configuring a Plugin</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../plugin/plugin-class.html">4. Updating the Plugin Class</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../plugin/plugin-endpoints.html">5. Creating an endpoint &amp; Testing the plugin</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../create-genesis-block.html">How to create a new genesis block</a>
  </li>
</ul>
  </li>
  <li class="nav-item parent" data-depth="1">
    <button class="nav-item-toggle"></button>
        <span>
    <a class="nav-link" href="../../run-blockchain/index.html">Run Blockchain</a>
        </span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../run-blockchain/process-management.html">Process management with PM2</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../run-blockchain/become-a-validator.html">How to become a validator</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../run-blockchain/staking.html">How to stake and unstake tokens</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../run-blockchain/enable-block-generation.html">How to enable/disable block generation</a>
  </li>
</ul>
  </li>
  <li class="nav-item parent" data-depth="1">
    <button class="nav-item-toggle"></button>
        <span>
    <a class="nav-link" href="../../integrate-blockchain/index.html">Integrate Blockchain</a>
        </span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../integrate-blockchain/connecting-endpoints.html">Connecting to endpoints</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item parent" data-depth="0">
<ul class="nav-list">
  <li class="nav-item parent" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">APIs</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../api/lisk-node-rpc.html">RPC API for Lisk nodes</a>
  </li>
</ul>
  </li>
  <li class="nav-item parent" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Products</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../lisk-sdk/index.html">Lisk SDK</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../lisk-core/index.html">Lisk Core</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../bug-bounty-program.html">Lisk Bug Bounty Program</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../glossary.html">Glossary</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Lisk Documentation</span>
    <span class="version">beta</span>
  </div>
  <ul class="components">
    <li class="component">
      <a class="title" href="../../../lisk-core/index.html">Lisk Core</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../lisk-core/index.html">3.0.4 (latest)</a>
        </li>
        <li class="version">
          <a href="../../../lisk-core/v4/index.html">4.0.0-beta.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../lisk-docs-manual/index.html">Lisk docs manual</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../lisk-docs-manual/index.html">0.1.0</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <a class="title" href="../../../index.html">Lisk Documentation</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../index.html">default</a>
        </li>
        <li class="version is-current">
          <a href="../../index.html">beta</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../lisk-sdk/index.html">Lisk SDK</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../lisk-sdk/index.html">5.2.2 (latest)</a>
        </li>
        <li class="version">
          <a href="../../../lisk-sdk/v6/index.html">6.0.0 (beta)</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../lisk-service/index.html">Lisk Service</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../lisk-service/index.html">0.6.4 (latest)</a>
        </li>
        <li class="version">
          <a href="../../../lisk-service/v0.7/index.html">0.7.0 (beta)</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">How to create a command</h1>
<div id="preamble">
<div class="sectionbody">
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>On this page, you&#8217;ll learn how to:</p>
</div>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-check-square-o"></i> Create a new command</p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> Write verification for a command</p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> Use module config values for command verification</p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> Write execution logic for a command</p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> Get and set data from module stores</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Sample code</div>
<div class="paragraph">
<p>View the complete sample code of this guide on GitHub in the <a href="https://github.com/LiskHQ/lisk-sdk-examples/tree/development/tutorials/hello/hello_client/src/app/modules/hello/commands/create_hello_command.ts" target="_blank" rel="noopener">Lisk SDK examples repository</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="paragraph">
<p>As defined on the <a href="index.html" class="xref page">How to create a module</a> page, the <a href="../../understand-blockchain/sdk/modules-commands.html#commands" class="xref page">command</a> shall provide the following functionality:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A Hello message shall be stored in the user accounts.</p>
<div class="ulist">
<ul>
<li>
<p>The Hello message has to be of type <code>string</code>.</p>
</li>
<li>
<p>The Hello message shall have a minimum and maximum length.</p>
</li>
<li>
<p>A blacklist of excluded words should exist.
The Hello message should be rejected, if it includes one of the words in the blacklist.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#generating-the-command-skeleton">1. Generating the command skeleton</a></li>
<li><a href="#command-class-skeleton">2. Command class &amp; skeleton</a></li>
<li><a href="#command-params-schema">3. Command params &amp; schema</a></li>
<li><a href="#getting-the-module-config">4. Getting the module config</a></li>
<li><a href="#command-verification">5. Command verification</a></li>
<li><a href="#command-execution">6. Command execution</a></li>
<li><a href="#try-the-new-command-out">7. Try the new command out</a>
<ul class="sectlevel2">
<li><a href="#testing-the-command-verification">7.1. Testing the command verification</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="sect1">
<h2 id="generating-the-command-skeleton"><a class="anchor" href="#generating-the-command-skeleton"></a>1. Generating the command skeleton</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In the root folder of the sidechain client, generate a skeleton for the new command with Lisk Commander.</p>
</div>
<div class="paragraph">
<p>The command <code>lisk generate:command</code> expects two arguments:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Module name</strong>: The name of the module the command belongs to.</p>
</li>
<li>
<p><strong>Command name</strong>: The name of the new command.
It needs to be a string that only consists of lower case and upper case letters [a-z, A-Z].
No numbers, hyphens, etc., are allowed.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>For a complete overview of all available options of <code>lisk generate:command</code>, see the Lisk Commander reference or type <code>lisk generate:command --help</code>.</p>
</div>
<div class="paragraph">
<p>For our example, we choose <code>createHello</code> as the command name, and <code>hello</code>  as the module name:</p>
</div>
<div id="generate-command" class="listingblock">
<div class="title">In the client root folder</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">lisk generate:command hello createHello</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will generate the following files:</p>
</div>
<div class="listingblock">
<div class="title">hello/hello_client/</div>
<div class="content">
<pre>├── bin/
├── config/
├── src/
│    ├── app/
│    │    ├── app.ts
│    │    ├── index.ts
│    │    ├── modules/
│    │    │   └── hello/
│    │    │      ├── commands/ <i class="conum" data-value="1"></i><b>(1)</b>
│    │    │      │     └──  create_hello_command.ts <i class="conum" data-value="2"></i><b>(2)</b>
│    │    │      ├── endpoint.ts
│    │    │      ├── events/
│    │    │      ├── method.ts
│    │    │      ├── module.ts
│    │    │      └── stores/
│    │    ├── modules.ts
│    │    ├── plugins/
│    │    └── plugins.ts
│    └── commands/
└── test/
    ├── integration/
    ├── network/
    └── unit/
        ├── modules/
        │    └── hello/
        │       ├── commands/
        │       │     └──  create_hello_command.ts <i class="conum" data-value="3"></i><b>(3)</b>
        │       └── modules.spec.ts
        └── plugins/</pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>commands/</code> folder contains the <a href="../../understand-blockchain/sdk/modules-commands.html#commands" class="xref page">commands</a> of the module.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Will contain the code for the command.
Currently, it contains the auto-generated command skeleton.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Will contain unit tests for the command.
Currently, it contains the auto-generated test skeletons.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Additionally, it will already import and register the new command in the Hello module:</p>
</div>
<div class="listingblock">
<div class="title">hello_client/src/app/modules/hello/module.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">import { CreateHelloCommand } from "./commands/create_hello_command";
// [...]
export class HelloModule extends BaseModule {
    // [...]
	public commands = [new CreateHelloCommand(this.stores, this.events)];
    // [...]
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="command-class-skeleton"><a class="anchor" href="#command-class-skeleton"></a>2. Command class &amp; skeleton</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The command <code>lisk generate:command</code> already created the class <code>CreateHelloCommand</code> which contains skeletons for the most important components of the command.</p>
</div>
<div class="paragraph">
<p>The command class always extends from the <code>BaseCommand</code>, which is imported from the <code>lisk-sdk</code> package.</p>
</div>
<div class="paragraph">
<p>However, this command is not performing any functions yet.
To change this, we implement the methods of the command in the following chapters.</p>
</div>
<div class="paragraph">
<p>Open the command skeleton in <code>create_hello_command.ts</code>:</p>
</div>
<div class="listingblock">
<div class="title">hello_client/src/app/modules/hello/commands/create_hello_command.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">import {
    BaseCommand,
    CommandVerifyContext,
    CommandExecuteContext,
    VerificationResult,
    VerifyStatus,
} from 'lisk-sdk';

interface Params {
}

export class CreateHelloCommand extends BaseCommand {
	public schema = {
		$id: 'CreateHelloCommand',
		type: 'object',
		properties: {},
	};

	// eslint-disable-next-line @typescript-eslint/require-await
	public async verify(_context: CommandVerifyContext&lt;Params&gt;): Promise&lt;VerificationResult&gt; {
		return { status: VerifyStatus.OK };
	}

	public async execute(_context: CommandExecuteContext&lt;Params&gt;): Promise&lt;void&gt; {
	}
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="command-params-schema"><a class="anchor" href="#command-params-schema"></a>3. Command params &amp; schema</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The command parameters are data that is provided by the transaction, that is required by the command to execute its business logic.
The parameters interface and schema define the data type, and order of the command.</p>
</div>
<div class="paragraph">
<p>The command schema can also define additional properties like min and max length of a parameter.</p>
</div>
<div class="paragraph">
<p>For creating a Hello message, define the parameters like so:</p>
</div>
<div class="listingblock">
<div class="title">hello_client/src/app/modules/hello/commands/create_hello_command.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">interface Params {
	message: string;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The only property needed by the module is the <code>message</code> that the sender posted.</p>
</div>
<div class="paragraph">
<p>For the corresponding schema, create a new file <code>schema.ts</code> in the root folder of the Hello module.</p>
</div>
<div class="paragraph">
<p>This file will be used to store all schemas that the module requires, for a better overview.</p>
</div>
<div class="listingblock">
<div class="title">hello_client/src/app/modules/hello/schema.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">export const createHelloSchema = {
	$id: 'hello/createHello-params',
	title: 'CreateHelloCommand transaction parameter for the Hello module',
	type: 'object',
	required: ['message'],
	properties: {
		message: {
			dataType: 'string',
			fieldNumber: 1,
			minLength: 3,
			maxLength: 256,
		},
	},
};</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that we add two additional properties to the schema: <a href="https://json-schema.org/understanding-json-schema/reference/string.html#length">minLength &amp; maxLength</a>.
These properties define the minimum and maximum length of the message, according to the <strong>JSON schema</strong>.</p>
</div>
<div class="paragraph">
<p>By setting these properties already in the schema, we don&#8217;t need to validate these properties later in the <a href="#command-verification">Command verification</a>.
Please check the <a href="https://json-schema.org/understanding-json-schema/reference/index.html" target="_blank" rel="noopener">JSON schema reference</a> for information about other available keywords.</p>
</div>
<div class="paragraph">
<p>Now, import the schema to the Hello module and use it for the <code>schema</code> attribute of the module.:</p>
</div>
<div class="listingblock">
<div class="title">hello_client/src/app/modules/hello/commands/create_hello_command.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">import { createHelloSchema } from '../schema';
// [...]
export class CreateHelloCommand extends BaseCommand {
    public schema = createHelloSchema;
    // [...]
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="getting-the-module-config"><a class="anchor" href="#getting-the-module-config"></a>4. Getting the module config</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Next, we need to get the blacklist, because it is required in the next step during the <a href="#command-verification">Command verification</a>.
The blacklist can be retrieved from the module config, which was defined in the guide on <a href="configuration.html" class="xref page">How to create a module configuration</a>.
Also, we want to update the minimum and maximum message length of the command schema with the values from the module configuration.</p>
</div>
<div class="paragraph">
<p>To do this, create a new method <code>init()</code> in the command, that can be called in the <code>init()</code> function of the module, after the module received the values from the config:</p>
</div>
<div class="listingblock">
<div class="title">hello_client/src/app/modules/hello/commands/create_hello_command.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">// [...]
export class CreateHelloCommand extends BaseCommand {
    public schema = createHelloSchema;
	private _blacklist!: string[];

    public async init(config: ModuleConfig): Promise&lt;void&gt; {
		// Set _blacklist to the value of the blacklist defined in the module config
		this._blacklist = config.blacklist;
		// Set the max message length to the value defined in the module config
		this.schema.properties.message.maxLength = config.maxMessageLength;
		// Set the min message length to the value defined in the module config
		this.schema.properties.message.minLength = config.minMessageLength;
	}
    // [...]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>To store the blacklisted words from the module config in the command, create a new private command attribute <code>_blacklist</code>.
Inside the <code>init()</code> method of the command, assign the blacklist defined in the module config to <code>this._blacklist</code>, and also update the command schema with the minimum and maximum message length values defined in the config.</p>
</div>
<div class="paragraph">
<p>Then, call the method at the bottom of the <code>init()</code> method of the module and use the respective config values as parameters:</p>
</div>
<div class="listingblock">
<div class="title">hello_client/src/app/modules/hello/module.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">// [...]
export class HelloModule extends BaseModule {
    // [...]
    public async init(args: ModuleInitArgs): Promise&lt;void&gt; {
        // Get the module config defined in the config.json file
        const { moduleConfig } = args;
        // Overwrite the default module config with values from config.json, if set
        const config = utils.objects.mergeDeep({}, defaultConfig, moduleConfig) as ModuleConfigJSON;
        // Validate the provided config with the config schema
        validator.validate&lt;ModuleConfigJSON&gt;(configSchema, config);
        // Call the command init() method with config as parameter
        this.commands[0].init(config).catch(err =&gt; {
            console.log("Error: ", err);
        });
    }
    // [...]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now, the <code>blacklist</code>, <code>minMessageLength</code>, and <code>maxMessageLength</code>, which are defined in the <strong>config.json</strong> file, are available in the command, and we can move on to implement the <a href="#command-verification">Command verification</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="command-verification"><a class="anchor" href="#command-verification"></a>5. Command verification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The command is always verified before it is executed by the node as defined in the <a href="#command-execution">Command execution</a>.
The verification of the command is defined in the <code>verify()</code> method of the command.</p>
</div>
<div class="paragraph">
<p>The <code>CreateHello</code> command expects only one single parameter inside of the transaction, and this is the Hello message.
Therefore, only the message needs to be verified here.</p>
</div>
<div class="paragraph">
<p>The following points should be validated:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The message should not be shorter than the minimum message length defined in the command schema.</p>
</li>
<li>
<p>The message should not be longer than the maximum message length defined in the command schema.</p>
</li>
<li>
<p>The message should not contain any of the words defined in the blacklist of module config.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>We don&#8217;t need to validate points 1. and 2. in the <code>verify()</code> method, because they are already validated by the schema.</p>
</div>
<div class="paragraph">
<p>For point 3. however, the blacklisted words, cannot be checked with the schema.
So let&#8217;s implement the <code>verify()</code> method to filter the message for words in the blacklist, and throw an error if any word is found.</p>
</div>
<div class="listingblock">
<div class="title">hello_client/src/app/modules/hello/commands/create_hello_command.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">// [...]
export class CreateHelloCommand extends BaseCommand {
    public schema = createHelloSchema;
    private _blacklist!: string[];

    public async init(config: ModuleConfig): Promise&lt;void&gt; {
        // [...]
    }

    public async verify(context: CommandVerifyContext&lt;Params&gt;): Promise&lt;VerificationResult&gt; {
        let validation: VerificationResult;
        const wordList = context.params.message.split(" ");
        const found = this._blacklist.filter(value =&gt; wordList.includes(value));
        if (found.length &gt; 0) {
            context.logger.info("==== FOUND: Message contains a blacklisted word ====");
            throw new Error(
                `Illegal word in hello message: ${  found.toString()}`
            );
        } else {
            context.logger.info("==== NOT FOUND: Message contains no blacklisted words ====");
            validation = {
                status: VerifyStatus.OK
            };
        }
        return validation;
    }
    // [...]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>context</code> of the <code>verify(context)</code> method contains the parameters of the command to be verified.
So first, access the <code>message</code> parameter through <code>context.params.message</code> and split the different words of the message by space, and save the resulting words in a word list.
Now, filter the blacklisted words, and store any word which is also present in the message word list in a new list called <code>found</code>.</p>
</div>
<div class="paragraph">
<p>Next, check the length of the <code>found</code> list. If it is greater than 0, it means, the message contains at least one word that is also included in the blacklist.
In that case, set the status to <code>VerifyStatus.FAIL</code> and include a descriptive error message under the <code>error</code> property as well.</p>
</div>
<div class="paragraph">
<p>If no blacklisted words are found, set the status to <code>VerifyStatus.OK</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="command-execution"><a class="anchor" href="#command-execution"></a>6. Command execution</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>execute()</code> function is the place in the command where the state changes on the sidechain are made.</p>
</div>
<div class="paragraph">
<p>A command will only be executed, if the <a href="#command-verification">Command verification</a> was successful.</p>
</div>
<div class="paragraph">
<p>The purpose of this command is to save a Hello message for the corresponding sender account.
Also, we need to increment the Hello counter by one, each time a command is executed.</p>
</div>
<div class="paragraph">
<p>Following this, the general business logic of the <code>execute()</code> method looks like this:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Get the account data of the sender of the "Create Hello" transaction.</p>
</li>
<li>
<p>Get the message and counter stores, that we created in the example in <a href="stores.html" class="xref page">How to create stores</a>.</p>
</li>
<li>
<p>Save the Hello message to the message store, using the <code>senderAddress</code> as the key, and the <code>message</code> as the value.</p>
</li>
<li>
<p>Get the Hello counter from the counter store.</p>
</li>
<li>
<p>Increment the Hello counter +1.</p>
</li>
<li>
<p>Save the Hello counter to the counter store.</p>
</li>
<li>
<p>Emit a "New Hello" event.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The corresponding code is shown below:</p>
</div>
<div class="listingblock">
<div class="title">hello_client/src/app/modules/hello/commands/create_hello_command.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">import {
	BaseCommand,
	CommandVerifyContext,
	CommandExecuteContext,
	VerificationResult,
	VerifyStatus,
} from 'lisk-sdk';
import { createHelloSchema } from '../schema';
import { MessageStore } from '../stores/message';
import { counterKey, CounterStore, CounterStoreData } from '../stores/counter';
import { ModuleConfig } from '../types';
import { NewHelloEvent } from '../events/new_hello';

export class CreateHelloCommand extends BaseCommand {
    public schema = createHelloSchema;
    private _blacklist!: string[];
    public async init(config: ModuleConfig): Promise&lt;void&gt; {
        // [...]
    }

	// eslint-disable-next-line @typescript-eslint/require-await
    public async verify(context: CommandVerifyContext&lt;Params&gt;): Promise&lt;VerificationResult&gt; {
        // [...]
    }

    public async execute(context: CommandExecuteContext&lt;Params&gt;): Promise&lt;void&gt; {
        // 1. Get account data of the sender of the Hello transaction.
        const { senderAddress } = context.transaction;
        // 2. Get message and counter stores.
        const messageSubstore = this.stores.get(MessageStore);
        const counterSubstore = this.stores.get(CounterStore);

        // 3. Save the Hello message to the message store, using the senderAddress as key, and the message as value.
        await messageSubstore.set(context, senderAddress, {
            message: context.params.message,
        });

        // 3. Get the Hello counter from the counter store.
        let helloCounter: CounterStoreData;
        try {
            helloCounter = await counterSubstore.get(context, counterKey);
        } catch (error) {
            helloCounter = {
                counter: 0,
            }
        }
        // 5. Increment the Hello counter +1.
        helloCounter.counter+=1;

        // 6. Save the Hello counter to the counter store.
        await counterSubstore.set(context, counterKey, helloCounter);

        // 7. Emit a "New Hello" event
        const newHelloEvent = this.events.get(NewHelloEvent);
        newHelloEvent.add(context, {
            senderAddress: context.transaction.senderAddress,
            message: context.params.message
        },[context.transaction.senderAddress]);
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="try-the-new-command-out"><a class="anchor" href="#try-the-new-command-out"></a>7. Try the new command out</h2>
<div class="sectionbody">
<div class="paragraph">
<p>As a final step, let&#8217;s try out the command that we just created, by posting a "Create Hello" transaction to the node.</p>
</div>
<div class="paragraph">
<p>In the root folder of the Hello client, execute the following steps in the terminal:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Rebuild the client:</p>
<div class="literalblock">
<div class="content">
<pre>npm run build</pre>
</div>
</div>
</li>
<li>
<p>Start the client:</p>
<div id="create-transaction" class="literalblock">
<div class="content">
<pre>./bin/run start --config=config/custom_config.json</pre>
</div>
</div>
</li>
<li>
<p>In another terminal window, create the transaction:</p>
<div class="literalblock">
<div class="content">
<pre>% ./bin/run transaction:create hello createHello 10000000 --params='{"message":"Hello Lisk SDK v6!"}' --json --pretty</pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The <code>transaction:create</code> command uses the default key derivation path by default.
The default key derivation path is <code>m/44'/134'/0</code>, which always corresponds to the first account listed in <code>dev-validators.json</code>.</p>
</div>
<div class="paragraph">
<p>If you want to use another account, for example the second account of the <code>dev-validators.json</code> file, you need to specify the corresponding key derivation path by using the flag <code>--key-derivation-path</code> like so:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>% ./bin/run transaction:create hello createHello 10000000 --params='{"message":"Hello Lisk SDK v6!"}' --json --key-derivation-path="m/44'/134'/1'" --pretty</pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Use the passphrase contained in the file <code>config/default/passphrase.json</code> when prompted for it.
You can ignore the warning <code>Warning: Passphrase contains 24 words instead of expected 12. Passphrase contains 23 whitespaces instead of expected 11.</code>
The output of the command looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">{
  "transaction": "0a0568656c6c6f120b63726561746548656c6c6f18002080ade2042a205412b41c5bf15b68c779c87fc44baafdf5d2301556227a91a60599b86b4ab51e322b0a2968692c2074686973206973206120746573742c20696c6c6567616c576f726420616e6420736f206f6e3a400cd91d8980e057b87186563def7ec3c33d4c00cab40dcaadd222d8e4ddc95402edfafd6e4f387ef7cb4eca88b36c8dd774448163388d08c4c1522efd5bc23102"
}
{
  "transaction": {
    "module": "hello",
    "command": "createHello",
    "fee": "10000000",
    "nonce": "0",
    "senderPublicKey": "5412b41c5bf15b68c779c87fc44baafdf5d2301556227a91a60599b86b4ab51e",
    "signatures": [
      "0cd91d8980e057b87186563def7ec3c33d4c00cab40dcaadd222d8e4ddc95402edfafd6e4f387ef7cb4eca88b36c8dd774448163388d08c4c1522efd5bc23102"
    ],
    "params": {
      "message": "Hello Lisk SDK v6!"
    },
    "id": "7ffb4283f0ecc765b7ddb1494e97c22471e136824b437594945f0a8224bc7abf"
  }
}</code></pre>
</div>
</div>
<div id="send-transaction" class="paragraph">
<p>The first object is the transaction in binary format, and the second object is the same transaction in JSON format, because we added the flags <code>--json</code> and <code>pretty</code>.</p>
</div>
</li>
<li>
<p><strong>Send the transaction:</strong>
Use the transaction in binary format to post the transaction to the node as shown below.
Note: When you use <code>curl</code>, make sure you have <code>http</code> enabled in the config under <code>rpc.modes</code>.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">curl --location --request POST 'http://localhost:7887/rpc' \
--header 'Content-Type: application/json' \
--data-raw '{
    "jsonrpc": "2.0",
    "id": "1",
    "method": "txpool_postTransaction",
    "params": {
        "transaction": "0a0568656c6c6f120b63726561746548656c6c6f18002080ade2042a205412b41c5bf15b68c779c87fc44baafdf5d2301556227a91a60599b86b4ab51e322b0a2968692c2074686973206973206120746573742c20696c6c6567616c576f726420616e6420736f206f6e3a400cd91d8980e057b87186563def7ec3c33d4c00cab40dcaadd222d8e4ddc95402edfafd6e4f387ef7cb4eca88b36c8dd774448163388d08c4c1522efd5bc23102"
    }
}'</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the transaction was posted successfully, it will respond with the transaction ID.</p>
</div>
</li>
<li>
<p><strong>Check the logs of the node:</strong>
To verify that the transaction was included in a block, check for the corresponding node logs:</p>
<div class="paragraph">
<p>Transaction was included in Transaction pool:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>2022-11-04T10:18:47.826Z INFO engine 33965 [id=7ffb4283f0ecc765b7ddb1494e97c22471e136824b437594945f0a8224bc7abf nonce=0 senderPublicKey=5412b41c5bf15b68c779c87fc44baafdf5d2301556227a91a60599b86b4ab51e] Added transaction to pool</pre>
</div>
</div>
<div class="paragraph">
<p>Transaction was included in a block:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>2022-11-04T10:18:50.422Z INFO engine 33965 [id=a58eed5296010bb0fbd8ae4118b101d137c24697c457f86dab9ac29879b2ab8f height=99 generator=lskaz4tmrvjnuz5fx956mh8b6x6g4d8fr5vdnk3ha numberOfTransactions=1 numberOfAssets=1 numberOfEvents=5] Block executed</pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>But how to actually get the hello messages back?
Right now, there is only one way to post a hello message.
Also, although the counter is created and incremented, however, there is no way for an external service to request the data.</p>
</div>
<div class="paragraph">
<p>To get Hello messages and the counter from the module, implement <a href="endpoints-methods.html" class="xref page">Endpoints and Methods</a> as explained in the next chapter.</p>
</div>
<div class="sect2">
<h3 id="testing-the-command-verification"><a class="anchor" href="#testing-the-command-verification"></a>7.1. Testing the command verification</h3>
<div class="paragraph">
<p>To verify, if the verification of the command works as expected, create a transaction, similar to how it is done in the previous section <a href="#try-the-new-command-out">Try the new command out</a>.</p>
</div>
<div class="paragraph">
<p>But in this case, we want the transaction to be invalid, to verify it is using the values defined in the <code>custom_config.json</code>, that we created in guide <a href="configuration.html" class="xref page">How to create a module configuration</a>.
Therefore, it should violate at least one of the three command validations:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Minimum Hello message length: 5.</p>
</li>
<li>
<p>Maximum Hello message length: 300.</p>
</li>
<li>
<p>The Hello message contains none of the blacklisted words.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>For example, create the following Hello transaction, which is violating the third requirement by including a blacklisted word:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>% ./bin/run transaction:create hello createHello 10000000 --params='{"message":"Hello this is an illegalWord1"}' --json --pretty</pre>
</div>
</div>
<div class="paragraph">
<p>Then, <a href="#send-transaction">send the transaction</a> to the node, and wait for the response.</p>
</div>
<div class="paragraph">
<p>If the message violates one of the three requirements, the command verification fails and the node returns the following response, indicating that the transaction was not accepted:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
    "jsonrpc": "2.0",
    "id": "1",
    "error": {
        "message": "Transaction verification failed.",
        "code": -32600
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="stores.html">2. How to create stores</a></span>
  <span class="next"><a href="endpoints-methods.html">4. How to create endpoints and methods</a></span>
</nav>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <div class="footerdiv">
    <p>© 2022 Lisk Foundation</p>
    <!-- <div class="community-section">
      <p class="community-section__text">Follow Lisk on: </p>
      <div class="community-section__icons"> -->
    <div class="community_icons">
        <a href="https://lisk.chat" title="Discord" target="_blank" class="footer_icon icon-discord"><p>Discord</p></a>
        <a href="https://dev.lisk.com" title="Discourse" target="_blank" class="footer_icon icon-discourse"><p>Discourse</p></a>
        <a href="https://github.com/LiskHQ" title="GitHub" target="_blank" class="footer_icon icon-github"><p>GitHub</p></a>
  <!--    </div> -->
    </div>
  </div>
</footer>
<script src="../../../_/js/site.js"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
<script async src="../../../_/js/vendor/tabs-block-behaviour.js"></script>
<script async src="../../../_/js/vendor/swagger-ui.js"></script>
<script async src="../../../_/js/vendor/component-versions.js"></script>
<script src="../../../_/js/vendor/custom.js"></script>
  <script src="../../../_/js/vendor/docsearch.js"></script>
  <!--<script src="../../../_/js/vendor/docsearch.min.js"></script>-->
  <!--<script src="https://cdn.jsdelivr.net/npm/@docsearch/js@alpha"></script>-->
  <script>
    docsearch({
      container: '#docsearch',
        appId: 'C4SU57KGV9',
      apiKey: '55aa8709b04eb62f08f87571cf77547c',
      indexName: 'lisk-docs-search'
    });
    docsearch({
      container: '#docsearch-toolbar',
        appId: 'C4SU57KGV9',
      apiKey: '55aa8709b04eb62f08f87571cf77547c',
      indexName: 'lisk-docs-search'
    });
  </script>
  <!--<script>
    function focusSearchInput () { document.querySelector('#search-input').focus() }
    var search = docsearch({
        appId: 'C4SU57KGV9',
      apiKey: '55aa8709b04eb62f08f87571cf77547c',
      indexName: 'lisk-docs-search',
      inputSelector: '#search-input',
      autocompleteOptions: { hint: false, keyboardShortcuts: ['s'] },
      algoliaOptions: { hitsPerPage: 10 }
    }).autocomplete
    search.on('autocomplete:closed', function () { search.autocomplete.setVal() })
    focusSearchInput()
    window.addEventListener('load', focusSearchInput)
  </script>-->
<!--  <script>
    function focusSearchInputToolbar () { document.querySelector('#search-input-toolbar').focus() }
    var search = docsearch({
        appId: 'C4SU57KGV9',
      apiKey: '55aa8709b04eb62f08f87571cf77547c',
      indexName: 'lisk-docs-search',
      inputSelector: '#search-input-toolbar',
      autocompleteOptions: { hint: false, keyboardShortcuts: ['s'] },
      algoliaOptions: { hitsPerPage: 10 }
    }).autocomplete
    search.on('autocomplete:closed', function () { search.autocomplete.setVal() })
    focusSearchInputToolbar()
    window.addEventListener('load', focusSearchInputToolbar)
  </script>-->
  </body>
</html>
