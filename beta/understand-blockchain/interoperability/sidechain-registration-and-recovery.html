<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Sidechain Registration &amp; Recovery :: Lisk documentation</title>
    <link rel="canonical" href="https://liskhq.github.io/lisk-docs/beta/understand-blockchain/interoperability/sidechain-registration-and-recovery.html">
    <link rel="prev" href="communication.html">
    <link rel="next" href="../blocks-txs.html">
    <meta name="generator" content="Antora 3.1.1">

<link id="theme" rel="stylesheet" title="Default" href="../../../_/css/site.css">
<link rel="stylesheet" title="Dark" href="../../../_/css/dark-site.css">

<script>var uiRootPath = '../../../_'</script>
<script src="../../../_/js/vendor/medium-zoom.js"></script>
<script type="text/javascript" id="Cookiebot" src="https://consent.cookiebot.com/uc.js" data-cbid="e4db29b5-cd94-4bcf-87e4-04f4ca564240" data-blockingmode="manual"></script>
<!-- Matomo -->
<script>
  var _paq = window._paq = window._paq || [];
  /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="https://lisk.matomo.cloud/";
    _paq.push(['setTrackerUrl', u+'matomo.php']);
    _paq.push(['setSiteId', '2']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.async=true; g.src='//cdn.matomo.cloud/lisk.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
<!-- End Matomo Code -->
<!-- Matomo Tag Manager -->
<script>
  var _mtm = window._mtm = window._mtm || [];
  _mtm.push({'mtm.startTime': (new Date().getTime()), 'event': 'mtm.Start'});
  var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
  g.async=true; g.src='https://cdn.matomo.cloud/lisk.matomo.cloud/container_RUW6y8yf.js'; s.parentNode.insertBefore(g,s);
</script>
<!-- End Matomo Tag Manager -->
<link rel="icon" href="../../../_/img/favicon.png" type="image/x-icon">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <div class="top-logo">
        <a href="../../.." class="lisk-logo"></a>
        <a href="../../.." class="docs-logo"></a>
      </div>
      <!--<a class="navbar-item" href="https://liskhq.github.io/lisk-docs">Lisk documentation</a>-->
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">APIs</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="../../../api/lisk-node-rpc.html">Lisk node RPC API</a>
            <a class="navbar-item" href="../../../api/lisk-service-http.html">Lisk Service HTTP
              API</a>
            <a class="navbar-item" href="../../../api/lisk-service-rpc.html">Lisk Service RPC
              API</a>
            <a class="navbar-item" href="../../../api/lisk-service-pubsub.html">Lisk Service
              Pub/Sub API</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Explorers</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://lisk.observer/" target="_blank">Lisk Observer</a>
            <a class="navbar-item" href="https://liskscan.com/" target="_blank">LiskScan</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Products</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="../../../lisk-sdk/">Lisk SDK</a>
            <a class="navbar-item" href="../../../lisk-service/">Lisk Service</a>
            <a class="navbar-item" href="../../../lisk-core/">Lisk Core</a>
            <a class="navbar-item" href="https://lisk.com/wallet" target="_blank">Lisk Wallets</a>
          </div>
        </div>
        <button onclick="switch_style('toggle')" id="theme-toggle" class="theme-toggle navbar-item"></button>
        <!-- <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="#">Download</a>
          </span>
        </div> -->
      </div>
    </div>
  </nav>
</header>
<div class="toolbar" role="navigation">
  <button class="nav-toggle"></button>
  <div class="components-versions">
      <div class="page-components">
    <button class="component-menu-toggle" title="Show other documentations">Lisk Documentation</button>
    <div class="component-menu">
        <a class="component" href="../../../lisk-core/index.html">Lisk Core</a>
        <a class="component" href="../../../lisk-docs-manual/index.html">Lisk docs manual</a>
        <a class="component is-current" href="../../../index.html">Lisk Documentation</a>
        <a class="component" href="../../../lisk-sdk/index.html">Lisk SDK</a>
        <a class="component" href="../../../lisk-service/index.html">Lisk Service</a>
    </div>
  </div>
    <span></span>
    <div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">beta</button>
  <div class="version-menu">
    <a class="version is-missing" href="../../../index.html">default</a>
    <a class="version is-current" href="sidechain-registration-and-recovery.html">beta</a>
  </div>
</div>
  </div>
  <span></span>
  <span></span>
    <a href="../../../index.html" class="home-link"></a>
  <nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../index.html">Lisk Documentation</a></li>
    <li><a href="../index.html">Understand Lisk Blockchain</a></li>
    <li><a href="index.html">Lisk Interoperability</a></li>
    <li><a href="sidechain-registration-and-recovery.html">Sidechain Registration &amp; Recovery</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/LiskHQ/lisk-docs/edit/1497-blockchain-interoperability-page-in-lisk-docs/docs/modules/ROOT/pages/understand-blockchain/interoperability/sidechain-registration-and-recovery.adoc">Edit this Page</a></div>
</div>

<div class="body">
<div class="nav-container" data-component="ROOT" data-version="beta">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../../index.html">Lisk Documentation</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Introduction</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../intro/what-is-blockchain.html">What is blockchain?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../intro/how-blockchain-works.html">How blockchain works</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../intro/blockchain-scalability.html">Blockchain Scalability</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../intro/lisk-products.html">Lisk products</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../intro/blockchain-interoperability.html">Blockchain Interoperability</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../index.html">Understand Lisk Blockchain</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../state-machine.html">State machine</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../consensus/index.html">Consensus protocols</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../consensus/pos-poa.html">Proof of Stake (PoS) &amp; Proof of Authority (PoA) in Lisk</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../network.html">Network</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../mainchain.html">Mainchain</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="index.html">Lisk Interoperability</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="communication.html">Cross-chain communication</a>
  </li>
  <li class="nav-item is-current-page" data-depth="3">
    <a class="nav-link" href="sidechain-registration-and-recovery.html">Sidechain Registration &amp; Recovery</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../blocks-txs.html">Blocks and Transactions</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Lisk SDK</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../sdk/modules-commands.html">Modules and Commands</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../sdk/plugins.html">Plugins</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../sdk/rpc.html">Communicating to a Lisk node via RPC</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../sdk/codec-schema.html">Schemas &amp; Codec</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../build-blockchain/index.html">Build Blockchain</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../build-blockchain/create-blockchain-client.html">Creating a new blockchain client</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../build-blockchain/configuration.html">Blockchain client configuration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../build-blockchain/module/index.html">How to create a module</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../build-blockchain/module/configuration.html">1. How to create a module configuration</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../build-blockchain/module/stores.html">2. How to create stores</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../build-blockchain/module/command.html">3. How to create a command</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../build-blockchain/module/endpoints-methods.html">4. How to create endpoints and methods</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../build-blockchain/module/blockchain-event.html">5. How to create a blockchain event</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../build-blockchain/plugin/index.html">How to create a plugin</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../build-blockchain/plugin/schema-types.html">1. Defining off-chain data structures</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../build-blockchain/plugin/offchain-db.html">2. Setting up an Off-chain database</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../build-blockchain/plugin/configuring-plugin.html">3. Configuring a Plugin</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../build-blockchain/plugin/plugin-class.html">4. Updating the Plugin Class</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../build-blockchain/plugin/plugin-endpoints.html">5. Creating an endpoint &amp; Testing the plugin</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../build-blockchain/using-dashboard.html">Using the Dashboard with a blockchain client</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../build-blockchain/enable-faucet.html">How to enable a Faucet for testing</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../build-blockchain/create-genesis-block.html">How to create a new genesis block</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../build-blockchain/register-sidechain.html">How to register a sidechain</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../build-blockchain/interoperable-module/index.html">How to implement cross-chain communication</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../build-blockchain/interoperable-module/create-ccm.html">How to create a CCM</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../build-blockchain/interoperable-module/execute-ccm.html">How to execute a CCM</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../run-blockchain/index.html">Run Blockchain</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../run-blockchain/process-management.html">Process management with PM2</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../run-blockchain/account-management.html">Managing accounts</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../run-blockchain/become-a-validator.html">How to become a validator</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../run-blockchain/staking.html">How to stake and un-stake tokens</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../run-blockchain/enable-block-generation.html">How to enable/disable block generation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../run-blockchain/reward-sharing.html">How to share block rewards</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../run-blockchain/setup-relayer.html">Setting up a relayer node</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../run-blockchain/blockchain-reset.html">Resetting and snapshotting the blockchain</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../run-blockchain/enabling-misbehavior-report.html">How to enable the "Report Misbehavior" plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../run-blockchain/logging.html">Managing logs</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../integrate-blockchain/index.html">Integrate Blockchain</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../integrate-blockchain/connecting-endpoints.html">Connecting via endpoints</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../integrate-blockchain/subscribing-to-events.html">Retrieving on-chain events</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Transaction creation, signing, and posting</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../integrate-blockchain/create-sign-transactions.html">How to create and sign a transaction</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../integrate-blockchain/create-tx-offline.html">Creating transactions and signing them offline</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../integrate-blockchain/multisignature-accounts-and-transactions.html">How to create multi-signature accounts and transactions</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../integrate-blockchain/create-multiSig-tx-offline.html">Creating and signing a multi-signature transaction (Offline)</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../integrate-blockchain/calculating-min-fee.html">How to calculate the minimum fee for a transaction</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../integrate-blockchain/posting-transactions.html">How to post a transaction</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../integrate-blockchain/encode-decode.html">Decoding &amp; encoding data</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../integrate-blockchain/overwriting-transactions.html">How to overwrite a transaction in the transaction pool</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../integrate-blockchain/integrate-ui/index.html">Integrating a user interface</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../integrate-blockchain/integrate-ui/create-get-account.html">1. Handling accounts</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../integrate-blockchain/integrate-ui/faucet-transfer.html">2. Using faucet and transferring tokens</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../integrate-blockchain/integrate-ui/send-get-hello.html">3. Sending and retrieving hello</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../integrate-blockchain/aggregate-blockchain-data/index.html">Aggregate blockchain data with Lisk Service</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">APIs</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../api/lisk-node-rpc.html">RPC API for Lisk nodes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Module RPC APIs</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../api/module-rpc-api/auth-endpoints.html">Auth module: Endpoint reference</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../api/module-rpc-api/dynamic-reward-endpoints.html">Dynamic Reward module: Endpoint reference</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../api/module-rpc-api/fee-endpoints.html">Fee module: Endpoint reference</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../api/module-rpc-api/interoperability-endpoints.html">Sidechain Interoperability module: Endpoint reference</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../api/module-rpc-api/mainchain-interoperability-endpoints.html">Mainchain Interoperability module: Endpoint reference</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../api/module-rpc-api/token-endpoints.html">Token module: Endpoint reference</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../api/module-rpc-api/validators-endpoints.html">Validators module: Endpoint reference</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../api/module-rpc-api/random-endpoints.html">Random module: Endpoint reference</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../api/module-rpc-api/pos-endpoints.html">Proof of Stake module: Endpoint reference</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Plugin RPC APIs</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../api/plugin-rpc-api/chain-connector-api.html">Chain Connector plugin: Endpoint reference</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Lisk Service APIs</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../api/lisk-service-rpc.html">RPC API of Lisk Service</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../api/lisk-service-http.html">HTTP API (Lisk Service)</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../api/lisk-service-pubsub.html">Publish/Subscribe API (Lisk Service)</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../api/lisk-service-api-migration.html">Lisk Service API v2 vs v3</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Products</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../lisk-sdk/v6/index.html">Lisk SDK</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../lisk-core/v4/index.html">Lisk Core</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../bug-bounty-program.html">Lisk Bug Bounty Program</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Lisk Documentation</span>
    <span class="version">beta</span>
  </div>
  <ul class="components">
    <li class="component">
      <a class="title" href="../../../lisk-core/index.html">Lisk Core</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../lisk-core/index.html">3.1.0 (latest)</a>
        </li>
        <li class="version">
          <a href="../../../lisk-core/v4/index.html">4.0.0 (beta)</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../lisk-docs-manual/index.html">Lisk docs manual</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../lisk-docs-manual/index.html">0.1.0</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <a class="title" href="../../../index.html">Lisk Documentation</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../index.html">default</a>
        </li>
        <li class="version is-current">
          <a href="../../index.html">beta</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../lisk-sdk/index.html">Lisk SDK</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../lisk-sdk/index.html">5.2.2 (latest)</a>
        </li>
        <li class="version">
          <a href="../../../lisk-sdk/v6/index.html">6.0.0 (beta)</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../lisk-service/index.html">Lisk Service</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../lisk-service/index.html">0.6.6 (latest)</a>
        </li>
        <li class="version">
          <a href="../../../lisk-service/0.7/index.html">0.7 (beta)</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
      <h1 class="page">Sidechain Registration &amp; Recovery</h1>
    <div id="preamble">
<div class="sectionbody">
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>On this page, you learn about the sidechain registration and recovery process in the Lisk ecosystem.
Specifically, you&#8217;ll learn about the following:</p>
</div>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-check-square-o"></i> The lifecycle of a sidechain.</p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> The sidechain registration process.</p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> What happens when a sidechain is terminated?</p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> Data recovery from a terminated sidechain.</p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> What data is stored on-chain to facilitate interoperability across chains?</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#life-cycle-of-a-sidechain">Life Cycle of a Sidechain</a></li>
<li><a href="#sidechain-registration">1. Sidechain registration</a>
<ul class="sectlevel2">
<li><a href="#sidechain-registration-on-the-lisk-mainchain">1.1. Sidechain registration on the Lisk Mainchain</a></li>
<li><a href="#mainchain-registration-on-a-sidechain">1.2. Mainchain registration on a sidechain</a></li>
<li><a href="#registration-ccm">1.3. Registration CCM</a></li>
</ul>
</li>
<li><a href="#active-sidechains">2. Active sidechains</a>
<ul class="sectlevel2">
<li><a href="#first-cross-chain-update">2.1. First Cross-chain Update</a></li>
<li><a href="#live-sidechains">2.2. Live sidechains</a></li>
</ul>
</li>
<li><a href="#terminated-sidechains">3. Terminated sidechains</a>
<ul class="sectlevel2">
<li><a href="#termination-causes">3.1. Termination causes</a></li>
<li><a href="#terminate-sidechain-for-liveness-command">3.2. Terminate Sidechain For Liveness command</a></li>
<li><a href="#sidechain-terminated-ccm">3.3. Sidechain Terminated CCM</a></li>
<li><a href="#channel-terminated-ccm">3.4. Channel Terminated CCM</a></li>
<li><a href="#pending-ccms">3.5. Pending CCMs</a></li>
</ul>
</li>
<li><a href="#sidechain-recovery">4. Sidechain recovery</a>
<ul class="sectlevel2">
<li><a href="#recovery-process-from-the-mainchain">4.1. Recovery process from the mainchain</a></li>
<li><a href="#recovery-process-from-a-sidechain">4.2. Recovery process from a sidechain</a></li>
<li><a href="#recovery-as-a-service">4.3. Recovery-as-a-Service</a></li>
<li><a href="#recovery-commands">4.4. Recovery commands</a></li>
<li><a href="#recover-ccm">4.5. Recover CCM</a></li>
<li><a href="#recover-event">4.6. Recover event</a></li>
</ul>
</li>
<li><a href="#interoperability-data-substores">Interoperability data substores</a>
<ul class="sectlevel2">
<li><a href="#outbox-root-substore">Outbox root substore</a></li>
<li><a href="#own-chain-substore">Own chain substore</a></li>
<li><a href="#chain-substore">Chain substore</a></li>
<li><a href="#channel-substore">Channel substore</a></li>
<li><a href="#chain-validators-substore">Chain validators substore</a></li>
<li><a href="#terminated-state-substore">Terminated state substore</a></li>
<li><a href="#terminated-outbox-substore">Terminated outbox substore</a></li>
<li><a href="#registered-names-substore">Registered names substore</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="sect1">
<h2 id="life-cycle-of-a-sidechain"><a class="anchor" href="#life-cycle-of-a-sidechain"></a>Life Cycle of a Sidechain</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A <a href="index.html#mainchain-sidechains" class="xref page">sidechain</a> is always in one of the following three states:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="#sidechain-registration">registered</a>,</p>
</li>
<li>
<p><a href="#active-sidechains">active</a>, or</p>
</li>
<li>
<p><a href="#terminated-sidechains">terminated</a>.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/understand-blockchain/interop/sidechain-lifecycle.png" alt="sidechain lifecycle">
</div>
<div class="title">Figure 1. State diagram of a sidechain account on the Mainchain</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sidechain-registration"><a class="anchor" href="#sidechain-registration"></a>1. Sidechain registration</h2>
<div class="sectionbody">
<div class="paragraph">
<div class="title">Sidechain registration flow chart</div>
<p><span class="image right"><img src="../../_images/understand-blockchain/interop/sidechain-registration.png" alt="sidechain registration" width="300"></span></p>
</div>
<div class="paragraph">
<p>The first step for a Lisk blockchain to become interoperable with other sidechains and the Lisk Mainchain is to register itself to the mainchain.</p>
</div>
<div class="paragraph">
<p>A sidechain is registered by performing the following steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="#sidechain-registration-on-the-lisk-mainchain">Sidechain registration on the Lisk Mainchain</a></p>
</li>
<li>
<p><a href="#mainchain-registration-on-a-sidechain">Mainchain registration on a sidechain</a></p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
After a sidechain has been registered on the mainchain, it does not need to follow the <a href="#liveness-condition">Liveness condition</a>, until the <a href="#first-cross-chain-update">First Cross-chain Update</a> has been included on the mainchain.
A sidechain can stay in the <code>registered</code> status for any period of time.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="sidechain-registration-on-the-lisk-mainchain"><a class="anchor" href="#sidechain-registration-on-the-lisk-mainchain"></a>1.1. Sidechain registration on the Lisk Mainchain</h3>
<div class="paragraph">
<p>A sidechain can be registered by any user account on the mainchain by posting a <a href="#register-sidechain-command">Register Sidechain command</a>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Please check out the guide <a href="../../build-blockchain/register-sidechain.html#how-to-register-a-sidechain-on-the-mainchain" class="xref page">How to register a sidechain on the mainchain</a> for a step-by-step explanation about the process.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When a sidechain is registered on the mainchain, this creates new entries in the interoperability related data stores of the mainchain:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>A new sidechain account in the <a href="#chain-substore">Chain substore</a>.</p>
</li>
<li>
<p>A new channel to the sidechain in the <a href="#channel-substore">Channel substore</a>.</p>
</li>
<li>
<p>The list of keys of active validators on the sidechain in the <a href="#chain-validators-substore">Chain validators substore</a>.</p>
</li>
<li>
<p>An outbox root in the <a href="#outbox-root-substore">Outbox root substore</a></p>
</li>
<li>
<p>A new entry in the <a href="#registered-names-substore">Registered names substore</a> for the sidechain.</p>
</li>
</ol>
</div>
<div class="sect3">
<h4 id="register-sidechain-command"><a class="anchor" href="#register-sidechain-command"></a>1.1.1. Register Sidechain command</h4>
<div class="paragraph">
<p>The <a href="https://liskhq.github.io/lisk-docs/lisk-sdk/v6/references/typedoc/classes/lisk_framework.RegisterSidechainCommand.html" target="_blank" rel="noopener">Register Sidechain</a> command is used to register a sidechain on the Lisk mainchain.
When this command is processed, a new account for the sidechain is created in the mainchain state under the interoperability store.
The account is initialized with an empty inbox and outbox, while the sidechain name and the initial validators set are given in the command parameters.
The chain ID, used as the store key, is also given in the command parameters.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="mainchain-registration-on-a-sidechain"><a class="anchor" href="#mainchain-registration-on-a-sidechain"></a>1.2. Mainchain registration on a sidechain</h3>
<div class="paragraph">
<p>Once the sidechain has been registered on the mainchain, a similar registration process should happen in the sidechain before the interoperable channel is opened between the two chains.
To register the mainchain on a sidechain, any user can post a <a href="#register-mainchain-command">Register Mainchain command</a>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Please check out the guide: <a href="../../build-blockchain/register-sidechain.html#how-to-register-the-mainchain-on-the-sidechain" class="xref page">How to register the mainchain on the sidechain</a> for a step-by-step explanation of the process.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When the mainchain is registered on a sidechain, this creates new entries in the interoperability related data stores of the sidechain.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>A mainchain account in the <a href="#chain-substore">Chain substore</a>.</p>
</li>
<li>
<p>A new channel to the mainchain in the <a href="#channel-substore">Channel substore</a>.</p>
</li>
<li>
<p>The list of keys of active validators on the mainchain in the <a href="#chain-validators-substore">Chain validators substore</a>.</p>
</li>
<li>
<p>An outbox root in the <a href="#outbox-root-substore">Outbox root substore</a></p>
</li>
<li>
<p>It also initializes the <a href="#own-chain-substore">Own chain substore</a> on the sidechain.</p>
</li>
</ol>
</div>
<div class="sect3">
<h4 id="register-mainchain-command"><a class="anchor" href="#register-mainchain-command"></a>1.2.1. Register Mainchain command</h4>
<div class="paragraph">
<p>The <a href="https://liskhq.github.io/lisk-docs/lisk-sdk/v6/references/typedoc/classes/lisk_framework.RegisterMainchainCommand.html" target="_blank" rel="noopener">Register Mainchain</a> command is used to register the Lisk mainchain on a sidechain.
When this command is processed, a new account for the mainchain is created in the sidechain state under the Interoperability store.
The account is initialized with an empty inbox and outbox, while the initial validators set is given in the command parameters.
The name and chain ID of the mainchain are global protocol constants in the entire ecosystem.</p>
</div>
<div class="paragraph">
<p>This command also initializes another data structure in the interoperability store, containing some information about the sidechain itself.
In particular, it sets the sidechain name and chain ID to the ones that have been previously registered on the mainchain via the <a href="#register-sidechain-command">Register Sidechain command</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="registration-ccm"><a class="anchor" href="#registration-ccm"></a>1.3. Registration CCM</h3>
<div class="paragraph">
<p>Every time that a sidechain is registered on the mainchain and vice versa, a corresponding "registration" CCM is created and appended to the chain outbox.
The role of the registration cross-chain message is to allow for a safe activation of the channel between the sending and receiving chains.
It guarantees that when the CCU activating the channel is executed, a registration transaction has been included on the partner chain as well.</p>
</div>
<div class="paragraph">
<p>When a sidechain is registered on the mainchain, an ecosystem-wide chain ID and name are assigned to this chain.
The chain name, network ID, and the token used for the message fees are included in a registration message.
When the first cross-chain update containing messages is sent to the sidechain, the parity of the properties in both the registration message and the interoperability store are verified.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="active-sidechains"><a class="anchor" href="#active-sidechains"></a>2. Active sidechains</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If the mainchain receives the <a href="#first-cross-chain-update">First Cross-chain Update</a> from a sidechain, the status of the sidechain changes from <code>registered</code> to <code>active</code>.</p>
</div>
<div class="paragraph">
<p>This change means, that the receiving chain is now available to receive cross-chain messages and can interact with the sending chain.</p>
</div>
<div class="paragraph">
<p>At this point, the status of the sidechain account on the mainchain is updated to <code>active</code> and the <a href="#liveness-condition">Liveness condition</a> is then enforced.
The liveness condition requires active sidechains to prove their liveness once every 30 days by including a CCU in the mainchain, or the sidechain account is terminated.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<strong>The liveness condition only needs to be fulfilled on the mainchain.</strong>
That means, the mainchain account on the sidechain is not terminated, if the mainchain doesn&#8217;t send a CCU to the sidechain within 30 days.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="first-cross-chain-update"><a class="anchor" href="#first-cross-chain-update"></a>2.1. First Cross-chain Update</h3>
<div class="paragraph">
<p>The first cross-chain update containing messages from a given chain has a special function:
It will change the sending chain status in the chain account from <code>registered</code> to <code>active</code>.</p>
</div>
<div class="paragraph">
<p>There are some things to consider when sending the first CCU:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>It must not contain an empty certificate with no data.</p>
</li>
<li>
<p>The certificate is only valid if it allows the sidechain account to remain <a href="#live-sidechains">live</a> for at least 15 days.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>When a sidechain is started and registered, the sidechain developers might decide to not activate the sidechain straight away (maybe to perform further testing).
It could occur (intentionally or not), that an old block header (almost 30 days old) is submitted to the mainchain to activate the sidechain.
This could result in the sidechain being terminated for liveness failure very soon after the activation (maybe only a few minutes later).</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p>To prevent this issue (and without any significant drawbacks) <strong>the first cross-chain update to be submitted on the mainchain must contain a certificate less than 15 days old.</strong></p>
</div>
</div>
</div>
<div class="paragraph">
<p>The sidechain has therefore at least 15 days to submit the next cross-chain update to the mainchain and start the regular posting of cross-chain updates.</p>
</div>
</div>
<div class="sect2">
<h3 id="live-sidechains"><a class="anchor" href="#live-sidechains"></a>2.2. Live sidechains</h3>
<div class="paragraph">
<p>A sidechain is  considered to be <code>live</code> if the following applies:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>On the mainchain: a chain is live if a chain account exists, is not terminated, and the last certificate was submitted less than 30 days ago.</p>
</li>
<li>
<p>On the sidechain: a chain is live if no "terminated state" account exists, and no chain account with the status <code>terminated</code> exists.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="terminated-sidechains"><a class="anchor" href="#terminated-sidechains"></a>3. Terminated sidechains</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When a sidechain is terminated, no cross-chain messages can be exchanged with it anymore.</p>
</div>
<div class="paragraph">
<p>Effectively, the sidechain is disconnected from the rest of the ecosystem, and assets (like tokens) cannot be moved to and from it anymore.
In particular, this means that users can not send the assets they were holding on the sidechain back to the original native chain (the chain where the asset was created).
The <a href="#sidechain-recovery">Sidechain recovery</a> mechanism addresses this problem.</p>
</div>
<div class="paragraph">
<p>An active sidechain is terminated, if it fulfills any of the <a href="#termination-causes">Termination causes</a> described below.
When a chain is terminated, a "terminated state" account is created in the <a href="#terminated-state-substore">Terminated state substore</a>, storing the last certified state root of the terminated chain.</p>
</div>
<div class="paragraph">
<p>Any cross-chain messages targeting a terminated chain will be bounced back to the mainchain instead of being forwarded.
When this happens, a <a href="#sidechain-terminated-ccm">Sidechain Terminated CCM</a> is emitted by the mainchain, targeting the original sending chain.
When this message is processed, the chain is also terminated on the sending chain, blocking future messages to the terminated sidechain.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
<div class="paragraph">
<p><strong>The termination of a sidechain is permanent</strong> and cannot be undone.</p>
</div>
<div class="paragraph">
<p>However, users can recover their tokens and CCMs from a terminated sidechain.
For more details on this topic, read <a href="#sidechain-recovery">Sidechain recovery</a> covered later on this page.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="termination-causes"><a class="anchor" href="#termination-causes"></a>3.1. Termination causes</h3>
<div class="paragraph">
<p>A sidechain is terminated for the following reasons:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The sidechain breaks the <a href="#liveness-condition">Liveness condition</a>.</p>
</li>
<li>
<p>The sidechain is <a href="#sending-malicious-ccms">Sending malicious CCMs</a>.</p>
</li>
<li>
<p>The sidechain is <a href="#violating-the-lisk-interoperability-protocol">Violating the Lisk Interoperability protocol</a>.</p>
</li>
</ol>
</div>
<div class="sect3">
<h4 id="liveness-condition"><a class="anchor" href="#liveness-condition"></a>3.1.1. Liveness condition</h4>
<div class="paragraph">
<p>The liveness condition is defined as follows:</p>
</div>
<div class="paragraph">
<p>Active sidechains are required to prove their liveness to the mainchain at least once every 30 days.
This is done by including a CCU on the mainchain.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<strong>The liveness condition only needs to be fulfilled on the mainchain.</strong>
That means, the mainchain account on the sidechain is not terminated, if the mainchain doesn&#8217;t send a CCU to the sidechain within 30 days.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Whenever a sidechain has violated the liveness condition, any user can submit a <a href="#terminate-sidechain-for-liveness-command">Terminate Sidechain For Liveness command</a> on the mainchain, and this will result in the sidechain being terminated.
This rule guarantees that users do not send funds to inactive sidechains and that users who have tokens in a sidechain that stops communicating with the ecosystem can recover their tokens.</p>
</div>
</div>
<div class="sect3">
<h4 id="sending-malicious-ccms"><a class="anchor" href="#sending-malicious-ccms"></a>3.1.2. Sending malicious CCMs</h4>
<div class="paragraph">
<p>A sidechain is terminated, if it posts a CCU containing one or multiple malicious <a href="communication.html#inducing-state-changes-across-chains-with-ccms" class="xref page">CCMs</a>.
Certain <a href="../sdk/modules-commands.html" class="xref page">modules</a> of a blockchain client have the ability to terminate a sidechain account.
If a module receives a CCM that it considers to be malicious, it can call the <a href="https://github.com/LiskHQ/lips/blob/main/proposals/lip-0045.md#terminatechain" target="_blank" rel="noopener"><code>terminateChain</code></a> method of the Interoperability module to terminate the sidechain.</p>
</div>
<div class="paragraph">
<p>For example, the Token module on the mainchain can terminate a sidechain if it violates escrow, i.e. sends more LSK tokens to the mainchain that were sent to this sidechain.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Notice that a sidechain terminated for this reason is not always terminated in the whole ecosystem.</p>
</div>
<div class="paragraph">
<p>Imagine that a sidechain A violates escrow on a chain B (by essentially trying to mint native tokens from B), then B will terminate communicating with A.</p>
</div>
<div class="paragraph">
<p>If chain B is the mainchain, then this chain is always terminated in the whole ecosystem.
That means neither the mainchain nor any other sidechains can communicate with chain B anymore.</p>
</div>
<div class="paragraph">
<p>However, if a sidechain A terminates another sidechain B, this has no direct effect on the connection to the other chains
- the mainchain and other sidechains could still be communicating to sidechain B in this case.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="violating-the-lisk-interoperability-protocol"><a class="anchor" href="#violating-the-lisk-interoperability-protocol"></a>3.1.3. Violating the Lisk Interoperability protocol</h4>
<div class="paragraph">
<p>It is also possible for a sidechain to be terminated, if it violates the Lisk Interoperability protocol.
Note, that if a sidechain uses the Lisk Interoperability module, it never violates the protocol.</p>
</div>
<div class="paragraph">
<p>But in case another custom module is used for interoperability in a sidechain, and for example, it sends CCUs that don&#8217;t follow the expected format, this can also lead to the termination of the sidechain.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="terminate-sidechain-for-liveness-command"><a class="anchor" href="#terminate-sidechain-for-liveness-command"></a>3.2. Terminate Sidechain For Liveness command</h3>
<div class="paragraph">
<p>The <a href="https://liskhq.github.io/lisk-docs/lisk-sdk/v6/references/typedoc/classes/lisk_framework.TerminateSidechainForLivenessCommand.html" target="_blank" rel="noopener">Terminate Sidechain For Liveness</a> command is used to terminate a sidechain that violated the liveness condition.
The timestamp of the last certificate provided by the sidechain is checked against the current timestamp.
If the difference is greater than the maximum allowed timespan, the sidechain is terminated.</p>
</div>
<div class="paragraph">
<p>This command can only be submitted on the mainchain.</p>
</div>
</div>
<div class="sect2">
<h3 id="sidechain-terminated-ccm"><a class="anchor" href="#sidechain-terminated-ccm"></a>3.3. Sidechain Terminated CCM</h3>
<div class="paragraph">
<p>A "sidechain terminated" message is created by the Interoperability module when a message should be routed to a terminated or inactive chain.</p>
</div>
<div class="paragraph">
<p>The role of the sidechain terminated cross-chain message is to inform sidechains that another sidechain has been terminated on the mainchain and is unable to receive messages.
The message contains the ID of the terminated chain as well as the last certified state root of the terminated sidechain (as certified on the mainchain).
This value is used for the creation of the terminated state account (on the sidechain receiving the CCM), allowing state recoveries.</p>
</div>
<div class="paragraph">
<p>This message allows informing sidechains about other terminated sidechains efficiently.
Hence, this message will automatically trigger the creation of the terminated sidechain account as soon as the first message is unable to be delivered.
This also prevents further messages being sent to already terminated sidechains.</p>
</div>
</div>
<div class="sect2">
<h3 id="channel-terminated-ccm"><a class="anchor" href="#channel-terminated-ccm"></a>3.4. Channel Terminated CCM</h3>
<div class="paragraph">
<p>A "channel terminated" CCM is sent to chains which have been terminated.</p>
</div>
<div class="paragraph">
<p>The role of the "channel terminated" message is to inform chains that their channel has been terminated on the mainchain.
The chain receiving this message can then also close the channel to the mainchain.
This is helpful in preventing users from sending transactions to a chain since the cross-chain update transaction will be invalid.</p>
</div>
</div>
<div class="sect2">
<h3 id="pending-ccms"><a class="anchor" href="#pending-ccms"></a>3.5. Pending CCMs</h3>
<div class="paragraph">
<p>If a sidechain is terminated, it can happen that some CCMs have been sent to the sidechain before the sending chain was aware that the sidechain is terminated.
Hence, this includes all the CCMs whose indices are larger than the last message index that the receiving sidechain reported to have included in its inbox on the mainchain.</p>
</div>
<div class="paragraph">
<p>Those CCMs that cannot be transmitted to the terminated chain anymore, and remain in the outbox on the mainchain are also called <strong>pending CCMs</strong>.</p>
</div>
<div class="paragraph">
<p>Pending CCMs can easily be recovered, please see <a href="#ccm-recovery">CCM recovery</a> for more information.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sidechain-recovery"><a class="anchor" href="#sidechain-recovery"></a>4. Sidechain recovery</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The sidechain recovery process allows users to recover assets like tokens or NFTs from a terminated sidechain.
Additionally, pending messages that were stuck unprocessed in the outbox of the terminated chain can be recovered as well, and their effect is reverted on the sending chain.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
No connection or communication to the terminated sidechain is required to complete the recovery.
</td>
</tr>
</table>
</div>
<div class="videoblock text-center">
<div class="title">Recovering tokens and NFTs from terminated sidechains</div>
<div class="content">
<iframe width="100%" height="400" src="https://www.youtube.com/embed/iBVfttn_n-U?rel=0" frameborder="0" allowfullscreen></iframe>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For the sidechain recovery process, it is not important who is sending the recovery transactions:
The recovery process happens independently of the sender, and tokens and assets will always be recovered for the correct accounts.</p>
</div>
<div class="paragraph">
<p>This makes it possible to provide <a href="#recovery-as-a-service">Recovery-as-a-Service</a> to users, to further simplify the recovery process.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="recovery-process-from-the-mainchain"><a class="anchor" href="#recovery-process-from-the-mainchain"></a>4.1. Recovery process from the mainchain</h3>
<div class="paragraph">
<p>On the mainchain, users can perform the following recoveries:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="#state-recovery">State recovery</a></p>
</li>
<li>
<p><a href="#ccm-recovery">CCM recovery</a></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The recovery process on the mainchain works as follows:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="../../_images/understand-blockchain/interop/recovery_mainchain.png" alt="recovery mainchain" width="550">
</div>
<div class="title">Figure 2. Recovery process from the mainchain.</div>
</div>
<div id="state-recovery" class="dlist">
<dl>
<dt class="hdlist1">1.State recovery</dt>
<dd>
<p>In case any tokens or other assets are stored on another sidechain and this sidechain gets terminated, the assets can to be recovered from the terminated sidechain.</p>
<div class="paragraph">
<p>1.The sidechain is terminated by submitting a <a href="#terminate-sidechain-for-liveness-command">Terminate Sidechain For Liveness command</a>, or violating the Token module protocol.</p>
</div>
<div class="paragraph">
<p>1a. A "terminated state" account containing the last certified state root of the sidechain is created in the state.</p>
</div>
<div class="paragraph">
<p>1b. A user can start recovering assets with a <a href="#recover-state">Recover State</a> command.</p>
</div>
<div class="paragraph">
<p>The funds are then credited to the user&#8217;s account on the mainchain.
Finally, the state root of the terminated sidechain is then updated accordingly.</p>
</div>
</dd>
</dl>
</div>
<div id="ccm-recovery" class="dlist">
<dl>
<dt class="hdlist1">2.CCM recovery</dt>
<dd>
<p>It is possible to recover any <a href="#pending-ccms">Pending CCMs</a> that may have been unprocessed in the outbox of the terminated chain.
Subsequently, their effect can be reverted on the sending chain.</p>
<div class="paragraph">
<p>However, it is important to note that users are not guaranteed to recover their CCMs in every situation.
Certain state information of the terminated sidechain might have been modified before the termination occurred, and this would make the recovered CCM application fail.
For example, in the case whereby escrowed LSK tokens exist in the sidechain account on the mainchain, which could have been subtracted by prior malicious behavior in the terminated sidechain.</p>
</div>
<div class="paragraph">
<p>2.The <a href="#initialize-message-recovery">Initialize Message Recovery</a> command is then sent.
This command contains the inbox size of the mainchain stored on the terminated sidechain, which indicates how many cross-chain messages were processed.</p>
</div>
<div class="paragraph">
<p>2a. A "terminated outbox" account is created in the <a href="#terminated-outbox-substore">Terminated outbox substore</a>.
This contains the outbox root of the terminated sidechain channel, and the inbox size provided with the <a href="#initialize-message-recovery">Initialize Message Recovery</a> command.</p>
</div>
<div class="paragraph">
<p>2b. A user can now recover pending messages with a <a href="#recover-message">Recover Message</a> command.</p>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="recovery-process-from-a-sidechain"><a class="anchor" href="#recovery-process-from-a-sidechain"></a>4.2. Recovery process from a sidechain</h3>
<div class="paragraph">
<p>On a sidechain, users can perform the following recoveries:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>State recovery</strong>:
In case any tokens or other assets are stored on another sidechain and this sidechain gets terminated, the assets can be recovered from the terminated sidechain.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Recoverable modules</div>
<div class="paragraph">
<p>State changes can only be recovered on a sidechain, if the module targeted by the CCM supports the recovery.
Recoverable modules expose a <code>recover</code> method if the recovery is supported, for example, such as the Token module, and the NFT module.</p>
</div>
<div class="paragraph">
<p>For custom modules, it is therefore recommended to always implement a <code>recover</code> method into a module, if the module supports cross-chain transactions.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>On a sidechain, the process flow can occur in the following 3 scenarios described below:</p>
</div>
<div class="sect3">
<h4 id="scenario-1-violation-of-a-module-protocol"><a class="anchor" href="#scenario-1-violation-of-a-module-protocol"></a>4.2.1. Scenario 1: Violation of a module protocol</h4>
<div class="paragraph">
<p>If a sidechain is <a href="#sending-malicious-ccms">Sending malicious CCMs</a> which are breaking the protocol of the corresponding module on the receiving chain, the chain will recognize this during the validation of the CCM.
The receiving chain will then terminate the account of the sending chain.</p>
</div>
<div class="paragraph">
<p>The recovery process for scenario 1 works as follows:</p>
</div>
<div class="paragraph">
<p><span class="image right"><img src="../../_images/understand-blockchain/interop/recovery_sidechain_1.png" alt="recovery sidechain 1" width="360"></span></p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>A "terminated state" account containing the mainchain&#8217;s last certified state root is created in the sidechain state.</p>
</li>
<li>
<p>An <a href="#initialize-state-recovery">Initialize State Recovery</a> command is sent.
This command contains the last certified state root (on the mainchain), of the terminated sidechain and an inclusion proof against the mainchain state root stored in the "terminated state" account.</p>
</li>
<li>
<p>A user is able to recover assets native to the sidechain with a <a href="#recover-state">Recover State</a> command.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="scenario-2-receiving-a-sidechain-terminated-ccm"><a class="anchor" href="#scenario-2-receiving-a-sidechain-terminated-ccm"></a>4.2.2. Scenario 2: Receiving a "sidechain terminated" CCM</h4>
<div class="paragraph">
<p>Sometimes it can happen that a sidechain is terminated on the mainchain, and yet it is still active on other sidechains.
That is because the mainchain does not inform other sidechains immediately about a termination.
If a sidechain then tries to send a CCU to a sidechain that is already terminated on the mainchain, the CCU will be rejected by the mainchain, and it will respond with a <a href="#sidechain-terminated-ccm">Sidechain Terminated CCM</a>.</p>
</div>
<div class="paragraph">
<p>A sidechain receives a <a href="#sidechain-terminated-ccm">Sidechain Terminated CCM</a> from the mainchain, indicating that a cross-chain message could not be delivered because the receiving chain was terminated.
This CCM contains the last certified state root (on the mainchain), of the terminated sidechain.
The receiving chain will then terminate the account of the corresponding sidechain.</p>
</div>
<div class="paragraph">
<p>The recovery process for scenario 2 works as follows:</p>
</div>
<div class="imageblock right">
<div class="content">
<img src="../../_images/understand-blockchain/interop/recovery_sidechain_3.png" alt="recovery sidechain 3" width="360">
</div>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>A "terminated state" account containing the sidechains last certified state root is created in the state.
However, it is important to note that in this case, the terminated sidechain state root is set immediately, and there is no need for an <a href="#initialize-state-recovery">Initialize State Recovery</a> command.</p>
</li>
<li>
<p>A user can recover assets native to the sidechain with a <a href="#recover-state">Recover State</a> command.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="scenario-3-termination-on-the-mainchain"><a class="anchor" href="#scenario-3-termination-on-the-mainchain"></a>4.2.3. Scenario 3: Termination on the mainchain</h4>
<div class="paragraph">
<p>In case it is already known that a sidechain is terminated by the users, they can avoid <a href="#scenario-2-receiving-a-sidechain-terminated-ccm">scenario 2</a>, where a CCU is rejected, and directly initialize the state recovery.</p>
</div>
<div class="paragraph">
<p>The recovery process for scenario 3 works as follows:</p>
</div>
<div class="imageblock right">
<div class="content">
<img src="../../_images/understand-blockchain/interop/recovery_sidechain_2.png" alt="recovery sidechain 2" width="360">
</div>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>An <a href="#initialize-state-recovery">Initialize State Recovery</a> command is sent.
This command contains the last certified state root (on the mainchain), of the terminated sidechain and an inclusion proof against the last certified mainchain state root, proving the termination.</p>
</li>
<li>
<p>A "terminated state" account containing the sidechains last certified state root is created in the state.</p>
</li>
<li>
<p>A user can recover assets that are native to the sidechain with a <a href="#recover-state">Recover State</a> command.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="recovery-as-a-service"><a class="anchor" href="#recovery-as-a-service"></a>4.3. Recovery-as-a-Service</h3>
<div class="paragraph">
<p>To perform a recovery of assets from a terminated sidechain, specific information is required to prepare a recovery transaction, see <a href="#recovery-commands">Recovery commands</a>.
Furthermore, this information has to be kept updated every time a recovery command is processed.</p>
</div>
<div class="paragraph">
<p>Third-party services could offer to recover assets and messages on behalf of users.
Recovery services would run a mainchain and sidechain node to provide the data availability, possibly in exchange for a small fee.</p>
</div>
</div>
<div class="sect2">
<h3 id="recovery-commands"><a class="anchor" href="#recovery-commands"></a>4.4. Recovery commands</h3>
<div class="sect3">
<h4 id="initialize-state-recovery"><a class="anchor" href="#initialize-state-recovery"></a>4.4.1. Initialize State Recovery</h4>
<div class="paragraph">
<p>The <a href="https://liskhq.github.io/lisk-docs/lisk-sdk/v6/references/typedoc/classes/lisk_framework.InitializeStateRecoveryCommand.html" target="_blank" rel="noopener">Initialize State Recovery</a> command sets the sidechain state root in the "terminated state" account, so that state recovery commands can be issued.</p>
</div>
<div class="paragraph">
<p>A sidechain account can be terminated on a sidechain using the <code>terminateChain</code> function exposed by the Interoperability module.
In this case, the state root is generally not available and the terminated state account is created without setting the sidechain state root.
Instead, the account stores the mainchain state root at the time of termination.</p>
</div>
<div class="paragraph">
<p>A state recovery initialization command can be posted afterwards to set the sidechain state root by giving an inclusion proof against this mainchain state root.
It contains an inclusion proof against the mainchain state root stored in the terminated state account, proving the value of the state root of the terminated sidechain.
Any user on the corresponding sidechain can send a transaction with this command and initiate the state recoveries with respect to the terminated sidechain.
Further information including the <code>createTerminatedStateAccount</code> function can be found in <a href="https://github.com/LiskHQ/lips/blob/main/proposals/lip-0045.md" target="_blank" rel="noopener">LIP 0045</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <a href="https://liskhq.github.io/lisk-docs/lisk-sdk/v6/references/typedoc/classes/lisk_framework.InitializeStateRecoveryCommand.html" target="_blank" rel="noopener">Initialize State Recovery</a>  command can only be submitted on a sidechain.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This command has two purposes.
It can be used to perform the following:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>&#8230;&#8203;set the state root of a "terminated state" account on a sidechain, or</p>
</li>
<li>
<p>&#8230;&#8203;to terminate another sidechain directly.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="recover-state"><a class="anchor" href="#recover-state"></a>4.4.2. Recover State</h4>
<div class="paragraph">
<p>The <a href="https://liskhq.github.io/lisk-docs/lisk-sdk/v6/references/typedoc/classes/lisk_framework.RecoverStateCommand.html" target="_blank" rel="noopener">Recover State</a> command is used to recover assets (for example, fungible and non-fungible tokens) from a terminated sidechain.</p>
</div>
<div class="paragraph">
<p>This command contains an inclusion proof, proving the user balance on the sidechain against the state root stored in the <a href="#terminated-state-substore">terminated state</a> account.</p>
</div>
<div class="paragraph">
<p>The recovery of the state is then handled by the relevant module (for example, the token module would refund the user), and the state root is updated.</p>
</div>
<div class="paragraph">
<p>The following information is required to recover assets from a terminated chain:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Access to the specific asset to recover from the sidechain.</p>
</li>
<li>
<p>The entire state tree authenticated by the last certified state root to be able to provide the inclusion proof.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="initialize-message-recovery"><a class="anchor" href="#initialize-message-recovery"></a>4.4.3. Initialize Message Recovery</h4>
<div class="paragraph">
<p>Once a <a href="#terminated-state-substore">terminated state</a> account has been created on the mainchain, users can send this command to initialize the corresponding terminated outbox account in the <a href="#terminated-outbox-substore">Terminated outbox substore</a>.
This command contains the channel account of the mainchain stored in the state of the terminated sidechain, and an inclusion proof for it against the state root stored in the corresponding terminated state account.</p>
</div>
<div class="paragraph">
<p>The following information is required to initialize message recovery on the mainchain:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>chainID</code>: The ID of the sidechain whose terminated outbox account is to be initialized.</p>
</li>
<li>
<p><code>channel</code>: The channel of this chain stored on the terminated sidechain.</p>
</li>
<li>
<p><code>bitmap</code>: The bitmap of the inclusion proof of the channel in the sidechain state tree.</p>
</li>
<li>
<p><code>siblingHashes</code>: The sibling hashes of the inclusion proof of the channel in the sidechain state tree.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="recover-message"><a class="anchor" href="#recover-message"></a>4.4.4. Recover Message</h4>
<div class="paragraph">
<p>The <a href="https://liskhq.github.io/lisk-docs/lisk-sdk/v6/references/typedoc/classes/lisk_framework.RecoverMessageCommand.html" target="_blank" rel="noopener">Recover Message</a> command is used to recover any <a href="#pending-ccms">Pending CCMs</a> from the outbox of a terminated sidechain.</p>
</div>
<div class="paragraph">
<p>The user proves with an inclusion proof validated against the outbox root stored in the terminated outbox account that the message is in the terminated sidechain outbox.
The message nonce is compared to the size of the inbox (also stored in the terminated outbox account), to check that the message had not been processed yet.</p>
</div>
<div class="paragraph">
<p>The <a href="#recover-ccm">Recover CCM</a> is then bounced back to the original sending chain or processed directly if the sending chain is the mainchain.
When the recovery process is completed, a corresponding <a href="#recover-event">Recover event</a> is emitted.</p>
</div>
<div class="paragraph">
<p>The following information is required to recover pending CCMs:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Access to the cross-chain messages in the sidechain outbox.</p>
</li>
<li>
<p>The entire tree of the sidechain outbox to be able to provide the inclusion proof.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="recover-ccm"><a class="anchor" href="#recover-ccm"></a>4.5. Recover CCM</h3>
<div class="paragraph">
<p>The Recover CCM is sent from the mainchain to the sending chain to facilitate the <a href="#ccm-recovery">CCM recovery</a> on a sidechain.</p>
</div>
<div class="paragraph">
<p>The module responsible for recovering the dedicated assets (e.g. the Token module) will then emit a <a href="#recover-event">Recover event</a> to inform the network about the performed recovery.</p>
</div>
</div>
<div class="sect2">
<h3 id="recover-event"><a class="anchor" href="#recover-event"></a>4.6. Recover event</h3>
<div class="paragraph">
<p>The <a href="https://github.com/LiskHQ/lips/blob/main/proposals/lip-0051.md#recover-1" target="_blank" rel="noopener">Recover event</a> is emitted by when a <a href="#ccm-recovery">CCM recovery</a> is performed.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="interoperability-data-substores"><a class="anchor" href="#interoperability-data-substores"></a>Interoperability data substores</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Each sidechain stores data related to cross-chain interoperability in the <a href="../state-machine.html#data-stores" class="xref page">Interoperability data store</a>, maintained by the <a href="https://liskhq.github.io/lisk-docs/lisk-sdk/v6/references/typedoc/classes/lisk_framework.SidechainInteroperabilityModule.html" target="_blank" rel="noopener">Interoperability module</a>.</p>
</div>
<div class="paragraph">
<p>The interoperability store consists of several substores, as shown in the diagram below.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/understand-blockchain/interop/interop-store.png" alt="interop store" width="500">
</div>
<div class="title">Figure 3. The Interoperability module store</div>
</div>
<div class="paragraph">
<p>Each box in the above diagram represents a substore, where the <code>storeKey</code> -&#8594; <code>storeValue</code> relation is indicated.</p>
</div>
<div class="paragraph">
<p>Each substore and the data in it are described in detail below.</p>
</div>
<div class="sect2">
<h3 id="outbox-root-substore"><a class="anchor" href="#outbox-root-substore"></a>Outbox root substore</h3>
<div class="paragraph">
<p>The "outbox root" substore holds the root of the Merkle tree containing the messages targeting the respective partner chain for every registered sidechain.</p>
</div>
<div class="paragraph">
<p>It is initialized on the respective chain as part of the <a href="#sidechain-registration">Sidechain registration</a> process.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The outbox root property is duplicated and additionally stored separately from all other properties of the chain account.
Storing the outbox root with a different substore prefix allows to separate the subtree corresponding to the outbox roots from the rest of the data in the interoperability store.
This choice allows for shorter inclusion proofs for the outbox root, as the other properties of the Interoperability module are not required to recalculate the state root if the outbox root is known.
In particular, the inclusion proof contained in a CCU from a sidechain posted on the mainchain will contain only one hash.</p>
</div>
</td>
</tr>
</table>
</div>
<details>
<summary class="title">Details</summary>
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Key</dt>
<dd>
<p>Each store key is set to the ID of the partner chain <code>chainID</code>.</p>
</dd>
<dt class="hdlist1">Value</dt>
<dd>
<p>Each entry in the "outbox root" substore includes the following property:</p>
<div class="ulist">
<ul>
<li>
<p><code>root</code>: The root of the underlying Merkle tree of the partner chain outbox.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</details>
</div>
<div class="sect2">
<h3 id="own-chain-substore"><a class="anchor" href="#own-chain-substore"></a>Own chain substore</h3>
<div class="paragraph">
<p>The "own chain" substore stores the name and ID of the respective chain.</p>
</div>
<div class="paragraph">
<p>On the mainchain in the Lisk <strong>Mainnet</strong>, the own chain account is present by default and set to an object with the following properties:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-js hljs" data-lang="js">{
    name: "lisk_mainchain",
    chainID: 00000000,
    nonce: 0
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>On a <strong>sidechain</strong>, the own chain account is initialized as part of the <a href="#mainchain-registration-on-a-sidechain">Mainchain registration on a sidechain</a>.</p>
</div>
<details>
<summary class="title">Details</summary>
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Key</dt>
<dd>
<p>The store key is set to an empty string <code>""</code>.</p>
</dd>
<dt class="hdlist1">Value</dt>
<dd>
<p>The "own chain" substore consists of the following properties:</p>
<div class="ulist">
<ul>
<li>
<p><code>name</code>: The name of the sidechain registered on the mainchain with the <a href="#register-sidechain-command">Register Sidechain command</a>.</p>
</li>
<li>
<p><code>chainID</code>: The <a href="index.html#chain-identifiers" class="xref page">chain ID</a> assigned to the sidechain on the mainchain after processing the sidechain registration command.</p>
</li>
<li>
<p><code>nonce</code>: The chain nonce, an incremental integer indicating the total number of CCMs sent from the chain.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</details>
</div>
<div class="sect2">
<h3 id="chain-substore"><a class="anchor" href="#chain-substore"></a>Chain substore</h3>
<div class="paragraph">
<p>The chain substore holds the chain accounts of other partner chains.</p>
</div>
<div class="paragraph">
<p>It is initialized on the respective chain as part of the <a href="#sidechain-registration">Sidechain registration</a> process.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>On the mainchain, the store contains accounts of all registered sidechains.</p>
</li>
<li>
<p>On a sidechain, the store contains a mainchain account.</p>
</li>
</ul>
</div>
<details>
<summary class="title">Details</summary>
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Key</dt>
<dd>
<p>Each store key is set to the ID of the partner chain&#8217;s <code>chainID</code>.</p>
</dd>
<dt class="hdlist1">Value</dt>
<dd>
<p>Each entry in the chain account substore includes the following properties:</p>
<div class="ulist">
<ul>
<li>
<p><code>name</code>: This property corresponds to the name of the sidechain as a string of characters.
It has to be unique in the ecosystem and contain only characters from the set <code>[a-z0-9!@$&amp;_.]</code>.
For the mainchain account on a sidechain, this property is initialized to the string <code>"lisk_mainchain"</code>.
For a sidechain account on the mainchain, this property is set by the sender of the <a href="#register-sidechain-command">Register Sidechain command</a>.</p>
</li>
<li>
<p><code>lastCertificate</code>: This property holds some information from the certificate posted contained in the last CCU from the partner chain.
It is an object containing the following properties:</p>
<div class="ulist">
<ul>
<li>
<p><code>height</code>: The height contained in the last certificate from the partner chain.
It is used to validate a certificate<sup class="footnote" id="_footnote_command">[<a id="_footnoteref_1" class="footnote" href="#_footnotedef_1" title="View footnote.">1</a>]</sup> (certificates must contain block headers with increasing heights).</p>
</li>
<li>
<p><code>timestamp</code>: The timestamp contained in the last certificate from the partner chain.
On the mainchain, it is used to check that the sidechain chain fulfills the <a href="#liveness-condition">Liveness condition</a>.</p>
</li>
<li>
<p><code>stateRoot</code>: The state root contained in the last certificate from the partner chain.
It is used to validate the inclusion proof of the cross-chain messages contained in a CCU and to verify the validity of the module recovery command.</p>
</li>
<li>
<p><code>validatorsHash</code>: The validators hash present in the last certificate from the partner chain.
This value always corresponds to the hash calculated from the <a href="#chain-validators-substore">Chain validators substore</a> entry for the partner chain.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>status</code>: This property stores the current status of the partner chain account.
As explained in <a href="#life-cycle-of-a-sidechain">Life Cycle of a Sidechain</a>, there are 3 possible statuses: <code>registered</code>(0), <code>active</code>(1), and <code>terminated</code>(2).
The default value of this property is <code>0</code>, corresponding to the <code>registered</code> status.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</details>
</div>
<div class="sect2">
<h3 id="channel-substore"><a class="anchor" href="#channel-substore"></a>Channel substore</h3>
<div class="paragraph">
<p>The channel substore holds information about the inbox and outbox with other partner chains.</p>
</div>
<div class="paragraph">
<p>It is initialized on the respective chain as part of the <a href="#sidechain-registration">Sidechain registration</a> process.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>On the mainchain, the store contains channels to all registered sidechains.</p>
</li>
<li>
<p>On a sidechain, the store contains a channel to the mainchain.</p>
</li>
</ul>
</div>
<details>
<summary class="title">Details</summary>
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Key</dt>
<dd>
<p>Each store key is set to the ID of the partner chain <code>chainID</code>.</p>
</dd>
<dt class="hdlist1">Value</dt>
<dd>
<p>Each entry in the channel substore includes the following properties:</p>
<div class="ulist">
<ul>
<li>
<p><code>inbox</code>: The data structure containing information about the cross-chain messages received from the partner chain, organized in a Regular Merkle Tree<sup class="footnote" id="_footnote_rmt">[<a id="_footnoteref_2" class="footnote" href="#_footnotedef_2" title="View footnote.">2</a>]</sup>.
It contains the following properties:</p>
<div class="ulist">
<ul>
<li>
<p><code>root</code>:  The root of the Merkle tree.</p>
</li>
<li>
<p><code>appendPath</code>: An array of hashes necessary to append new data to the tree efficiently.</p>
</li>
<li>
<p><code>size</code>: The current size of the tree, i.e. the number of cross-chain messages received from the partner chain that have been processed.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>outbox</code>: The data structure containing information about the cross-chain messages sent to the partner chain, organized in a Regular Merkle Tree.
It contains the following properties:</p>
<div class="ulist">
<ul>
<li>
<p><code>root</code>:  The root of the Merkle tree.</p>
</li>
<li>
<p><code>appendPath</code>: An array of hashes necessary to append new data to the tree efficiently.</p>
</li>
<li>
<p><code>size</code>: The current size of the tree, i.e., the number of cross-chain messages sent to the partner chain.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>partnerChainOutboxRoot</code>: The value of this property is set to the outbox root computed from the last CCU from the partner chain.
It is used to validate the cross-chain messages contained in a future CCU when the CCU does not certify a new outbox root.</p>
</li>
<li>
<p><code>messageFeeTokenID</code>: This property is the token ID of the token used to pay for the cross-chain message fees.</p>
</li>
<li>
<p><code>minReturnFeePerByte</code>: This property is the minimum fee per byte to automatically send back a CCM from the partner chain in case of execution errors.
In particular, the CCM fee must be larger or equal to the product of its size in bytes and <code>minReturnFeePerByte</code>.
The value used in channels between mainchain and sidechains is <code>minReturnFeePerByte</code> = <code>1000</code> Beddows.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</details>
</div>
<div class="sect2">
<h3 id="chain-validators-substore"><a class="anchor" href="#chain-validators-substore"></a>Chain validators substore</h3>
<div class="paragraph">
<p>The "chain validators" substore holds information about the validators of other partner chains.</p>
</div>
<div class="paragraph">
<p>It is initialized on the respective chain as part of the <a href="#sidechain-registration">Sidechain registration</a> process.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>On the mainchain, the store contains lists of validators for all registered sidechains.</p>
</li>
<li>
<p>On a sidechain, the store contains the list of the mainchain validators.</p>
</li>
</ul>
</div>
<details>
<summary class="title">Details</summary>
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Key</dt>
<dd>
<p>Each store key is set to the ID of the partner chain <code>chainID</code>.</p>
</dd>
<dt class="hdlist1">Value</dt>
<dd>
<p>Each entry in the "chain validators" substore includes the following properties:</p>
<div class="ulist">
<ul>
<li>
<p><code>activeValidators</code>: An array of objects corresponding to the set of validators eligible to sign the certificates from the partner chain.
Each entry contains the following properties:</p>
<div class="ulist">
<ul>
<li>
<p><code>blsKey</code>: The BLS public key used to sign certificates.</p>
</li>
<li>
<p><code>bftWeight</code>: An integer indicating the weight of the corresponding BLS public key for signing a certificate.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>certificateThreshold</code>: An integer setting the required cumulative weight needed for the certificate signature to be valid.
For the mainchain account on a sidechain, the <code>activeValidators</code> and <code>certificateThreshold</code> properties are initialized by the <a href="#register-mainchain-command">Register Mainchain command</a>.
For a sidechain account on the mainchain, they are set by the <a href="#register-sidechain-command">Register Sidechain command</a>.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</details>
</div>
<div class="sect2">
<h3 id="terminated-state-substore"><a class="anchor" href="#terminated-state-substore"></a>Terminated state substore</h3>
<div class="paragraph">
<p>A <strong>terminated state</strong> account is created for a terminated chain on the mainchain or another sidechain &#8230;&#8203;</p>
</div>
<div class="ulist">
<ul>
<li>
<p>&#8230;&#8203; as part of the <code>terminateChain</code> function,</p>
</li>
<li>
<p>&#8230;&#8203; as part of the processing of a <a href="#sidechain-terminated-ccm">Sidechain Terminated CCM</a>,</p>
</li>
<li>
<p>&#8230;&#8203; as part of the processing of a <a href="#channel-terminated-ccm">Channel Terminated CCM</a>,</p>
</li>
<li>
<p>&#8230;&#8203; or as part of the processing of a <a href="#recover-state">Recover State</a> command.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It is initialized with the information contained in the last sidechain certificate posted on the mainchain.</p>
</div>
<details>
<summary class="title">Details</summary>
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Key</dt>
<dd>
<p>The store key is set to the ID of the terminated chain <code>chainID</code>.</p>
</dd>
<dt class="hdlist1">Value</dt>
<dd>
<p>Each entry in the "terminated state" substore includes the following properties:</p>
<div class="ulist">
<ul>
<li>
<p><code>stateRoot</code>: The state root of the terminated chain.</p>
</li>
<li>
<p><code>mainchainStateRoot</code>: The state root of the mainchain at the moment in which the chain was terminated.</p>
</li>
<li>
<p><code>initialized</code>: A boolean value, indicating whether the terminated state account has been initialized, i.e., if the <code>stateRoot</code> property has been set.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</details>
</div>
<div class="sect2">
<h3 id="terminated-outbox-substore"><a class="anchor" href="#terminated-outbox-substore"></a>Terminated outbox substore</h3>
<div class="paragraph">
<p>A "terminated outbox" account is created for a terminated chain on the mainchain as part of the processing of a <a href="#recover-message">Recover Message</a> command.</p>
</div>
<div class="paragraph">
<p>A data structure holding the outbox root along with the mainchain inbox size from the terminated sidechain, indicating the number of messages that were processed on it.</p>
</div>
<details>
<summary class="title">Details</summary>
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Key</dt>
<dd>
<p>The store key is set to the ID of the terminated chain <code>chainID</code>.</p>
</dd>
<dt class="hdlist1">Value</dt>
<dd>
<p>Each entry in the "terminated outbox" substore includes the following properties:</p>
<div class="ulist">
<ul>
<li>
<p><code>outboxRoot</code>: The outbox root of the terminated chain.</p>
</li>
<li>
<p><code>outboxSize</code>: The outbox size of the terminated chain.</p>
</li>
<li>
<p><code>partnerChainInboxSize</code>: The number of cross-chain messages processed in the terminated chain, set to the <code>partnerChainInboxSize</code> property contained in the <a href="#recover-message">Recover Message</a> command.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</details>
</div>
<div class="sect2">
<h3 id="registered-names-substore"><a class="anchor" href="#registered-names-substore"></a>Registered names substore</h3>
<div class="paragraph">
<p>In order to process sidechain registration commands more efficiently, it is convenient to store the names already registered in the ecosystem on the mainchain.
This way it is possible to quickly check the uniqueness of the sidechain name.</p>
</div>
<div class="paragraph">
<p>This substore contains the names of all chains in the ecosystem.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The "registered names" substore is only present on the mainchain.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>An entry for the Lisk Mainchain is present by default.
Any new entry for a sidechain is created as part of the <a href="#sidechain-registration-on-the-lisk-mainchain">Sidechain registration on the Lisk Mainchain</a> in the "registered names" substore.</p>
</div>
<details>
<summary class="title">Details</summary>
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Key</dt>
<dd>
<p>The chain name (String).</p>
</dd>
<dt class="hdlist1">Value</dt>
<dd>
<p>Each entry in the "registered names" substore includes the following properties:</p>
<div class="ulist">
<ul>
<li>
<p><code>chainID</code>: The ID of the chain.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</details>
</div>
</div>
</div>
<div id="footnotes">
<hr>
<div class="footnote" id="_footnotedef_1">
<a href="#_footnoteref_1">1</a>. See <a href="https://github.com/LiskHQ/lips/blob/main/proposals/lip-0053.md#verification" target="_blank" rel="noopener">LIP 0053</a> for more information about the verification of certificates.
</div>
<div class="footnote" id="_footnotedef_2">
<a href="#_footnoteref_2">2</a>. See <a href="https://github.com/LiskHQ/lips/blob/main/proposals/lip-0031.md#regular-merkle-trees" target="_blank" rel="noopener">LIP 0031</a> for more information about Regular Merkle Trees.
</div>
</div>
  <nav class="pagination">
  <span class="prev"><a href="communication.html">Cross-chain communication</a></span>
  <span class="next"><a href="../blocks-txs.html">Blocks and Transactions</a></span>
</nav>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <div class="footerdiv">
    <p> 2023 Lisk Foundation</p>
    <!-- <div class="community-section">
      <p class="community-section__text">Follow Lisk on: </p>
      <div class="community-section__icons"> -->
    <div class="community_icons">
      <a href="https://lisk.chat" title="Discord" target="_blank" class="footer_icon icon-discord"><p>Discord</p></a>
      <a href="https://dev.lisk.com" title="Discourse" target="_blank" class="footer_icon icon-discourse"><p>Discourse</p></a>
      <a href="https://github.com/LiskHQ" title="GitHub" target="_blank" class="footer_icon icon-github"><p>GitHub</p></a>
      <!--    </div> -->
    </div>
  </div>
</footer>
<script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
<script async src="../../../_/js/vendor/glossary.js"></script>
<script async src="../../../_/js/vendor/tabs-block-behaviour.js"></script>
<script async src="../../../_/js/vendor/swagger-ui.js"></script>
<script async src="../../../_/js/vendor/component-versions.js"></script>
<script src="../../../_/js/vendor/custom.js"></script>

  </body>
</html>
