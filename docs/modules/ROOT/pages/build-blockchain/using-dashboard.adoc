= Using dashboard with the blockchain client
Mona Bärenfänger <mona@lightcurve.io> Muhammad Talha <muhammad.talha@lightcurve.io>
// Settings
:toc: preamble
:toclevels: 5
:page-toclevels: 3
:idprefix:
:idseparator: -
:sectnums:
:experimental:

:docs_sdk: lisk-sdk::
// Project URLS
:advanced_rpc_appactions: api/lisk-node-rpc.adoc#actions
:url_guides_asset: build-blockchain/module/command.adoc
:url_guides_config: build-blockchain/configuration.adoc
:url_guides_config_hello: {url_guides_config}#example-configuration-for-the-hello-world-client
:url_guides_genesisblock: build-blockchain/create-genesis-block.adoc
:url_guides_module: build-blockchain/module/index.adoc
:url_guides_module_endpoints: build-blockchain/module/endpoints-methods.adoc#endpoints
:url_guides_module_getHello: build-blockchain/module/endpoints-methods.adoc#get-a-hello-message-by-address
:url_guides_module_getHelloCounter: build-blockchain/module/endpoints-methods.adoc#get-hello-counter
:url_guides_plugin: build-blockchain/plugin/index.adoc
:url_guides_plugin_actions: {url_guides_plugin}#actions
:url_guides_setup: build-blockchain/create-blockchain-client.adoc
:url_intro_plugins: understand-blockchain/sdk/plugins.adoc


:url_gitHub_passphrase: https://github.com/LiskHQ/lisk-sdk-examples/blob/development/tutorials/hello/hello_client/config/default/passphrase.json
:url_typedoc_crypto: https://lisk.com/documentation/lisk-sdk/v6/references/typedoc/functions/_liskhq_lisk_cryptography.address.getLisk32AddressFromAddress.html

// TODO: Update the page by uncommenting the hyperlinks once the updated pages are available.

How to conveniently interact with a blockchain application during development, by using the dashboard plugin.
// xref:{url_references_dashboard_plugin}[].

.Prerequisites
[NOTE]
====
To use this guide, it is assumed that the following criteria have been met:

. Lisk Commander is installed, and a basic Lisk application is already initialized, as explained in the guide xref:{url_guides_setup}[].
. A new module `HelloModule` is created, as explained in the guide xref:{url_guides_module}[].
. A new plugin `HelloInfoPlugin` is created, as explained in the guide xref:{url_guides_plugin}[].
====

== Plugin registration

With Lisk v6, the default plugins come pre-installed after an application is initiated.
You can check the `package.json` file of the blockchain client to ensure the installation.

../hello_client/package.json
[source,json]
----
"dependencies": {
	"@liskhq/lisk-framework-dashboard-plugin": "0.2.0",
	//[...]
},
----

Otherwise, you can install the dashboard plugin like this:

[source,bash]
----
npm i @liskhq/lisk-framework-dashboard-plugin
----

Now open `plugins.ts`, import the Dashboard plugin, and register it with the application as shown below:

.src/app/plugins.ts
[source,typescript]
----
/* eslint-disable @typescript-eslint/no-empty-function */
import { Application } from 'lisk-sdk';
import { DashboardPlugin } from '@liskhq/lisk-framework-dashboard-plugin';
import { HelloInfoPlugin } from "./plugins/hello_info/hello_info_plugin";

export const registerPlugins = (app: Application): void => {
    app.registerPlugin(new HelloInfoPlugin());
    app.registerPlugin(new DashboardPlugin());
};
----

Save and close `plugins.ts`, and build the blockchain client again:

[source,bash]
----
npm run build
----

.Start the blockchain client with custom_config.json
[source,bash]
----
./bin/run start --config=config/custom_config.json 
----

Wait until the application start has been completed.
Now it is possible to access the dashboard on the browser under `localhost: 4005`

You can also see the blockchain client logs to confirm the registration of the dashboard plugin.

[source,bash]
----
2023-07-28T08:42:18.189Z INFO XYZ.local application 92756 dashboard Loading in-memory plugin
----

[IMPORTANT]
====
It is essential to enable WS API and configure the `allowedMethods` property before registering the `DashboardPlugin`.
For more information, see the configurations described in the xref:{url_guides_config_hello}[configuration guide].
====

== Dashboard walkabout

Go to http://localhost:4005 to access the dashboard.

.Dashboard overview
image::guides/dashboard/dashboard.gif["Dashboard Plugin", 1000,align="center"]



=== Invoke command

The dashboard plugin allows you to invoke various commands via the *Invoke command* section.

The *Invoke command* section lists all the module based commands registered to a node. 

The command type is selected from the dropdown box.

As we registered the `DashboardPlugin` with the `hello_client`, it is possible to send a hello message via dashboard.

.Select "hello_createHello" command.
image::guides/dashboard/send_tx_dropdown.png["Transaction dropdown",750,align="center"]

Once the desired command type is selected, provide the `passphrase` of the sender account and the hello message.

The passphrase is retrieved from the file `passphrase.json`, which is located in the `config/default` directory of the blockchain client.

You can use the {url_gitHub_passphrase}[passphrase] of the `genesis` account of `hello_client`.

The hello message can be:

[source,json]
----
{
	"message": "Greetings from Lisk!"
}
----

Once all the necessary parameters are provided, click on the kbd:[Submit] button.

// NOTE: The accounts in your `accounts.json` file will be different, because the file was newly created before in the guide xref:{url_guides_genesisblock}[].

// .config/accounts.json
// [source,js]
// ----
// [
// 	{
// 		"passphrase": "wait yellow stage simple immune primary when digital bounce coin draft life",
// 		"address": "92ff111dfc904d1d8b077bf6e815fd21d881b005"
// 	},
// 	{
// 		"passphrase": "transfer alien ticket whisper face ability rally planet town brick profit solution",
// 		"address": "80bd220ff01b6a248822b337a11be79da7fb43d2"
// 	},
// 	{
// 		"passphrase": "broccoli coast fade over atom chimney skate symptom ten rug pave marble",
// 		"address": "252eeaf82f6d713501e561ddd437bf00a903f415"
// 	},

// 	// ...
// ]
// ----

.Enter information about hello message
image::guides/dashboard/send_tx_hello.png["Send transaction",750,align="center"]

If the transaction was successfully accepted, you will see the following confirmation:

.Send "createHello" transaction to node
image::guides/dashboard/send_tx_success.png["Transaction Sent successfully",1000,align="center"]

Once the transaction is confirmed and added on chain, it can be seen in the *Recent Transaction* section.

.Recent transactions
image::guides/dashboard/recent_transactions.png["Recent transactions",750,align="center"]

=== Call endpoints

It is possible to invoke endpoints via the dashboard.
Endpoints can be invoked from the *Call endpoint* section. 

In the previous guides, the following endpoints were created:

. The endpoint `hello_getHello` of the xref:{url_guides_module_getHello}[Get latest Hello for an address].
. The endpoint `hello_getHelloCounter` of the xref:{url_guides_module_getHelloCounter}[Get Hello counter].

==== Invoking `hello_getHello`

To verify that the hello message was sent successfully, select the `hello_getHello` endpoint from the section *Call endpoint*.

The `hello_getHello` endpoint is part of the xref:{url_guides_module_endpoints}[HelloModule endpoints] and it returns the last sent hello message for the account address that is specified in the endpoint input.

Provide the `address` to which the passphrase belongs to.
For hello_client the passphrase points to the first account in the *dev-validators.json* file, which is located in the `config/default` directory of the hello client.

.Enter an address to fetch the latest hello message
image::guides/dashboard/call_action.png["Invoke hello_getHello",750,align="center"]

In response, the dashboard will display the latest hello message sent from the specified account.

.Latest hello message from the given account
image::guides/dashboard/call_action_success.png["Get latest hello message for the given account",750,align="center"]

==== Invoking `hello_getHelloCounter`

Similarly, you can also invoke the `hello_getHelloCounter` endpoint to retrieve the total number of hellos sent on chain.

.Request total number of hello messages sent so far
image::guides/dashboard/call_helloCounter.png["Invoke hello_getHello",750,align="center"]

In response, the dashboard will display the `counter` value.

.Number of hello messages sent
image::guides/dashboard/call_helloCounterResponse.png["Get latest hello message for the given account",750,align="center"]


=== Subscribing to events

At the bottom of the dashboard is the *Recent events* window, which allows the possibility to subscribe to various events by selecting them from a dropdown box.

Select the `hello_newHello` event.

.Subscribe to newHello event
image::guides/dashboard/subscribe_event.jpg["Subscribe to newHello event", 1000,align="center"]

Once a new hello transaction is posted, the newHello event is also published subsequently and will show up in the *Recent events* window.

image::guides/dashboard/receive_newHello_event.png[]

[TIP]
==== 
The value of the `senderAddress` is in the `hex` format, which can be easily converted to the Lisk32 format through the `cryptography` package.
For example:

[source,js]
----
lisk.cryptography.address.getLisk32AddressFromAddress(Buffer.from("8ebe46d631ae4cc7ad14ba5235edde56c5f34ec6", 'hex'));
----
For more information, see {url_typedoc_crypto}[getLisk32AddressFromAddress].
====


The Dashboard plugin provides various features, and most of them are very self-explanatory.
For example, you can create new accounts, see unconfirmed transactions, see generated blocks, general node and network information, etc.


// NOTE: The plugin endpoints are not accessible through the dashboard plugin. Commenting out the following section until further notice.

// ==== Invoking `latestHello:getLatestHello`

// Select `latestHello:getLatestHello` from the dropdown menu.

// You can directly click on the kbd:[Submit] button to view the results.
// Again, it is not necessary to provide any input, because the action doesn't require any.

// image::guides/dashboard/call_pluginaction.png["Invoke plugin action",400]

// As expected, the plugin responds with the latest hello message that was posted to the blockchain application.

// image::guides/dashboard/call_pluginaction_success.png["Plugin action success",400]
