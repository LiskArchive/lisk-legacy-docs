<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>State machine :: Lisk documentation</title>
    <link rel="canonical" href="https://liskhq.github.io/lisk-docs/understand-blockchain/state-machine.html">
    <link rel="prev" href="index.html">
    <link rel="next" href="consensus/index.html">
    <meta name="generator" content="Antora 3.1.1">

<link id="theme" rel="stylesheet" title="Default" href="../_/css/site.css">
<link rel="stylesheet" title="Dark" href="../_/css/dark-site.css">

<script>var uiRootPath = '../_'</script>
<script src="../_/js/vendor/medium-zoom.js"></script>
<script type="text/javascript" id="Cookiebot" src="https://consent.cookiebot.com/uc.js" data-cbid="e4db29b5-cd94-4bcf-87e4-04f4ca564240" data-blockingmode="manual"></script>
<!-- Matomo -->
<script>
  var _paq = window._paq = window._paq || [];
  /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="https://lisk.matomo.cloud/";
    _paq.push(['setTrackerUrl', u+'matomo.php']);
    _paq.push(['setSiteId', '2']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.async=true; g.src='//cdn.matomo.cloud/lisk.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
<!-- End Matomo Code -->
<!-- Matomo Tag Manager -->
<script>
  var _mtm = window._mtm = window._mtm || [];
  _mtm.push({'mtm.startTime': (new Date().getTime()), 'event': 'mtm.Start'});
  var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
  g.async=true; g.src='https://cdn.matomo.cloud/lisk.matomo.cloud/container_RUW6y8yf.js'; s.parentNode.insertBefore(g,s);
</script>
<!-- End Matomo Tag Manager -->
<link rel="icon" href="../_/img/favicon.png" type="image/x-icon">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <div class="top-logo">
        <a href=".." class="lisk-logo"></a>
        <a href=".." class="docs-logo"></a>
      </div>
      <!--<a class="navbar-item" href="https://liskhq.github.io/lisk-docs">Lisk documentation</a>-->
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">APIs</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="../api/lisk-node-rpc.html">Lisk node RPC API</a>
            <a class="navbar-item" href="../api/lisk-service-http.html">Lisk Service HTTP
              API</a>
            <a class="navbar-item" href="../api/lisk-service-rpc.html">Lisk Service RPC
              API</a>
            <a class="navbar-item" href="../api/lisk-service-pubsub.html">Lisk Service
              Pub/Sub API</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Explorers</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://lisk.observer/" target="_blank">Lisk Observer</a>
            <a class="navbar-item" href="https://liskscan.com/" target="_blank">LiskScan</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Products</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="../lisk-sdk/">Lisk SDK</a>
            <a class="navbar-item" href="../lisk-service/">Lisk Service</a>
            <a class="navbar-item" href="../lisk-core/">Lisk Core</a>
            <a class="navbar-item" href="https://lisk.com/wallet" target="_blank">Lisk Wallets</a>
          </div>
        </div>
        <button onclick="switch_style('toggle')" id="theme-toggle" class="theme-toggle navbar-item"></button>
        <!-- <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="#">Download</a>
          </span>
        </div> -->
      </div>
    </div>
  </nav>
</header>
<div class="toolbar" role="navigation">
  <button class="nav-toggle"></button>
  <div class="components-versions">
      <div class="page-components">
    <button class="component-menu-toggle" title="Show other documentations">Lisk Documentation</button>
    <div class="component-menu">
        <a class="component" href="../lisk-core/index.html">Lisk Core</a>
        <a class="component" href="../lisk-docs-manual/index.html">Lisk docs manual</a>
        <a class="component is-current" href="../index.html">Lisk Documentation</a>
        <a class="component" href="../lisk-sdk/index.html">Lisk SDK</a>
        <a class="component" href="../lisk-service/index.html">Lisk Service</a>
    </div>
  </div>
    <span></span>
    <div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">default</button>
  <div class="version-menu">
    <a class="version is-current" href="state-machine.html">default</a>
    <a class="version is-missing" href="../lisk-v3/index.html">lisk-v3</a>
  </div>
</div>
  </div>
  <span></span>
  <span></span>
    <a href="../index.html" class="home-link"></a>
  <nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Lisk Documentation</a></li>
    <li><a href="index.html">Understand Lisk Blockchain</a></li>
    <li><a href="state-machine.html">State machine</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/LiskHQ/lisk-docs/edit/development/docs/modules/ROOT/pages/understand-blockchain/state-machine.adoc">Edit this Page</a></div>
</div>

<div class="body">
<div class="nav-container" data-component="ROOT" data-version="">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">Lisk Documentation</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Introduction</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../intro/what-is-blockchain.html">What is blockchain?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../intro/how-blockchain-works.html">How blockchain works</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../intro/blockchain-scalability.html">Blockchain Scalability</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../intro/lisk-products.html">Lisk products</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="index.html">Understand Lisk Blockchain</a>
<ul class="nav-list">
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="state-machine.html">State machine</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="consensus/index.html">Consensus protocols</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="consensus/pos-poa.html">Proof of Stake (PoS) &amp; Proof of Authority (PoA) in Lisk</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="network.html">Network</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="mainchain.html">Mainchain</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="interoperability/index.html">Lisk Interoperability</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="interoperability/communication.html">Cross-chain communication</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="interoperability/sidechain-registration-and-recovery.html">Sidechain Registration &amp; Recovery</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="blocks-txs.html">Blocks and Transactions</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Lisk SDK</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="sdk/modules-commands.html">Modules and Commands</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="sdk/plugins.html">Plugins</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="sdk/rpc.html">Communicating to a Lisk node via RPC</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="sdk/codec-schema.html">Schemas &amp; Codec</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../build-blockchain/index.html">Build Blockchain</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../build-blockchain/create-blockchain-client.html">Creating a new blockchain client</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../build-blockchain/configuration.html">Blockchain client configuration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../build-blockchain/module/index.html">How to create a module</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../build-blockchain/module/configuration.html">1. How to create a module configuration</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../build-blockchain/module/stores.html">2. How to create stores</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../build-blockchain/module/command.html">3. How to create a command</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../build-blockchain/module/endpoints-methods.html">4. How to create endpoints and methods</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../build-blockchain/module/blockchain-event.html">5. How to create a blockchain event</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../build-blockchain/plugin/index.html">How to create a plugin</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../build-blockchain/plugin/schema-types.html">1. Defining off-chain data structures</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../build-blockchain/plugin/offchain-db.html">2. Setting up an Off-chain database</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../build-blockchain/plugin/configuring-plugin.html">3. Configuring a Plugin</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../build-blockchain/plugin/plugin-class.html">4. Updating the Plugin Class</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../build-blockchain/plugin/plugin-endpoints.html">5. Creating an endpoint &amp; Testing the plugin</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../build-blockchain/using-dashboard.html">Using the Dashboard with a blockchain client</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../build-blockchain/enable-faucet.html">How to enable a Faucet for testing</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../build-blockchain/create-genesis-block.html">How to create a new genesis block</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../build-blockchain/register-sidechain.html">How to register a sidechain</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../build-blockchain/interoperable-module/index.html">How to implement cross-chain communication</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../build-blockchain/interoperable-module/create-ccm.html">How to create a CCM</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../build-blockchain/interoperable-module/execute-ccm.html">How to execute a CCM</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../run-blockchain/index.html">Run Blockchain</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../run-blockchain/process-management.html">Process management with PM2</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../run-blockchain/account-management.html">Managing accounts</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../run-blockchain/become-a-validator.html">How to become a validator</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../run-blockchain/staking.html">How to stake and un-stake tokens</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../run-blockchain/enable-block-generation.html">How to enable/disable block generation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../run-blockchain/reward-sharing.html">How to share block rewards</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../run-blockchain/setup-relayer.html">Setting up a relayer node</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../run-blockchain/blockchain-reset.html">Resetting and snapshotting the blockchain</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../run-blockchain/enabling-misbehavior-report.html">How to enable the "Report Misbehavior" plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../run-blockchain/logging.html">Managing logs</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../integrate-blockchain/index.html">Integrate Blockchain</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../integrate-blockchain/connecting-endpoints.html">Connecting via endpoints</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../integrate-blockchain/subscribing-to-events.html">Retrieving on-chain events</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Transaction creation, signing, and posting</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../integrate-blockchain/create-sign-transactions.html">How to create and sign a transaction</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../integrate-blockchain/create-tx-offline.html">Creating transactions and signing them offline</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../integrate-blockchain/multisignature-accounts-and-transactions.html">How to create multi-signature accounts and transactions</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../integrate-blockchain/create-multiSig-tx-offline.html">Creating and signing a multi-signature transaction (Offline)</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../integrate-blockchain/calculating-min-fee.html">How to calculate the minimum fee for a transaction</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../integrate-blockchain/posting-transactions.html">How to post a transaction</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../integrate-blockchain/encode-decode.html">Decoding &amp; encoding data</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../integrate-blockchain/overwriting-transactions.html">How to overwrite a transaction in the transaction pool</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../integrate-blockchain/integrate-ui/index.html">Integrating a user interface</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../integrate-blockchain/integrate-ui/create-get-account.html">1. Handling accounts</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../integrate-blockchain/integrate-ui/faucet-transfer.html">2. Using faucet and transferring tokens</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../integrate-blockchain/integrate-ui/send-get-hello.html">3. Sending and retrieving hello</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../integrate-blockchain/aggregate-blockchain-data/index.html">Aggregate blockchain data with Lisk Service</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">APIs</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../api/lisk-node-rpc.html">RPC API for Lisk nodes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Module RPC APIs</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../api/module-rpc-api/auth-endpoints.html">Auth module: Endpoint reference</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../api/module-rpc-api/dynamic-reward-endpoints.html">Dynamic Reward module: Endpoint reference</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../api/module-rpc-api/fee-endpoints.html">Fee module: Endpoint reference</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../api/module-rpc-api/interoperability-endpoints.html">Sidechain Interoperability module: Endpoint reference</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../api/module-rpc-api/mainchain-interoperability-endpoints.html">Mainchain Interoperability module: Endpoint reference</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../api/module-rpc-api/token-endpoints.html">Token module: Endpoint reference</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../api/module-rpc-api/validators-endpoints.html">Validators module: Endpoint reference</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../api/module-rpc-api/random-endpoints.html">Random module: Endpoint reference</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../api/module-rpc-api/pos-endpoints.html">Proof of Stake module: Endpoint reference</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Plugin RPC APIs</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../api/plugin-rpc-api/chain-connector-api.html">Chain Connector plugin: Endpoint reference</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Lisk Service APIs</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../api/lisk-service-rpc.html">RPC API of Lisk Service</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../api/lisk-service-http.html">HTTP API (Lisk Service)</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../api/lisk-service-pubsub.html">Publish/Subscribe API (Lisk Service)</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../api/lisk-service-api-migration.html">Lisk Service API v2 vs v3</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Products</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../lisk-sdk/index.html">Lisk SDK</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../lisk-service/index.html">Lisk Service</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../lisk-core/index.html">Lisk Core</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../bug-bounty-program.html">Lisk Bug Bounty Program</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Lisk Documentation</span>
    <span class="version">default</span>
  </div>
  <ul class="components">
    <li class="component">
      <a class="title" href="../lisk-core/index.html">Lisk Core</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../lisk-core/index.html">4.0 (latest)</a>
        </li>
        <li class="version">
          <a href="../lisk-core/v3/index.html">3.1.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../lisk-docs-manual/index.html">Lisk docs manual</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../lisk-docs-manual/index.html">0.1.0</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <a class="title" href="../index.html">Lisk Documentation</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">default</a>
        </li>
        <li class="version">
          <a href="../lisk-v3/index.html">lisk-v3</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../lisk-sdk/index.html">Lisk SDK</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../lisk-sdk/index.html">6.0 (latest)</a>
        </li>
        <li class="version">
          <a href="../lisk-sdk/v5/index.html">5.3.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../lisk-service/index.html">Lisk Service</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../lisk-service/index.html">0.7 (latest)</a>
        </li>
        <li class="version">
          <a href="../lisk-service/v0.6/index.html">0.6</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
      <h1 class="page">State machine</h1>
    <div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#the-blockchain-state-as-sparse-merkle-tree">The blockchain state as Sparse Merkle Tree</a></li>
<li><a href="#use-cases-of-merkle-trees-in-lisk">Use cases of Merkle trees in Lisk</a></li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Every blockchain is at its core a replicated <a href="https://en.wikipedia.org/wiki/Deterministic_finite_automaton" target="_blank" rel="noopener">deterministic finite-state machine</a>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A <strong>state machine</strong> is a concept in computer science, consisting of the following elements:</p>
<div class="ulist">
<ul>
<li>
<p><strong>States:</strong> A state machine typically has a set of different states that it can enter.
For example, a padlock represented as a state machine would have the two states "Open" and "Locked".</p>
</li>
<li>
<p><strong>Transitions:</strong> A set of allowable operations that change from one state to another.
For example, to change from the state "Open" to "Locked", a transition would be "Close padlock", and from "Locked" to "Open", it would be "Insert key &amp; turn".</p>
</li>
</ul>
</div>
</li>
<li>
<p>The state machine is <strong>replicated</strong> across multiple nodes.
Each node maintains independently the current state of the state machine.
This only works for <em>deterministic</em> state machines.</p>
</li>
<li>
<p><strong>Finite</strong> means that the number of states that the machine can reach is finite (not infinite).</p>
</li>
<li>
<p>And <strong>deterministic</strong> means that if the state machine is replicated and all state transitions are replayed, it will end up always in the exact same state.</p>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
See also <a href="../intro/how-blockchain-works.html#state-machine" class="xref page">Intro &gt; How blockchain works &gt; State machine</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In the blockchain context, these elements are represented as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A <strong>state</strong> is a state of the blockchain.
In Lisk, a <strong>key-value</strong> store is used as a database, containing all data that is considered part of the blockchain.</p>
</li>
<li>
<p>A <strong>transition</strong> of states is triggered through <strong>blocks</strong> and their containing <strong>transactions</strong> which are added to the blockchain.
When executing a block <code>B</code>, the state machine changes its state from a state <code>S</code> to a state <code>S’</code>.
This one state transition can further be broken down into smaller intermediate state transitions, for instance, by considering that executing a block means executing all transactions in that block sequentially.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="the-blockchain-state-as-sparse-merkle-tree"><a class="anchor" href="#the-blockchain-state-as-sparse-merkle-tree"></a>The blockchain state as Sparse Merkle Tree</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A Regular Merkle Tree (RMT) is an authenticated data structure organized as a tree.
Let&#8217;s try to understand what exactly each of these words means:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Merkle:</strong> This name is derived from the actual inventor of hash trees, Ralph Merkle.</p>
</li>
<li>
<p><strong>Data structure:</strong> A data structure is a collection of data with a set of operations that can be performed on it.
An example of a data structure is an array, an object, or a Merkle tree.</p>
</li>
<li>
<p><strong>Authenticated:</strong> The integrity of the data structure can be efficiently verified using the (Merkle) root of the tree.
The dataset cannot be altered without changing the Merkle root.</p>
</li>
<li>
<p><strong>Tree:</strong> The underlying data structure is organized as a tree, where each parent node is obtained by hashing the data from the child nodes in the layer below.
Here we consider only <strong>binary trees</strong>, where each parent has two children.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A <strong>Sparse Merkle Tree (SMT)</strong> is very similar to a Regular Merkle Tree, with the following difference:
The order of insertion of data blocks does not matter, and the root of the tree only depends on the final state of the map.
That means, in an SMT, the input of the hash function is the underlying key-value map and the output is the Merkle root.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Due to the history independence, SMTs are the suitable choice to authenticate <a href="#kv-maps">key-value maps</a>.
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/understand-blockchain/rmt-vs-smt.png" alt="rmt vs smt">
</div>
<div class="title">Figure 1. RMT vs SMT</div>
</div>
<div class="paragraph">
<p>A blockchain created with the Lisk SDK defines a single global store.
An SMT is created on top of the global state store, called the <strong>state tree</strong>.
Then the Merkle root of this tree, the state root, is inserted into each block header.</p>
</div>
<div class="paragraph">
<p>Each module registered on the chain defines its own generic key-value map, where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>key</strong>: Module Name + Store prefix + Substore prefix + Store key</p>
<div class="ulist">
<ul>
<li>
<p><strong>Module Name</strong>: The unique identifier of the module, identifying the key-value map.
The module name is a unique string that is used to construct store prefix and various module-related operations.</p>
</li>
<li>
<p><strong>Store prefix</strong>: The module store prefix is calculated automatically from the first 4 bytes of the hash of the module name, where the first bit of the store prefix is set to 0.
On the other hand, the Interoperability module store prefix is set to a constant, with the first bit set to 1.
This is done to separate the Interoperability module from other modules in the state tree and make the state tree unbalanced, to shorten inclusion proofs for the Interoperability module store (required for cross-chain update commands).</p>
</li>
<li>
<p><strong>Substore prefix</strong> The substore prefix identifies a substore within the module store, i.e. a group of key-value pairs with the same scope and typically values in the same format.
Substore prefixes are byte values, having a length of 2 bytes.</p>
</li>
<li>
<p><strong>Store key</strong>: The store key identifies a certain element within a store bucket.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Store value</strong>: serialized object (with JSON schema)</p>
<div class="ulist">
<ul>
<li>
<p><strong>JSON schema</strong>: The schema used in <code>lisk-codec</code> to serialize the value</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div id="data-stores" class="imageblock">
<div class="content">
<img src="../_images/understand-blockchain/smt.png" alt="smt">
</div>
<div class="title">Figure 2. Module data stores of a sidechain as SMT</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="use-cases-of-merkle-trees-in-lisk"><a class="anchor" href="#use-cases-of-merkle-trees-in-lisk"></a>Use cases of Merkle trees in Lisk</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">SMTs allow efficient inclusion &amp; non-inclusion proofs</div>
A Prover is able to convince a Verifier that a certain element is present in the underlying data structure <strong>without revealing any other element</strong>, and the <strong>proof size scales logarithmically</strong> with the number of data blocks.
A Prover can convince a Verifier that a certain entry is not present in the map, and the proof size scales logarithmically with the number of data blocks.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A list of all use cases for SMTs in the Lisk Protocol, and their corresponding SMT is described below:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Use cases for SMTs in the Lisk protocol</caption>
<colgroup>
<col style="width: 22.2222%;">
<col style="width: 22.2222%;">
<col style="width: 55.5556%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Use Case</th>
<th class="tableblock halign-left valign-top">SMT</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Interoperability</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>stateRoot</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The <code>stateRoot</code> is used during the processing of cross-chain update transactions to authenticate the outgoing messages from one chain.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">State consistency</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>stateRoot</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>All nodes in the network will be able to check the consistency of the state just by checking the <code>stateRoot</code>.
For instance, if a block contains a transaction that randomly credits either user A or user B with tokens, then any node obtaining a different result from the block generator would immediately reject the block, as the two state roots would differ.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Light clients</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>stateRoot</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The <code>stateRoot</code> can be used to provide efficient proofs for the state of a certain account.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Decentralized Regenesis</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>stateRoot</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>A snapshot of the blockchain can be used to perform a hardfork to implement the new protocol.
Reference to the last blockchain state will be stored as the Merkle root of the hashes of all blocks up to the snapshot.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Proofs-of-Inclusion for Events in a Block</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>eventRoot</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The root of the event Sparse Merkle Tree is added to the block header to allow checking the inclusion and non-inclusion of events.</p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>A list of all use cases for RMTs in the Lisk Protocol, and their corresponding RMT is described below:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. Use cases for RMTs in the Lisk protocol</caption>
<colgroup>
<col style="width: 22.2222%;">
<col style="width: 22.2222%;">
<col style="width: 55.5556%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Use Case</th>
<th class="tableblock halign-left valign-top">RMT</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Proofs-of-Inclusion for Transactions in a Block</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>transactionRoot</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Each block header stores the <code>transactionRoot</code>.
The <code>transactionRoot</code> is calculated as the Merkle root of the IDs of the transactions included in the block payload<sup class="footnote" id="_footnote_lip32">[<a id="_footnoteref_1" class="footnote" href="#_footnotedef_1" title="View footnote.">1</a>]</sup>.
Using the <code>transactionRoot</code> and a proof-of-inclusion, it is possible to check whether a certain transaction is part of the block without downloading the full block.</p>
</div>
<div id="footnotes">
<hr>
<div class="footnote" id="_footnotedef_1">
<a href="#_footnoteref_1">1</a>. The details are specified in <a href="https://github.com/LiskHQ/lips/blob/main/proposals/lip-0032.md" target="_blank" rel="noopener">LIP 0032</a>.
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Proofs-of-Inclusion for Assets in a Block</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>assetRoot</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The root of the asset Merkle tree is added to the block header to allow checking the inclusion and non-inclusion of block assets.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Inbox &amp; Outbox</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>inboxRoot</code>, <code>outboxRoot</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Since the root of the tree depends on the order of insertion, all <a href="interoperability/communication.html#inducing-state-changes-across-chains-with-ccms" class="xref page">cross-chain messages</a> have to be inserted in the receiving chain in the same order in which they were included in the sending chain, guaranteeing that they are processed in the correct order.
Using a Merkle tree also guarantees that the number of sibling hashes that are part of inclusion proofs grows only logarithmically with the number of elements in the tree.
In particular, this means that the number of sibling hashes required to validate the cross-chain messages in a CCU against the partner chain <code>lastCertificate.stateRoot</code> grows logarithmically with the number of processed messages.</p>
</div></div></td>
</tr>
</tbody>
</table>
<div id="kv-maps" class="sidebarblock">
<div class="content">
<div class="paragraph">
<p>What are key-value maps?</p>
</div>
<div class="paragraph">
<p>A key-value map is a collection of (key, value) pairs such that each key appears at most once.
It supports the following operations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Look up: Returns the value associated with a certain key.</p>
</li>
<li>
<p>Insert: Inserts a certain key-value pair in the collection.</p>
</li>
<li>
<p>Update: Updates the value associated with a certain key.</p>
</li>
<li>
<p>Delete: Removes a certain key-value pair in the collection.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For more information about RMTs and SMTs, check out the following blog posts:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://lisk.com/blog/posts/introducing-lisk-tree" class="bare" target="_blank" rel="noopener">https://lisk.com/blog/posts/introducing-lisk-tree</a></p>
</li>
<li>
<p><a href="https://lisk.com/blog/posts/sparse-merkle-trees-and-new-state-model" class="bare" target="_blank" rel="noopener">https://lisk.com/blog/posts/sparse-merkle-trees-and-new-state-model</a></p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
  <nav class="pagination">
  <span class="prev"><a href="index.html">Understand Lisk Blockchain</a></span>
  <span class="next"><a href="consensus/index.html">Consensus protocols</a></span>
</nav>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <div class="footerdiv">
    <p>© 2023 Lisk Foundation</p>
    <!-- <div class="community-section">
      <p class="community-section__text">Follow Lisk on: </p>
      <div class="community-section__icons"> -->
    <div class="community_icons">
      <a href="https://lisk.chat" title="Discord" target="_blank" class="footer_icon icon-discord"><p>Discord</p></a>
      <a href="https://dev.lisk.com" title="Discourse" target="_blank" class="footer_icon icon-discourse"><p>Discourse</p></a>
      <a href="https://github.com/LiskHQ" title="GitHub" target="_blank" class="footer_icon icon-github"><p>GitHub</p></a>
      <!--    </div> -->
    </div>
  </div>
</footer>
<script id="site-script" src="../_/js/site.js" data-ui-root-path="../_"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script async src="../_/js/vendor/highlight.js"></script>
<script async src="../_/js/vendor/glossary.js"></script>
<script async src="../_/js/vendor/tabs-block-behaviour.js"></script>
<script async src="../_/js/vendor/swagger-ui.js"></script>
<script async src="../_/js/vendor/component-versions.js"></script>
<script src="../_/js/vendor/custom.js"></script>

  </body>
</html>
