<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Transport Tutorial Part 3: Next steps :: Docs</title>
    <link rel="canonical" href="https://lisk.io/documentation/lisk-sdk/tutorials/transport3.html">
    <meta name="generator" content="Antora 2.2.0">
    <link rel="stylesheet" href="../../_/css/site.css">
    <script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<!--
    <link href="https://unpkg.com/primer/build/build.css" rel="stylesheet">
-->
<link rel="icon" href="/sites/default/files/favicons/favicon-32x32.png" type="image/png">
  </head>
  <body class="article">
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-NKNKGHL');</script>
<!-- End Google Tag Manager -->
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NKNKGHL"
                  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->

<header class="header">
  <nav class="navbar">
      <div class="navbar-content">
        <div class="navbar-brand">
          <a href="https://lisk.io/documentation" class="lisk-logo"></a>
          <span  class="nav-brand__name-area">
              <strong class="nav-brand__name-area__title">Docs</strong>
          </span>
          <button class="navbar-burger" data-target="topbar-nav">
            <span></span>
            <span></span>
            <span></span>
          </button>
        </div>
        <div id="topbar-nav" class="navbar-menu">
          <div class="navbar-end">
            <div class="navbar-item has-dropdown is-hoverable">
              <a class="navbar-link" href="#">Docs</a>
              <div class="navbar-dropdown">
                <a class="navbar-item" href="https://lisk.io/documentation/lisk-sdk/">Lisk SDK</a>
                <a class="navbar-item" href="https://lisk.io/documentation/lisk-core/">Lisk Core</a>
              </div>
            </div>
            <div class="navbar-item has-dropdown is-hoverable">
              <a class="navbar-link" href="https://lisk.io/documentation/lisk-sdk/tutorials/index.html">Tutorials</a>
              <div class="navbar-dropdown">
                <a class="navbar-item" href="https://lisk.io/documentation/lisk-sdk/tutorials/hello-world.html"><strong>Hello World</strong>: Build a blockchain application 101</a>
                <a class="navbar-item" href="https://lisk.io/documentation/lisk-sdk/tutorials/cashback.html"><strong>Cashback</strong>: How to extend from another transaction type</a>
                <a class="navbar-item" href="https://lisk.io/documentation/lisk-sdk/tutorials/transport.html"><strong>Transport</strong>: How to connect IoT devices to the network</a>
              </div>
            </div>
            <div class="navbar-item has-dropdown is-hoverable">
              <a class="navbar-link" href="#">API</a>
              <div class="navbar-dropdown">
                <a class="navbar-item" href="https://lisk.io/documentation/lisk-core/api.html">Testnet</a>
                <a class="navbar-item" href="https://lisk.io/documentation/lisk-core/api-mainnet.html">Mainnet</a>
              </div>
            </div>
            <div class="navbar-item has-dropdown is-hoverable">
              <a class="navbar-link" href="#">Reference</a>
              <div class="navbar-dropdown">
                <a class="navbar-item" href="https://lisk.io/documentation/lisk-sdk/lisk-elements/packages.html">Lisk Elements</a>
                <a class="navbar-item" href="https://lisk.io/documentation/lisk-sdk/lisk-commander/user-guide.html">Lisk Commander</a>
                <a class="navbar-item" href="https://lisk.io/documentation/lisk-sdk/lisk-framework">Lisk Framework</a>
              </div>
            </div>
            <div class="navbar-item has-dropdown is-hoverable">
              <a class="navbar-link" href="#">Ressources</a>
              <div class="navbar-dropdown">
                <a class="navbar-item" href="https://lisk.io/roadmap">Roadmap</a>
                <a class="navbar-item" href="https://lisk.io/lisk-builders">Lisk Builders Program</a>
                <a class="navbar-item" href="https://lisk.io/community">Community</a>
                <a class="navbar-item" href="https://lisk.io/apps">App List</a>
              </div>
            </div>
            <div class="navbar-item has-dropdown is-hoverable">
              <a class="navbar-link" href="#">Github</a>
              <div class="navbar-dropdown">
                <a class="navbar-item" target="_blank" href="https://github.com/LiskHQ/lisk-sdk">Lisk SDK</a>
                <a class="navbar-item" target="_blank" href="https://github.com/LiskHQ/lisk-core">Lisk Core</a>
                <a class="navbar-item" target="_blank" href="https://github.com/LiskHQ/lisk-desktop">Lisk Desktop</a>
                <a class="navbar-item" target="_blank" href="https://github.com/LiskHQ/lisk-mobile">Lisk Mobile</a>
                <a class="navbar-item" target="_blank" href="https://github.com/LiskHQ/lisk-sdk-examples">Example Applications</a>
              </div>
            </div>
            <div class="navbar-item button-back">
              <span class="control">
                <a class="button is-primary" href="https://lisk.io">Back to lisk.io</a>
              </span>
            </div>
          </div>
        </div>
      </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="lisk-sdk" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">Lisk SDK</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../index.html"><strong>Overview</strong></a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../setup.html">Setup</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../configuration.html">Configuration</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../customize.html">Customization</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text"><strong>Tutorials</strong></span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="index.html">Overview</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="hello-world.html"><strong>Hello World:</strong> Build a blockchain application 101</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="cashback.html"><strong>Cashback:</strong> How to extend from an existing transaction type</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="transport.html"><strong>Transport:</strong> How to connect IoT devices to the network</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="transport0.html"><strong>Part 0:</strong> Installation &amp; Setup</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="transport1.html"><strong>Part 1:</strong> Tracking a packet on the blockchain</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="transport2.html"><strong>Part 2:</strong> A simple supply chain management system</a>
  </li>
  <li class="nav-item is-current-page" data-depth="3">
    <a class="nav-link" href="transport3.html"><strong>Part 3:</strong> How to publish the application</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text"><strong>Lisk Commander</strong></span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../lisk-commander/index.html">Overview</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../lisk-commander/user-guide.html">User Guide</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../lisk-commander/user-guide/commands.html">Command Reference</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../lisk-commander/user-guide/lisk-core.html">Lisk Core Commands</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../lisk-commander/user-guide/sensitive-inputs.html">Sensitive inputs</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text"><strong>Lisk Elements</strong></span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../lisk-elements/index.html">Overview</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../lisk-elements/packages.html">Packages</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../lisk-elements/packages/api-client.html">API Client</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../lisk-elements/packages/client.html">Client</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../lisk-elements/packages/constants.html">Constants</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../lisk-elements/packages/cryptography.html">Cryptography</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../lisk-elements/packages/passphrase.html">Passphrase</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../lisk-elements/packages/transactions.html">Transactions</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text"><strong>Lisk Framework</strong></span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../lisk-framework/index.html">Overview</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Lisk SDK</span>
    <span class="version">2.3.6 (latest)</span>
  </div>
  <ul class="components">
    <li class="component">
      <span class="title">Lisk Core</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../lisk-core/index.html">2.1.3 (latest)</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <span class="title">Lisk SDK</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">2.3.6 (latest)</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main>
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Lisk SDK</a></li>
    <li><strong>Tutorials</strong></li>
    <li><a href="transport.html"><strong>Transport:</strong> How to connect IoT devices to the network</a></li>
    <li><a href="transport3.html"><strong>Part 3:</strong> How to publish the application</a></li>
  </ul>
</nav>
<button class="toc-toggle"></button>
  <div class="edit-this-page"><a href="https://github.com/LiskHQ/lisk-docs/edit/docs-sdk/modules/ROOT/pages/tutorials/transport3.adoc">Edit this Page</a></div>
  </div>
<article class="doc">
<h1 class="page">Transport Tutorial Part 3: Next steps</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>In part 3, the next possible steps after the initial development of the app are described.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_make_it_portable"><a class="anchor" href="#_make_it_portable"></a>1. Make it portable</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Currently the packet is not really portable, because it is connected via USB to the computer in order to get power.</p>
</div>
<div class="paragraph">
<p>To make it portable, all that is needed is a portable power source, like a battery, that provides the Raspberry Pi with enough power to track the packet for at least a few hours.</p>
</div>
<div class="paragraph">
<p>The second thing that needs to be done is making the tracking script start automatically after the boot process of the Pi.</p>
</div>
<div class="paragraph">
<p><code>pm2</code> provides an easy way to let the script start automatically after boot.
On the Raspberry Pi, install <code>pm2</code> globally:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">npm install pm2 -g
pm2 startup</code></pre>
</div>
</div>
<div class="paragraph">
<p>This should print a fitting command in the terminal.
Copy it and paste it in the temrinal again to complete the setup of the <code>pm2</code> startup script.</p>
</div>
<div class="paragraph">
<p>Start the tracking script with <code>pm2</code>:</p>
</div>
<div class="listingblock">
<div class="title">Run this inside the <code>light_alarm</code> folder on the Raspberry Pi</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">pm2 start --name lightAlarm index.js</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Add the tracking script to the list of processes, that will be started autmatically when the raspberry pi is started.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">pm2 save</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now log out from the Raspberry Pi, disconnect it from the computer, and connect it to a portable energy source, like a power bank.
After 1-2 minutes of booting, the tracking script will start running and it will check the light sensor every second.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_connect_more_nodes"><a class="anchor" href="#_connect_more_nodes"></a>2. Connect more nodes</h2>
<div class="sectionbody">
<div class="paragraph">
<p>During development it is necessary and convenient to have a rather centralized network with only one node connected.</p>
</div>
<div class="paragraph">
<p>Once the development has reached the point of proof of concept or a usable product, it&#8217;s time to add more nodes to the network, and to give other people the opportunity to join the newly created blockchain network.</p>
</div>
<div class="paragraph">
<p>This is how the setup should look like after finishing <a href="transport2.html" class="page">Part 2: A simple supply chain tracking system</a>:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../_images/1-node.png" alt="One node diagram"></span></p>
</div>
<div class="paragraph">
<p>We want to add one more node to the network, that communicates between the seed node and the Iot and the client app.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../_images/2-nodes.png" alt="More nodes diagram"></span></p>
</div>
<div class="paragraph">
<p>To do so:</p>
</div>
<div class="sect2">
<h3 id="_set_up_at_least_one_seed_node"><a class="anchor" href="#_set_up_at_least_one_seed_node"></a>2.1. Set up at least one seed node</h3>
<div class="paragraph">
<p>Set up one or multiple seed node(s).
Every new node will connect to the seed nodes at first, when booting for the first time.
Starting from the seed node, a new node will discover the rest of the network by requesting their peer list and then the peer lists of the newly discovered peers and so on.</p>
</div>
<div class="paragraph">
<p>The seed node is a node that is specified in the config of the node application under <code>modules.network.seedPeers</code> and that should always stay connected to the network.</p>
</div>
<div class="paragraph">
<p>It&#8217;s also convenient to have the genesis delegates actively forging on the seed node, in case the network hasn&#8217;t yet enough real delegates who can take the forging spots.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
The exposed <code>configDevnet</code> object is a good template for the config of a seed node, as it includes already all 101 genesis delegates credentials and automatically enables forging for all of them.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_create_a_new_config_suited_for_the_node_application"><a class="anchor" href="#_create_a_new_config_suited_for_the_node_application"></a>2.2. Create a new config suited for the node application</h3>
<div class="paragraph">
<p>Exchange the <code>configDevnet</code> object that we passed to our node during development with an own customized version.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>It&#8217;s recommended to create a config object with all the options that shall be different to the default config options.
To check the default config options, go to the <a href="../configuration.html" class="page">configuration page</a> or check it out directly in the code:<br>
<code>lisk-framework/src/modules/MODULE_NAME/defaults/config.js</code>.<br>
Same goes for the components:<br>
<code>lisk-framework/src/components/COMPONENT_NAME/defaults/config.js</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Most of the configurations can stay the same to what is defined in the default config options, but there is one option that should be updated: <strong>The seed node(s)</strong>.</p>
</div>
<div class="paragraph">
<p>So to add <code>1.2.3.4</code> as a seed node, add an object (or several objects) with the 2 properties <code>ip</code> and <code>wsPort</code> to the <code>seedPeers</code> list:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-js hljs" data-lang="js">const app = new Application(genesisBlockDevnet, {
    modules: {
        network: {
            seedPeers: [{ ip: '1.2.3.4', wsPort: 5000}]
        }
    }
});</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>By default, the forging delegates list is empty.<br>
This is intended, because the genesis delegates are only needed to set up a working dev environment.
Later it&#8217;s best if the <code>delegates</code> list is empty, so users can fill their own credentials there, in case they want to activate forging on their node.</p>
</div>
<div class="paragraph">
<p>If it is desired, e.g. for a proof of concept, to provide already activated forging delegates inside the config, use the devnet genesis delegates in <a href="https://github.com/LiskHQ/lisk-sdk/blob/development/sdk/src/samples/config_devnet.json">configDevnet</a> or create own genesis delegates and add them to the config.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_publish_the_application"><a class="anchor" href="#_publish_the_application"></a>2.3. Publish the application</h3>
<div class="paragraph">
<p>Add the code for the customized <code>node</code> application (including the custom transaction types) to a public code repository on e.g. <a href="https://github.com/">Github</a> or <a href="https://about.gitlab.com/">Gitlab</a>.</p>
</div>
<div class="paragraph">
<p>This gives everyone the opportunity to download the application and deploy it on a server in order to connect with the network.</p>
</div>
<div class="paragraph">
<p>The code should include at least the following files:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/LiskHQ/lisk-sdk-examples/blob/development/transport/node/index.js">index.js</a> :  The code that initializes and starts the node application</p>
</li>
<li>
<p><a href="https://github.com/LiskHQ/lisk-sdk-examples/blob/development/transport/node/package.json">package.json</a>: A project file that lists all needed dependencies (this should include <code>lisk-sdk</code> as dependency)</p>
</li>
<li>
<p><a href="https://github.com/LiskHQ/lisk-sdk-examples/tree/development/transport/transactions">transactions/</a>: A folder with all required custom transaction types</p>
</li>
<li>
<p><code>README</code> : A Readme which describes the most important steps to setup the node</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_connect_nodes_and_verify"><a class="anchor" href="#_connect_nodes_and_verify"></a>2.4. Connect nodes and verify</h3>
<div class="paragraph">
<p>Let&#8217;s now add a second node to the network.</p>
</div>
<div class="paragraph">
<p>This new node will not have any forging activated.
It will be only here to talk via API with the <code>client</code> app, and over the websocket connection to the seed node.
The seed node is therefore the only node right now that can forge new blocks, because all genesis delegates are actively forging on it.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
How to replace the genesis delegates with real delegates is covered in the next section <a href="#replace-delegates">Replace dummy delegates with real ones</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To set up the node, install the node application on a new server.
Just follow the instructions of the README, that was created in the step before.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Don&#8217;t forget to open the corresponding <a href="../configuration.html#_ports" class="page">ports</a> for HTTP and WS communication!
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Once a new node is set up, update the API endpoint in the <a href="https://github.com/LiskHQ/lisk-sdk-examples/blob/development/transport/client/app.js#L14">client</a> app, to target the new node:</p>
</div>
<div class="listingblock">
<div class="title">Snippet of client/app.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-js hljs" data-lang="js">// Constants
const API_BASEURL = 'http://134.209.234.204:4000'; <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Add here the correct IP and port to the newly added node.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If the client app has the API endpoint of the new node, it will receive transactions from the client.
The transactions will be visible in the logs (if log level is at least <code>info</code>).</p>
</div>
<div class="paragraph">
<div class="title">Logs of newly added node</div>
<p><span class="image"><img src="../_images/synching_node.png" alt="Synching non forging node"></span></p>
</div>
<div class="paragraph">
<p>The logs above show that the seed node was already 3 blocks ahead when the second node was started.
It first synchronizes the missing blocks up to the current height and then broadcasts the received transactions from the client app to the seed node, where delegates can add the transactions to blocks and forge them.</p>
</div>
<div class="paragraph">
<p>These new blocks are broadcasted again to the new node, and the client app can display the data based on the API calls that it sends to the new node.</p>
</div>
<div class="paragraph">
<div class="title">Log of the seed node with the forging genesis delegates</div>
<p><span class="image"><img src="../_images/forging_node.png" alt="Forging node logs"></span></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Broadcast errors can happen</div>
<div class="paragraph">
<p>Sometimes there can be errors when broadcasting transactions between nodes.
This is no need to worry!
The node will start the sync process soon again, and most times it is successful on the next try.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../_images/common-sync-issue.png" alt="Common sync issue"></span></p>
</div>
<div class="paragraph">
<p>In the above image the block at height 284 is not accepted because of an invalid block timestamp.
As a result, also the following blocks are discarded by the node as well.</p>
</div>
<div class="paragraph">
<p>Hick ups like this can happen in the network.
The node can resolve these issues at most times on its own by starting a new sync process, where it requests the missing blocks from one of its' peer nodes.</p>
</div>
<div class="paragraph">
<p>Like shown in the logs, the blocks at height 284, 285 and 286 are discarded.
Then, the node realizes it is not in sync with the other nodes and starts the sync process, indicated by the logs <code>Starting sync</code>.
During the sync process the missing blocks are received from the peers and added to the database of the node.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="replace-delegates"><a class="anchor" href="#replace-delegates"></a>3. Replace dummy delegates with real ones</h2>
<div class="sectionbody">
<div class="paragraph">
<p>During development of the Lisk Transport application there was one node with enabled forging for all 101 genesis delegates.</p>
</div>
<div class="paragraph">
<p>After releasing a first version the blockchain application, it is needed that real delegates take the forging slots of the genesis delegates.
The network will become stable and decentralized for the first time, when at least 51 real delegates are actively forging in the network.</p>
</div>
<div class="paragraph">
<p>To join the network as a new delegate:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create an own, private account on the network</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p><a href="../lisk-commander/user-guide/commands.html#_create_account" class="page">Generate the account credentials</a></p>
</li>
<li>
<p>Send some funds(at least enough to register as a delegate) to the newly generated address, to initialize your account in the network.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Register a delegate</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p><a href="../lisk-commander/user-guide/commands.html#_delegate_registration_transaction" class="page">Generate the delegate registration object</a>.</p>
</li>
<li>
<p>Broadcast the delegate registration to the network:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">lisk transaction:create:delegate lightcurve | tee &gt;(curl -X POST -H "Content-Type: application/json" -d @- 1.2.3.4:4000/api/transactions) <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Replace <code>1.2.3.4</code> with the IP of a node with a public API.</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Set up a node: Follow the steps in the <code>README</code> of the app (Or see the Lisk tutorials, as this process is always basically the same)</p>
</li>
<li>
<p><a href="../../lisk-core/configuration.html#_enabledisable_forging" class="page">Enable forging for the newly created delegate on the node</a></p>
</li>
<li>
<p>Convince voters: People get convinced to vote for a delegate in the network, e.g. if the delegate is:</p>
<div class="ulist">
<ul>
<li>
<p>helpful</p>
</li>
<li>
<p>accountable</p>
</li>
<li>
<p>sharing rewards</p>
</li>
<li>
<p>offering useful services or tools</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="../_images/3-nodes.png" alt="3 nodes diagram"></span></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>How to replace a genesis delegate</p>
</div>
<div class="paragraph">
<p>If a delegate joins the network on a very early stage, she will probably replace one of the genesis delegates.
The genesis delegates are voted in by the genesis account, which holds all the tokens on the initial network start.
The genesis account votes with this tokens for the genesis delegates, in order to stabilize the network during the development.</p>
</div>
<div class="paragraph">
<p>So when replacing a genesis delegate, the new delegate will need to convince the person who controls the genesis account of the network, which will be most likely the app developer.</p>
</div>
<div class="paragraph">
<p>Later, when the majority of the existing tokens is distributed among the different private accounts, the new delegate needs to gain the trust of the community in order to be voted into a forging position.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_write_tests_for_custom_transactions"><a class="anchor" href="#_write_tests_for_custom_transactions"></a>4. Write tests for custom transactions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The more complex the logic inside the custom transaction types, the more comlicated it gets to verify, that the custom transaction logic is working as expected.</p>
</div>
<div class="paragraph">
<p>Therefore it is recommended to write <strong>unit tests</strong>, that verify the logic of the transaction type.</p>
</div>
<div class="paragraph">
<p>Especially for verifying the code of the <code>undoAsset()</code> function, it is convenient to write unit tests.
This is because the code in the <code>undoAsset</code> function is only executed, if the node discovers itself on a fork with the main chain.</p>
</div>
<div class="paragraph">
<p>To be on a fork means, the node added some different blocks to the chain than its peers.
In order to sync again with the network, it has to remove the blocks that are different and undo the transactions inside these blocks.
To undo the transaction, the <code>undoAsset()</code> function will be called of each transaction inside of the blocks that need to be discarded.</p>
</div>
<div class="paragraph">
<p>To test if the transaction is undone correctly, write a unit test like so:</p>
</div>
<div class="listingblock">
<div class="title">Example: Unit test for the undoAsset() function of the RegisterPacketTransaction</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-js hljs" data-lang="js">const RegisterPacketTransaction = require('../register-packet');
const transactions = require('@liskhq/lisk-transactions');
const { when } = require('jest-when');

const dateToLiskEpochTimestamp = date =&gt; (
    Math.floor(new Date(date).getTime() / 1000) - Math.floor(new Date(Date.UTC(2016, 4, 24, 17, 0, 0, 0)).getTime() / 1000)
);

describe('RegisterPacket Transaction', () =&gt; {
    let storeStub;
    beforeEach(() =&gt; {
        storeStub = {
            account: {
                get: jest.fn(),
                set: jest.fn(),
            },
        };
    });

    test('it should undo the state for register packet correctly', async () =&gt; {
        // Arrange
        const senderId = 'senderXYZ';
        const asset = {
            security: transactions.utils.convertLSKToBeddows('10'),
            minTrust: 0,
            postage: transactions.utils.convertLSKToBeddows('10'),
            packetId: 'not important',
        };

        const mockedPacketAccount = {
            address: 'xyz123',
        };
        const mockedSenderAccount = {
            address: 'abc123',
            balance: '10000000000', // 100 LSK
        };

        when(storeStub.account.get)
            .calledWith(asset.packetId)
            .mockReturnValue(mockedPacketAccount);

        when(storeStub.account.get)
            .calledWith(senderId)
            .mockReturnValue(mockedSenderAccount);

        // Act
        const tx = new RegisterPacketTransaction({
            senderId,
            asset,
            recipientId: 'xyzL',
            timestamp: dateToLiskEpochTimestamp(new Date()),
        });
        tx.undoAsset(storeStub);

        // Assert
        expect(storeStub.account.set).toHaveBeenNthCalledWith(
            1,
            mockedPacketAccount.address,
            {
                address: mockedPacketAccount.address,
                balance: 0,
                asset: null,
            }
        );

        expect(storeStub.account.set).toHaveBeenNthCalledWith(
            2,
            mockedSenderAccount.address,
            {
                address: mockedSenderAccount.address,
                balance: new transactions.utils.BigNum(mockedSenderAccount.balance).add(
                    new transactions.utils.BigNum(asset.postage)
                ).toString()
            }
        );
    });
});</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">What else needs to be tested?</dt>
<dd>
<p>Is writing unit tests really enough to ensure the functionality of a custom transaction type?<br>
<strong>Short answer: Unit tests are sufficient.</strong><br>
<strong>Explanation:</strong> You may wonder if it is required to write additional functional and integration tests.
Be aware, that the correct reading and writing of the data to the database is already part of the Lisk SDK software testing and therefore it is not needed to test it again for your new custom transaction type.
Therefore unit tests are generally sufficient to test the functionality of a custom transaction type.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_further_improvements"><a class="anchor" href="#_further_improvements"></a>5. Further improvements</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Connect more sensors to secure the travel of the packet, e.g. implement a <code>TemperatureAlarm</code> or <code>HumidityAlarm</code> analog to the <code>LightAlarm</code> transaction type.</p>
</div>
<div class="paragraph">
<p>Let the network know the current location of the packet by transmitting the GPS location in a certain time interval.</p>
</div>
</div>
</div>

</article>
<aside class="article-aside hidden" role="navigation">
    <h3 class="toc-title">On this page:</h3>
    <div id="article-toc"></div>
</aside>
</main>
</div>
<footer class="footer">
    <div class="footer__container">
        <div class="footer__copyright">
            <div class="institutional-links-2">
                <span class="institutional-links-2__item">Â© 2019 Lisk Foundation</span>
                <a class="institutional-links-2__item" href="https://lisk.io/terms-conditions" class="institutional-links-2-item">Terms & Conditions</a>
                <a class="institutional-links-2__item" href="https://lisk.io/privacy" class="institutional-links-2-item">Privacy Policy</a>
            </div>
            <p class="footer__copyright-text">Lisk is a foundation registered in Zug, Zwitserland
            </p>
        </div>
        <div class="footer__logo-container">
            <img src="../_/img/lisk-logo-light.svg" class="footer__lisk-logo"/>
        </div>
        <div class="community-section">
            <p class="community-section__text">Follow Lisk on: </p>
            <div class="community-section__icons">
                <a href="https://github.com/LiskHQ" target="_blank" class="footer__icon icon-github"></a>
                <a href="https://www.youtube.com/channel/UCuqpGfg_bOQ8Ja4pj811PWg/featured" target="_blank" class="footer__icon icon-youtube"></a>
                <a href="https://www.reddit.com/r/Lisk/" target="_blank" class="footer__icon icon-reddit"></a>
                <a href="https://www.linkedin.com/company/lisk/" target="_blank" class="footer__icon icon-linkedin"></a>
                <a href="https://twitter.com/LiskHQ" target="_blank" class="footer__icon icon-twitter"></a>
                <a href="https://www.facebook.com/LiskHQ" target="_blank" class="footer__icon icon-facebook"></a>
            </div>
        </div>
    </div>
</footer>
<script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.10.0/tocbot.min.js"></script>
<script src="../../_/js/site.js"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
<script async src="../../_/js/vendor/tabs-block-behaviour.js"></script>
<script>
    tocbot.init( {
        tocSelector: '#article-toc',
        contentSelector: 'article',
        headingSelector: 'h1, h2, h3',
        collapseDepth: 6,
        positionFixedSelector: null,
        scrollSmooth: false
    } );
    var tocList = document.getElementById( 'article-toc' ).getElementsByClassName( 'toc-list' );
    if ( tocList && tocList.length > 0 && tocList[0].childNodes.length > 0 ) {
        document.getElementById( 'article-toc' ).parentNode.classList.remove( 'hidden' );
    }
</script>
  </body>
</html>
