!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).mediumZoom=t()}(this,function(){"use strict";function t(e){return"IMG"===e.tagName}function L(e){return e&&1===e.nodeType}function H(e){return".svg"===(e.currentSrc||e.src).substr(-4).toLowerCase()}function u(e){try{return Array.isArray(e)?e.filter(t):NodeList.prototype.isPrototypeOf(e)?[].slice.call(e).filter(t):L(e)?[e].filter(t):"string"==typeof e?[].slice.call(document.querySelectorAll(e)).filter(t):[]}catch(e){throw new TypeError("The provided selector is invalid.\nExpects a CSS selector, a Node element, a NodeList or an array.\nSee: https://github.com/francoischalifour/medium-zoom")}}function C(e,t){var o=O({bubbles:!1,cancelable:!1,detail:void 0},t);if("function"==typeof window.CustomEvent)return new CustomEvent(e,o);var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,o.bubbles,o.cancelable,o.detail),n}var O=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e};return function(e,t){void 0===t&&(t={});var o,n,i=t.insertAt;"undefined"!=typeof document&&(o=document.head||document.getElementsByTagName("head")[0],(n=document.createElement("style")).type="text/css","top"===i&&o.firstChild?o.insertBefore(n,o.firstChild):o.appendChild(n),n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e)))}(".medium-zoom-overlay{position:fixed;top:0;right:0;bottom:0;left:0;opacity:0;transition:opacity .3s;will-change:opacity}.medium-zoom--opened .medium-zoom-overlay{cursor:pointer;cursor:zoom-out;opacity:1}.medium-zoom-image{cursor:pointer;cursor:zoom-in;transition:transform .3s cubic-bezier(.2,0,.2,1)!important}.medium-zoom-image--hidden{visibility:hidden}.medium-zoom-image--opened{position:relative;cursor:pointer;cursor:zoom-out;will-change:transform}"),function e(t,o){function n(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];var i=t.reduce(function(e,t){return[].concat(e,u(t))},[]);return i.filter(function(e){return-1===h.indexOf(e)}).forEach(function(e){h.push(e),e.classList.add("medium-zoom-image")}),a.forEach(function(e){var t=e.type,o=e.listener,n=e.options;i.forEach(function(e){e.addEventListener(t,o,n)})}),w}function i(){function f(){var e,t,o,n,i,d={width:document.documentElement.clientWidth,height:document.documentElement.clientHeight,left:0,top:0,right:0,bottom:0},r=void 0,m=void 0;b.container&&(b.container instanceof Object?(r=(d=O({},d,b.container)).width-d.left-d.right-2*b.margin,m=d.height-d.top-d.bottom-2*b.margin):(t=(e=(L(b.container)?b.container:document.querySelector(b.container)).getBoundingClientRect()).width,o=e.height,n=e.left,i=e.top,d=O({},d,{width:t,height:o,left:n,top:i}))),r=r||d.width-2*b.margin,m=m||d.height-2*b.margin;var a=E.zoomedHd||E.original,c=!H(a)&&a.naturalWidth||r,l=!H(a)&&a.naturalHeight||m,u=a.getBoundingClientRect(),s=u.top,f=u.left,p=u.width,g=u.height,h=Math.min(c,r)/p,v=Math.min(l,m)/g,z=Math.min(h,v),y="scale("+z+") translate3d("+((r-p)/2-f+b.margin+d.left)/z+"px, "+((m-g)/2-s+b.margin+d.top)/z+"px, 0)";E.zoomed.style.transform=y,E.zoomedHd&&(E.zoomedHd.style.transform=y)}var p=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).target;return new r(function(t){if(p&&-1===h.indexOf(p))t(w);else if(E.zoomed)t(w);else{if(p)E.original=p;else{if(!(0<h.length))return void t(w);E.original=h[0]}var e,o,n;E.original.dispatchEvent(C("medium-zoom:open",{detail:{zoom:w}})),z=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,v=!0,E.zoomed=(i=E.original,d=i.getBoundingClientRect(),r=d.top,m=d.left,a=d.width,c=d.height,l=i.cloneNode(),u=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,s=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0,l.removeAttribute("id"),l.style.position="absolute",l.style.top=r+u+"px",l.style.left=m+s+"px",l.style.width=a+"px",l.style.height=c+"px",l.style.transform="",l),document.body.appendChild(y),b.template&&(e=L(b.template)?b.template:document.querySelector(b.template),E.template=document.createElement("div"),E.template.appendChild(e.content.cloneNode(!0)),document.body.appendChild(E.template)),document.body.appendChild(E.zoomed),window.requestAnimationFrame(function(){document.body.classList.add("medium-zoom--opened")}),E.original.classList.add("medium-zoom-image--hidden"),E.zoomed.classList.add("medium-zoom-image--opened"),E.zoomed.addEventListener("click",g),E.zoomed.addEventListener("transitionend",function e(){v=!1,E.zoomed.removeEventListener("transitionend",e),E.original.dispatchEvent(C("medium-zoom:opened",{detail:{zoom:w}})),t(w)}),E.original.getAttribute("data-zoom-src")?(E.zoomedHd=E.zoomed.cloneNode(),E.zoomedHd.removeAttribute("srcset"),E.zoomedHd.removeAttribute("sizes"),E.zoomedHd.src=E.zoomed.getAttribute("data-zoom-src"),E.zoomedHd.onerror=function(){clearInterval(o),console.warn("Unable to reach the zoom image target "+E.zoomedHd.src),E.zoomedHd=null,f()},o=setInterval(function(){E.zoomedHd.complete&&(clearInterval(o),E.zoomedHd.classList.add("medium-zoom-image--opened"),E.zoomedHd.addEventListener("click",g),document.body.appendChild(E.zoomedHd),f())},10)):E.original.hasAttribute("srcset")?(E.zoomedHd=E.zoomed.cloneNode(),E.zoomedHd.removeAttribute("sizes"),E.zoomedHd.removeAttribute("loading"),n=E.zoomedHd.addEventListener("load",function(){E.zoomedHd.removeEventListener("load",n),E.zoomedHd.classList.add("medium-zoom-image--opened"),E.zoomedHd.addEventListener("click",g),document.body.appendChild(E.zoomedHd),f()})):f()}var i,d,r,m,a,c,l,u,s})}var d=1<arguments.length&&void 0!==o?o:{},r=window.Promise||function(e){function t(){}e(t,t)},g=function(){return new r(function(t){!v&&E.original?(v=!0,document.body.classList.remove("medium-zoom--opened"),E.zoomed.style.transform="",E.zoomedHd&&(E.zoomedHd.style.transform=""),E.template&&(E.template.style.transition="opacity 150ms",E.template.style.opacity=0),E.original.dispatchEvent(C("medium-zoom:close",{detail:{zoom:w}})),E.zoomed.addEventListener("transitionend",function e(){E.original.classList.remove("medium-zoom-image--hidden"),document.body.removeChild(E.zoomed),E.zoomedHd&&document.body.removeChild(E.zoomedHd),document.body.removeChild(y),E.zoomed.classList.remove("medium-zoom-image--opened"),E.template&&document.body.removeChild(E.template),v=!1,E.zoomed.removeEventListener("transitionend",e),E.original.dispatchEvent(C("medium-zoom:closed",{detail:{zoom:w}})),E.original=null,E.zoomed=null,E.zoomedHd=null,E.template=null,t(w)})):t(w)})},m=function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).target;return E.original?g():i({target:e})},h=[],a=[],v=!1,z=0,b=d,E={original:null,zoomed:null,zoomedHd:null,template:null};"[object Object]"===Object.prototype.toString.call(t)?b=t:!t&&"string"!=typeof t||n(t),b=O({margin:0,background:"#fff",scrollOffset:40,container:null,template:null},b);var c,l,y=(c=b.background,(l=document.createElement("div")).classList.add("medium-zoom-overlay"),l.style.background=c,l);document.addEventListener("click",function(e){var t=e.target;t!==y?-1!==h.indexOf(t)&&m({target:t}):g()}),document.addEventListener("keyup",function(e){var t=e.key||e.keyCode;"Escape"!==t&&"Esc"!==t&&27!==t||g()}),document.addEventListener("scroll",function(){var e;!v&&E.original&&(e=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,Math.abs(z-e)>b.scrollOffset&&setTimeout(g,150))}),window.addEventListener("resize",g);var w={open:i,close:g,toggle:m,update:function(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},o=t;return t.background&&(y.style.background=t.background),t.container&&t.container instanceof Object&&(o.container=O({},b.container,t.container)),t.template&&(e=L(t.template)?t.template:document.querySelector(t.template),o.template=e),b=O({},b,o),h.forEach(function(e){e.dispatchEvent(C("medium-zoom:update",{detail:{zoom:w}}))}),w},clone:function(){return e(O({},b,0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}))},attach:n,detach:function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];E.zoomed&&g();var n=0<t.length?t.reduce(function(e,t){return[].concat(e,u(t))},[]):h;return n.forEach(function(e){e.classList.remove("medium-zoom-image"),e.dispatchEvent(C("medium-zoom:detach",{detail:{zoom:w}}))}),h=h.filter(function(e){return-1===n.indexOf(e)}),w},on:function(t,o){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};return h.forEach(function(e){e.addEventListener("medium-zoom:"+t,o,n)}),a.push({type:"medium-zoom:"+t,listener:o,options:n}),w},off:function(t,o){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};return h.forEach(function(e){e.removeEventListener("medium-zoom:"+t,o,n)}),a=a.filter(function(e){return!(e.type==="medium-zoom:"+t&&e.listener.toString()===o.toString())}),w},getOptions:function(){return b},getImages:function(){return h},getZoomedImage:function(){return E.original}};return w}});