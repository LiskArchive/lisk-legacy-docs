<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Test transaction types :: Docs</title>
    <link rel="canonical" href="https://lisk.io/documentation/lisk-sdk/guides/test.html">
    <meta name="description" content="The Lisk Documentation comprises guides, tutorials, technical references and in-depth explanations about the Lisk SDK, Lisk Core and the Lisk Protocol.">
    <meta name="generator" content="Antora 2.2.0">
    <link rel="stylesheet" href="../../_/css/site.css">
    <link rel="stylesheet" href="../../_/css/site-extra.css">
      <link rel="stylesheet" href="../../_/css/vendor/docsearch.min.css">
      <!-- fetched from https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css -->
    <link rel="icon" href="../../favicon.ico" type="image/x-icon">
    <script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
    <!--
    <link href="https://unpkg.com/primer/build/build.css" rel="stylesheet">
-->
<link rel="icon" href="/sites/default/files/favicons/favicon-32x32.png" type="image/png">
  </head>
  <body class="article">
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-NKNKGHL');</script>
<!-- End Google Tag Manager -->
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NKNKGHL"
                  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->

<header class="header">
  <nav class="navbar">
      <div class="navbar-content">
        <div class="navbar-brand">
          <a href="https://lisk.io" class="lisk-logo"></a>
            <span  class="nav-brand__name-area">
              <strong class="nav-brand__name-area__title">SDK Docs</strong>
                          </span>
          <button class="navbar-burger" data-target="topbar-nav">
            <span></span>
            <span></span>
            <span></span>
          </button>
        </div>
        <div id="topbar-nav" class="navbar-menu">
          <div class="navbar-end">
            <div class="navbar-item has-dropdown is-hoverable">
              <a class="navbar-link" href="">Docs</a>
              <div class="navbar-dropdown">
                <a class="navbar-item" href="https://lisk.io/documentation/lisk-sdk/">Lisk SDK</a>
                <a class="navbar-item" href="https://lisk.io/documentation/lisk-core/">Lisk Core</a>
              </div>
            </div>
              <div class="navbar-item has-dropdown is-hoverable">
                <a class="navbar-link" href="https://lisk.io/documentation/lisk-sdk/tutorials/index.html">Tutorials</a>
                <div class="navbar-dropdown">
                  <a class="navbar-item" href="https://lisk.io/documentation/lisk-sdk/tutorials/hello-world.html">Hello World</a>
                  <a class="navbar-item" href="https://lisk.io/documentation/lisk-sdk/tutorials/transport.html">Supply chain</a>
                </div>
              </div>
              <div class="navbar-item has-dropdown is-hoverable">
                <a class="navbar-link" href="https://lisk.io/documentation/lisk-sdk/guides/index.html">Guides</a>
                <div class="navbar-dropdown">
                  <a class="navbar-item" href="https://lisk.io/documentation/lisk-sdk/guides/configuration.html">Configure the blockchain application</a>
                  <a class="navbar-item" href="https://lisk.io/documentation/lisk-sdk/guides/customize.html">Create custom transaction types</a>
                  <a class="navbar-item" href="https://lisk.io/documentation/lisk-sdk/guides/test.html">Test transaction types</a>
                  <a class="navbar-item" href="https://lisk.io/documentation/lisk-sdk/guides/interact.html">Interact with the network</a>
                  <a class="navbar-item" href="https://lisk.io/documentation/lisk-sdk/guides/broadcast.html">Broadcast transactions</a>
                  <a class="navbar-item" href="https://lisk.io/documentation/lisk-sdk/guides/frontend.html">Connect a frontend</a>
                  <a class="navbar-item" href="https://lisk.io/documentation/lisk-sdk/guides/forging.html">Enable forging</a>
                  <a class="navbar-item" href="https://lisk.io/documentation/lisk-sdk/guides/launch.html">Launch the app</a>
                </div>
              </div>
              <div class="navbar-item has-dropdown is-hoverable">
                <a class="navbar-link" href="https://lisk.io/documentation/lisk-sdk/reference/index.html">Reference</a>
                <div class="navbar-dropdown">
                  <a class="navbar-item" href="https://lisk.io/documentation/lisk-sdk/reference/api.html">API specification</a>
                  <a class="navbar-item" href="https://lisk.io/documentation/lisk-sdk/reference/config.html">Config</a>
                  <a class="navbar-item" href="https://lisk.io/documentation/lisk-sdk/reference/lisk-elements">Lisk Elements</a>
                  <a class="navbar-item" href="https://lisk.io/documentation/lisk-sdk/reference/lisk-commander">Lisk Commander</a>
                  <a class="navbar-item" href="https://lisk.io/documentation/lisk-sdk/reference/lisk-framework">Lisk Framework</a>
                </div>
              </div>
                        <div class="navbar-item has-dropdown is-hoverable">
              <a class="navbar-link" href="">Resources</a>
              <div class="navbar-dropdown">
                <a class="navbar-item" href="https://lisk.io/roadmap"><i class="icofont-map-pins"></i>Roadmap</a>
                <a class="navbar-item" href="https://lisk.io/research"><i class="icofont-laboratory"></i>Research</a>
                <a class="navbar-item" href="https://lisk.io/blog"><i class="icofont-paper"></i>Blog</a>
                <a class="navbar-item" href="https://lisk.io/apps"><i class="icofont-dashboard-web"></i>Blockchain Apps List</a>
                <a class="navbar-item" href="https://lisk.io/builders-program"><i class="icofont-worker"></i>Lisk Builders Program</a>
                <a class="navbar-item" href="https://dev.lisk.io/"><i class="icofont-penguin-linux"></i>Dev Forum</a>
                <a class="navbar-item" href="https://lisk.io/community"><i class="icofont-people"></i>Community</a>
              </div>
            </div>
            <div class="navbar-item has-dropdown is-hoverable">
              <a class="navbar-link" href="">Explore</a>
              <div class="navbar-dropdown">
                <a class="navbar-item" target="_blank" href=""><strong>GitHub</strong></a>
                <a class="navbar-item" target="_blank" href="https://github.com/LiskHQ/lisk-sdk">Lisk SDK GitHub<i class="icofont-external-link"></i></a>
                <a class="navbar-item" target="_blank" href="https://github.com/LiskHQ/lisk-core">Lisk Core GitHub<i class="icofont-external-link"></i></a>
                <a class="navbar-item" target="_blank" href="https://github.com/LiskHQ/lisk-sdk-examples">Example Applications GitHub<i class="icofont-external-link"></i></a>
                <hr class="navbar-divider">
                <a class="navbar-item" target="_blank" href=""><strong>Blockchain Explorer</strong></a>
                <a class="navbar-item" target="_blank" href="https://testnet-explorer.lisk.io/">Testnet Explorer<i class="icofont-external-link"></i></a>
                <a class="navbar-item" target="_blank" href="https://explorer.lisk.io/">Mainnet Explorer<i class="icofont-external-link"></i></a>
                <a class="navbar-item" target="_blank" href="https://betanet-explorer.lisk.io/">Betanet Explorer<i class="icofont-external-link"></i></a>
              </div>
            </div>
          </div>
            <div class="navbar-menu">
              <div class="navbar-item hide-for-print">
                <input id="search-input" type="text" placeholder="Search docs">
              </div>
            </div>
        </div>
      </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="lisk-sdk" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">Lisk SDK</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../setup.html">Prerequisites</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="index.html">Guides</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="configuration.html">Configure the blockchain application</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="customize.html">Create custom transaction types</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="test.html">Test transaction types</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="interact.html">Interact with the network</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="broadcast.html">Broadcast transactions</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="frontend.html">Connect a frontend</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="forging.html">Enable forging</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="launch.html">Launch the app</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../best-practices.html">Best practices</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../tutorials/index.html">Tutorials</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../tutorials/hello-world.html">Hello world</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../tutorials/transport.html">Supply chain</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../tutorials/transport0.html">Part 0: Installation &amp; setup</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../tutorials/transport1.html">Part 1: Track a packet on the blockchain</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../tutorials/transport2.html">Part 2: A simple supply chain management system</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../tutorials/transport3.html">Part 3: How to publish the application</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../reference/index.html">Reference</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../reference/api.html">API specification</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../reference/config.html">Configuration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../reference/changelog.html">Developer changelog</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../reference/lisk-commander/index.html">Lisk Commander</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#reference/lisk-commander/user-guide/commands.adoc">Commands</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#reference/lisk-commander/user-guide/lisk-core.adoc">Lisk Core commands</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#reference/lisk-commander/user-guide/sensitive-inputs.adoc">Sensitive inputs</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../reference/lisk-elements/index.html">Lisk Elements</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="#reference/lisk-elements/packages/api-client.adoc">API client</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="#reference/lisk-elements/packages/api-client/accounts.adoc">Accounts</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="#reference/lisk-elements/packages/api-client/blocks.adoc">Blocks</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="#reference/lisk-elements/packages/api-client/dapps.adoc">DApps</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="#reference/lisk-elements/packages/api-client/delegates.adoc">Delegates</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="#reference/lisk-elements/packages/api-client/node.adoc">Node</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="#reference/lisk-elements/packages/api-client/peers.adoc">Peers</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="#reference/lisk-elements/packages/api-client/signatures.adoc">Signatures</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="#reference/lisk-elements/packages/api-client/transactions.adoc">Transactions</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="#reference/lisk-elements/packages/api-client/voters.adoc">Voters</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="#reference/lisk-elements/packages/api-client/votes.adoc">Votes</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#reference/lisk-elements/packages/client.adoc">Client</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#reference/lisk-elements/packages/constants.adoc">Constants</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#reference/lisk-elements/packages/cryptography.adoc">Cryptography</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#reference/lisk-elements/packages/p2p.adoc">P2P</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#reference/lisk-elements/packages/passphrase.adoc">Passphrase</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#reference/lisk-elements/packages/transaction-pool.adoc">Transaction pool</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#reference/lisk-elements/packages/transactions.adoc">Transactions</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#reference/lisk-elements/packages/validator.adoc">Validator</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../reference/lisk-framework/index.html">Lisk Framework</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Lisk SDK</span>
    <span class="version">3.0.2 (latest)</span>
  </div>
  <ul class="components">
    <li class="component">
      <span class="title">Lisk Core</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../lisk-core/index.html">2.1.5 (latest)</a>
        </li>
        <li class="version">
          <a href="../../lisk-core/3.0.0/index.html">3.0.0-beta.0</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <span class="title">Lisk SDK</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">3.0.2 (latest)</a>
        </li>
        <li class="version">
          <a href="../2.3.7/index.html">2.3.7</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main>
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Lisk SDK</a></li>
    <li><a href="index.html">Guides</a></li>
    <li><a href="test.html">Test transaction types</a></li>
  </ul>
</nav>
<button class="toc-toggle"></button>
<div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">3.0.2 (latest)</button>
  <div class="version-menu">
    <a class="version is-current" href="test.html">3.0.2 (latest)</a>
    <a class="version is-missing" href="../2.3.7/index.html">2.3.7</a>
  </div>
</div>
  <div class="edit-this-page"><a href="https://github.com/LiskHQ/lisk-docs/edit/484-restructure-elements-commander/modules/ROOT/pages/guides/test.adoc">Edit this Page</a></div>
  </div>
<article class="doc">
<h1 class="page">Test transaction types</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>The more complex the logic inside the custom transaction types, the more complicated it becomes to verify that the custom transaction logic is working as expected.</p>
</div>
<div class="paragraph">
<p>Therefore it is recommended to write <a href="https://en.wikipedia.org/wiki/Unit_testing">unit tests</a>, that verify the logic of the transaction type.</p>
</div>
<div class="paragraph">
<p>Especially for verifying the code of the <code>undoAsset()</code> function, it is convenient to write unit tests.
This is due to the fact that the code in the <code>undoAsset()</code> function is only executed if the node discovers itself on a fork with the main chain.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>To be on a <strong>fork</strong> means that the node added some different blocks to the chain than its peers.
In order to sync again with the network, it has to remove the blocks that are different, and undo the transactions inside these blocks.
To undo the transaction, the <code>undoAsset()</code> function will be called for each transaction inside of the blocks that need to be reverted.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To explain how to write unit tests for custom transactions, we will use the example of the <code>undoAsset()</code> method of the <a href="../tutorials/transport2.html#register_packet" class="page">supply chain tutorial: RegisterPacketTransaction</a>.
You can use it as template to write unit tests for your own custom transactions.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
To test the complete logic of a custom transaction, it is required to write unit tests for all methods that are implemented in the custom transactions: <code>validateAsset()</code>, <code>applyAsset()</code> and <code>undoAsset()</code>.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_write_a_test_script"><a class="anchor" href="#_write_a_test_script"></a>Write a test script</h2>
<div class="sectionbody">
<div class="paragraph">
<p>First, let&#8217;s look at the <code>undoAsset()</code> function of the <a href="https://github.com/LiskHQ/lisk-sdk-examples/blob/development/transport/transactions/solutions/register-packet.js#L144">RegisterPacketTransaction</a>.</p>
</div>
<div class="listingblock">
<div class="title">Snippet of undoAsset(), File: transactions/solutions/register-packet.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-js hljs" data-lang="js">undoAsset(store) {
    const errors = [];

    /* The postage is added back to the senders' account balance. */
    const sender = store.account.get(this.senderId);
    const senderBalanceWithPostage = new utils.BigNum(sender.balance).add(
        new utils.BigNum(this.asset.postage)
    );
    const updatedSender = {
        ...sender,
        balance: senderBalanceWithPostage.toString()
    };
    store.account.set(sender.address, updatedSender);

    /* The postage is removed from the packet account balance, and packet data in the asset is nullified */
    const packet = store.account.get(this.asset.packetId);
    const originalPacketAccount = { ...packet, balance: 0, asset: null };
    store.account.set(packet.address, originalPacketAccount);

    return errors;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>To test, that the <code>undoAsset()</code> function is working as expected, write a unit test with <a href="https://jestjs.io/docs/en/getting-started">jest</a>: <a href="https://github.com/LiskHQ/lisk-sdk-examples/blob/development/transport/transactions/test/register-packet.test.js">register-packet.test.js</a>:</p>
</div>
<div class="listingblock">
<div class="title">File: transactions/tests/register-packet.test.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-js hljs" data-lang="js">const RegisterPacketTransaction = require('../solutions/register-packet');
const transactions = require('@liskhq/lisk-transactions');
const { when } = require('jest-when');

describe('RegisterPacket Transaction', () =&gt; {
    let storeStub;
    beforeEach(() =&gt; {
        storeStub = { <i class="conum" data-value="1"></i><b>(1)</b>
            account: {
                get: jest.fn(),
                set: jest.fn(),
            },
        };
    });

    test('it should undo the state for register packet correctly', async () =&gt; { <i class="conum" data-value="2"></i><b>(2)</b>
        // Arrange
        const senderId = '16313739661670634666L';
        const senderPublicKey = 'c094ebee7ec0c50ebee32918655e089f6e1a604b83bcaa760293c61e0f18ab6f';
        const asset = {
            security: transactions.utils.convertLSKToBeddows('10'),
            minTrust: 0,
            postage: transactions.utils.convertLSKToBeddows('10'),
            packetId: 'not important',
            recipientId: 'xyzL',
        };

        const mockedPacketAccount = {
            address: 'xyz123',
        };
        const mockedSenderAccount = {
            address: 'abc123',
            balance: '10000000000', // 100 LSK
        };

        when(storeStub.account.get) <i class="conum" data-value="3"></i><b>(3)</b>
            .calledWith(asset.packetId)
            .mockReturnValue(mockedPacketAccount);

        when(storeStub.account.get) <i class="conum" data-value="4"></i><b>(4)</b>
            .calledWith(senderId)
            .mockReturnValue(mockedSenderAccount);

        // Act
        const tx = new RegisterPacketTransaction({ <i class="conum" data-value="5"></i><b>(5)</b>
            senderId,
            senderPublicKey,
            asset,
        });
        tx.undoAsset(storeStub); <i class="conum" data-value="6"></i><b>(6)</b>

        // Assert
        expect(storeStub.account.set).toHaveBeenNthCalledWith( <i class="conum" data-value="7"></i><b>(7)</b>
            1,
            mockedSenderAccount.address,
            {
                address: mockedSenderAccount.address,
                balance: new transactions.utils.BigNum(mockedSenderAccount.balance).add(
                    new transactions.utils.BigNum(asset.postage)
                ).toString()
            }
        );

        expect(storeStub.account.set).toHaveBeenNthCalledWith(
            2,
            mockedPacketAccount.address,
            {
                address: mockedPacketAccount.address,
                balance: 0,
                asset: null,
            }
        );
    });
});</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>get()</code> and <code>set()</code> functions of the <code>stateStore</code> are mocked by creating <a href="https://en.wikipedia.org/wiki/Test_stub">stubs</a> in the <code>beforeEach()</code> function.
This allows replace the call with a custom return value.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Now start the test, add a short and precise description of what the test is about.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>When <code>storeStub.account.get</code> is called with <code>asset.senderId</code>, we replace the return value with the <code>mockedSenderAccount</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>When <code>storeStub.account.get</code> is called with <code>asset.packetId</code>, we replace the return value with the <code>mockedPacketAccount</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>A new transaction is created.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>The <code>undoAsset()</code> function of the transaction is called, and the previousely defined <code>storeStub</code> is passed to the <code>undoAsset()</code> function.</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>The actual tests start here.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The first expectation verifies that the sender account got reimbursed for the postage he paid.
Therefore, we check if <code>storeStub.account.set()</code> got called with the right parameters:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-js hljs" data-lang="js">address: mockedSenderAccount.address,</code></pre>
</div>
</div>
<div class="paragraph">
<p>and</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-js hljs" data-lang="js">balance: new transactions.utils.BigNum(mockedSenderAccount.balance).add(
    new transactions.utils.BigNum(asset.postage)
).toString()</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the function got called with the expected parameters, we know that the sender account got restored correctly.</p>
</div>
<div class="paragraph">
<p>In the second expectation, we want to verify if the <code>const asset = { … }</code>, which stores the packet data, got nullified.
Secondly we want to verify, that the postage is removed from the packet balance.
Therefore, we first check if <code>storeStub.account.set()</code> got called with the right parameters:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-js hljs" data-lang="js">mockedPacketAccount.address,</code></pre>
</div>
</div>
<div class="paragraph">
<p>and</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-js hljs" data-lang="js">{
      address: mockedPacketAccount.address,
      balance: 0,
      asset: null,
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the function got called with the expected parameters, we know that the packet account was undone correctly.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_run_the_test_script"><a class="anchor" href="#_run_the_test_script"></a>Run the test script</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To run the test from the command-line, install <a href="https://jestjs.io/docs/en/getting-started">jest</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">npm install jest --global</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now, run the test:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">jest register-packet.test.js</code></pre>
</div>
</div>
<div class="paragraph">
<p>It should print the test results.
For example:</p>
</div>
<div class="literalblock">
<div class="content">
<pre> PASS  register-packet.test.js
  RegisterPacket Transaction
    ✓ it should undo the state for register packet correctly (13ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        2.017s
Ran all test suites matching /register-packet.test.js/i.</pre>
</div>
</div>
<div class="paragraph">
<p>In the example above, all expectations were met and the test passed.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_what_else_needs_to_be_tested"><a class="anchor" href="#_what_else_needs_to_be_tested"></a>What else needs to be tested?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Is writing unit tests really enough to ensure the functionality of a custom transaction type?</p>
</div>
<div class="paragraph">
<p><strong>Short answer: The unit tests are sufficient.</strong></p>
</div>
<div class="paragraph">
<p><strong>Explanation:</strong> You may wonder if it is required to write additional functional and integration tests.
Be aware, that the correct reading and writing of the data to the database is already part of the Lisk SDK software testing and therefore it is not needed to test it again for your new custom transaction type.
Therefore unit tests are generally sufficient to test the functionality of a custom transaction type.</p>
</div>
</div>
</div>
    <div class="bottom-links">
    <div>
      <a class="bottom-link" href="/documentation/lisk-sdk/guides/customize.html"><i class="icofont-double-left icofont-3x"></i>Create custom transaction types
    </a>
    </div><div>
      <a class="bottom-link" href="/documentation/lisk-sdk/guides/interact.html">Interact with the network<i class="icofont-double-right icofont-3x"></i>
      </a>
    </div>
  </div>






</article>
<aside class="article-aside hidden" role="navigation">
    <h3 class="toc-title">On this page:</h3>
    <div id="article-toc"></div>
</aside>


</main>
</div>
<footer class="footer">
    <div class="footer__container">
        <div class="footer__copyright">
            <div class="institutional-links-2">
                <span class="institutional-links-2__item">© 2020 Lisk Foundation</span>
                <a class="institutional-links-2__item" href="https://lisk.io/terms-conditions" class="institutional-links-2-item">Terms & Conditions</a>
                <a class="institutional-links-2__item" href="https://lisk.io/privacy" class="institutional-links-2-item">Privacy Policy</a>
            </div>
            <p class="footer__copyright-text">Lisk is a foundation registered in Zug, Switzerland
            </p>
        </div>
        <div class="footer__logo-container">
            <img src="../../_/img/lisk-logo-light.svg" class="footer__lisk-logo"/>
        </div>
        <div class="community-section">
            <p class="community-section__text">Follow Lisk on: </p>
            <div class="community-section__icons">
                <a href="https://github.com/LiskHQ" target="_blank" class="footer__icon icon-github"></a>
                <a href="https://www.youtube.com/channel/UCuqpGfg_bOQ8Ja4pj811PWg/featured" target="_blank" class="footer__icon icon-youtube"></a>
                <a href="https://www.reddit.com/r/Lisk/" target="_blank" class="footer__icon icon-reddit"></a>
                <a href="https://www.linkedin.com/company/lisk/" target="_blank" class="footer__icon icon-linkedin"></a>
                <a href="https://twitter.com/LiskHQ" target="_blank" class="footer__icon icon-twitter"></a>
                <a href="https://www.facebook.com/LiskHQ" target="_blank" class="footer__icon icon-facebook"></a>
            </div>
        </div>
    </div>
</footer>
<script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.10.0/tocbot.min.js"></script>
<script src="../../_/js/site.js"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
<script async src="../../_/js/vendor/tabs-block-behaviour.js"></script>
<script>
    tocbot.init( {
        tocSelector: '#article-toc',
        contentSelector: 'article',
        headingSelector: 'h1, h2, h3, h4, h5',
        collapseDepth: 3,
        positionFixedSelector: null,
        scrollSmooth: true,
        scrollSmoothDuration: 420
    } );
    var tocList = document.getElementById( 'article-toc' ).getElementsByClassName( 'toc-list' );
    if ( tocList && tocList.length > 0 && tocList[0].childNodes.length > 0 ) {
        document.getElementById( 'article-toc' ).parentNode.classList.remove( 'hidden' );
    }
</script>
  <script src="../../_/js/vendor/docsearch.min.js"></script>
  <!-- fetched from https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js -->
  <script>
    function focusSearchInput () { document.querySelector('#search-input').focus() }
    var search = docsearch({
        appId: 'C4SU57KGV9',
      apiKey: '55aa8709b04eb62f08f87571cf77547c',
      indexName: 'lisk-docs-search',
      inputSelector: '#search-input',
      autocompleteOptions: { hint: false, keyboardShortcuts: ['s'] },
      algoliaOptions: { hitsPerPage: 10 }
    }).autocomplete
    search.on('autocomplete:closed', function () { search.autocomplete.setVal() })
    focusSearchInput()
    window.addEventListener('load', focusSearchInput)
  </script>

  </body>
</html>
