<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Test a transaction :: Lisk documentation</title>
    <link rel="canonical" href="https://lisk.com/documentation/lisk-sdk/v4/guides/app-development/test-transaction.html">
    <link rel="prev" href="custom-transactions.html">
    <link rel="next" href="interact-with-api.html">
    <meta name="description" content="How to write and run a test script and test a custom transaction are described here, together with a unit test example.">
    <meta name="generator" content="Antora 3.1.1">

  <link id="theme" rel="stylesheet" title="Default" href="../../../../_/css/site.css">
  <link rel="stylesheet" title="Dark" href="../../../../_/css/dark-site.css">

    <script>var uiRootPath = '../../../../_'</script>
    <script src="../../../../_/js/vendor/medium-zoom.js"></script>
    <script type="text/javascript" id="Cookiebot" src="https://consent.cookiebot.com/uc.js" data-cbid="e4db29b5-cd94-4bcf-87e4-04f4ca564240" data-blockingmode="manual"></script>
    <!-- Matomo -->
    <script>
      var _paq = window._paq = window._paq || [];
      /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
      _paq.push(['trackPageView']);
      _paq.push(['enableLinkTracking']);
      (function() {
        var u="https://lisk.matomo.cloud/";
        _paq.push(['setTrackerUrl', u+'matomo.php']);
        _paq.push(['setSiteId', '2']);
        var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
        g.async=true; g.src='//cdn.matomo.cloud/lisk.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
      })();
    </script>
    <!-- End Matomo Code -->
    <!-- Matomo Tag Manager -->
    <script>
      var _mtm = window._mtm = window._mtm || [];
      _mtm.push({'mtm.startTime': (new Date().getTime()), 'event': 'mtm.Start'});
      var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
      g.async=true; g.src='https://cdn.matomo.cloud/lisk.matomo.cloud/container_RUW6y8yf.js'; s.parentNode.insertBefore(g,s);
    </script>
    <!-- End Matomo Tag Manager -->
<link rel="icon" href="../../../../_/img/favicon.png" type="image/x-icon">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <div class="top-logo">
        <a href="../../../.." class="lisk-logo"></a>
        <a href="../../../.." class="docs-logo"></a>
      </div>
      <!--<a class="navbar-item" href="https://lisk.com/documentation">Lisk documentation</a>-->
        <div id="docsearch" class="navbar-menu search-box hide-for-print">
          <!--<input id="search-input-toolbar" type="text" placeholder="Search me ...">-->
        </div>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">APIs</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="../../../../api/lisk-node-http.html">Lisk node HTTP API</a>
            <a class="navbar-item" href="../../../../api/lisk-node-rpc.html">Lisk node RPC API</a>
            <a class="navbar-item" href="../../../../api/lisk-service-http.html">Lisk Service HTTP API</a>
            <a class="navbar-item" href="../../../../api/lisk-service-rpc.html">Lisk Service RPC API</a>
            <a class="navbar-item" href="../../../../api/lisk-service-pubsub.html">Lisk Service Pub/Sub API</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Explorers</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://lisk.observer/" target="_blank">Lisk Observer</a>
            <a class="navbar-item" href="https://liskscan.com/" target="_blank">LiskScan</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Products</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="../../../../lisk-sdk/">Lisk SDK</a>
            <a class="navbar-item" href="../../../../lisk-service/">Lisk Service</a>
            <a class="navbar-item" href="../../../../lisk-core/">Lisk Core</a>
            <a class="navbar-item" href="https://lisk.com/wallet" target="_blank">Lisk Wallets</a>
          </div>
        </div>
        <button onclick="switch_style('toggle')" id="theme-toggle" class="theme-toggle navbar-item"></button>
        <!-- <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="#">Download</a>
          </span>
        </div> -->
      </div>
    </div>
  </nav>
</header>
<div class="toolbar" role="navigation">
  <button class="nav-toggle"></button>
  <div class="components-versions">
      <div class="page-components">
    <button class="component-menu-toggle" title="Show other documentations">Lisk SDK</button>
    <div class="component-menu">
        <a class="component" href="../../../../lisk-core/v2/index.html">Lisk Core</a>
        <a class="component" href="../../../../lisk-docs-manual/index.html">Lisk docs manual</a>
        <a class="component" href="../../../../beta/index.html">Lisk Documentation</a>
        <a class="component is-current" href="../../../v6/index.html">Lisk SDK</a>
        <a class="component" href="../../../../lisk-service/v0.7/index.html">Lisk Service</a>
    </div>
  </div>
    <span></span>
    <div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">4.0.0</button>
  <div class="version-menu">
    <a class="version is-missing" href="../../../v6/index.html">6.0.0 (beta)</a>
    <a class="version is-current" href="test-transaction.html">4.0.0</a>
    <a class="version" href="../../../v3/guides/app-development/test-transaction.html">3.0.2</a>
  </div>
</div>
  </div>
  <span></span>
  <span></span>
  <a href="../../../../beta/index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../index.html">Lisk SDK</a></li>
    <li><a href="../index.html">Guides</a></li>
    <li>Application development</li>
    <li><a href="test-transaction.html">Test a transaction</a></li>
  </ul>
</nav>
    <div id="docsearch-toolbar" class="search-box hide-for-print toolbar-search">
      <!--<input id="search-input" type="text" placeholder="Search me ...">-->
    </div>
  <div class="edit-this-page"><a href="https://github.com/LiskHQ/lisk-docs/edit/docs-sdk-4.0.0/modules/ROOT/pages/guides/app-development/test-transaction.adoc"><img class="pencil">Edit this Page</a></div>
  </div>
<div class="body">
<div class="nav-container" data-component="lisk-sdk" data-version="v4">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../../index.html">Lisk SDK</a></h3>
<ul class="nav-list">
  <li class="nav-item parent" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../setup.html">Prerequisites</a>
  </li>
  <li class="nav-item parent" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Explanations</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../explanations/consensus.html">Consensus in Lisk</a>
  </li>
</ul>
  </li>
  <li class="nav-item parent" data-depth="1">
    <button class="nav-item-toggle"></button>
        <span>
    <a class="nav-link" href="../index.html">Guides</a>
        </span>
<ul class="nav-list">
  <li class="nav-item parent" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Application development</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="configuration.html">Configure a blockchain application</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="custom-transactions.html">Create a custom transaction</a>
  </li>
  <li class="nav-item is-current-page" data-depth="3">
    <a class="nav-link" href="test-transaction.html">Test a transaction</a>
  </li>
  <li class="nav-item parent" data-depth="3">
    <button class="nav-item-toggle"></button>
        <span>
    <a class="nav-link" href="interact-with-api.html">Interact with the API</a>
        </span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="broadcast.html">Broadcast a transaction</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="frontend.html">Connect a frontend</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="launch.html">Launch a blockchain application</a>
  </li>
</ul>
  </li>
  <li class="nav-item parent" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Node management</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../node-management/managing-accounts.html">Managing accounts</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../node-management/forging.html">Enable forging</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../node-management/api-access.html">API access</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../node-management/enable-ssl.html">Enable SSL</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../node-management/logging.html">Logging</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item parent" data-depth="1">
    <button class="nav-item-toggle"></button>
        <span>
    <a class="nav-link" href="../../tutorials/index.html">Tutorials</a>
        </span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../tutorials/hello-world.html">Hello World</a>
  </li>
  <li class="nav-item parent" data-depth="2">
    <button class="nav-item-toggle"></button>
        <span>
    <a class="nav-link" href="../../tutorials/supply-chain/index.html">Supply Chain</a>
        </span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../tutorials/supply-chain/part1.html">Part 1: Installation &amp; setup</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../tutorials/supply-chain/part2.html">Part 2: Track a packet on the blockchain</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../tutorials/supply-chain/part3.html">Part 3: A simple supply chain management system</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../tutorials/supply-chain/part4.html">Part 4: How to publish the application</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item parent" data-depth="1">
    <button class="nav-item-toggle"></button>
        <span>
    <a class="nav-link" href="../../references/index.html">References</a>
        </span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../references/api-specification.html">API specification</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../references/config.html">Configuration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../references/changelog.html">ChangeLog 3.x to 4.x</a>
  </li>
  <li class="nav-item parent" data-depth="2">
    <button class="nav-item-toggle"></button>
        <span>
    <a class="nav-link" href="../../references/lisk-commander/index.html">Lisk Commander</a>
        </span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../references/lisk-commander/commands.html">Commands</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../references/lisk-commander/lisk-core-commands.html">Lisk Core commands</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../references/lisk-commander/sensitive-inputs.html">Sensitive inputs</a>
  </li>
</ul>
  </li>
  <li class="nav-item parent" data-depth="2">
    <button class="nav-item-toggle"></button>
        <span>
    <a class="nav-link" href="../../references/lisk-elements/index.html">Lisk Elements</a>
        </span>
<ul class="nav-list">
  <li class="nav-item parent" data-depth="3">
    <button class="nav-item-toggle"></button>
        <span>
    <a class="nav-link" href="../../references/lisk-elements/api-client.html">API client</a>
        </span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../references/lisk-elements/api-client/accounts.html">Accounts</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../references/lisk-elements/api-client/blocks.html">Blocks</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../references/lisk-elements/api-client/dapps.html">DApps</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../references/lisk-elements/api-client/delegates.html">Delegates</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../references/lisk-elements/api-client/node.html">Node</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../references/lisk-elements/api-client/peers.html">Peers</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../references/lisk-elements/api-client/transactions.html">Transactions</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../references/lisk-elements/api-client/voters.html">Voters</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../references/lisk-elements/api-client/votes.html">Votes</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../references/lisk-elements/bft.html">BFT</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../references/lisk-elements/chain.html">Chain</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../references/lisk-elements/client.html">Client</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../references/lisk-elements/constants.html">Constants</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../references/lisk-elements/cryptography.html">Cryptography</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../references/lisk-elements/dpos.html">DPoS</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../references/lisk-elements/p2p.html">P2P</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../references/lisk-elements/passphrase.html">Passphrase</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../references/lisk-elements/transaction-pool.html">Transaction pool</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../references/lisk-elements/transactions.html">Transactions</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../references/lisk-elements/validator.html">Validator</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../references/lisk-framework/index.html">Lisk Framework</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Lisk SDK</span>
    <span class="version">4.0.0</span>
  </div>
  <ul class="components">
    <li class="component">
      <a class="title" href="../../../../lisk-core/v2/index.html">Lisk Core</a>
      <ul class="versions">
        <li class="version">
          <a href="../../../../lisk-core/v4/index.html">4.0.0-beta.0</a>
        </li>
        <li class="version is-latest">
          <a href="../../../../lisk-core/v2/index.html">2.1.7</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../lisk-docs-manual/index.html">Lisk docs manual</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../lisk-docs-manual/index.html">0.1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../beta/index.html">Lisk Documentation</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../beta/index.html">beta</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <a class="title" href="../../../v6/index.html">Lisk SDK</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../v6/index.html">6.0.0 (beta)</a>
        </li>
        <li class="version is-current">
          <a href="../../index.html">4.0.0</a>
        </li>
        <li class="version">
          <a href="../../../v3/index.html">3.0.2</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../lisk-service/v0.7/index.html">Lisk Service</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../lisk-service/v0.7/index.html">0.7.0 (beta)</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Test a transaction</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>When the logic inside a custom transaction becomes more complex, it becomes complicated to verify that the custom transaction logic is working as expected.</p>
</div>
<div class="paragraph">
<p>Therefore it is recommended to write <a href="https://en.wikipedia.org/wiki/Unit_testing" target="_blank" rel="noopener">unit tests</a>, that verify the logic of the transaction.</p>
</div>
<div class="paragraph">
<p>Especially for verifying the code of the <code>undoAsset()</code> function, it is convenient to write unit tests.
This is due to the fact that the code in the <code>undoAsset()</code> function is only executed if the node discovers itself on a fork with the main chain.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>To be on a <strong>fork</strong> means that the node added some different blocks to the chain than its peers.
In order to sync again with the network, it has to remove the blocks that are different, and undo the transactions inside these blocks.
To undo the transaction, the <code>undoAsset()</code> function will be called for each transaction inside of the blocks that need to be reverted.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In order to explain how to write unit tests for custom transactions, the <code>applyAsset()</code> method of the <a href="../index.html#hello_world_app" class="xref page">Hello World app</a> is used here as example.
It can be used as a template to write unit tests for your own custom transactions.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
To test the complete logic of a custom transaction, it is required to write unit tests for all methods that are implemented in the custom transaction: <code>validateAsset()</code>, <code>applyAsset()</code> and <code>undoAsset()</code>.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="write-a-test-script"><a class="anchor" href="#write-a-test-script"></a>Write a test script</h2>
<div class="sectionbody">
<div class="paragraph">
<p>First, let&#8217;s look at the <code>applyAsset()</code> function of the <a href="https://github.com/LiskHQ/lisk-sdk-examples/blob/v4/hello_world/transactions/hello_transaction.js#L49" target="_blank" rel="noopener">HelloTransaction</a>.</p>
</div>
<div class="listingblock">
<div class="title">Snippet of undoAsset(), File: hello_world/transactions/hello_transaction.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-js hljs" data-lang="js">async applyAsset(store) {
    const errors = [];
    const sender = await store.account.get(this.senderId);
    if (sender.asset &amp;&amp; sender.asset.hello) {
        errors.push(
            new TransactionError(
                'You cannot send a hello transaction multiple times',
                sender.asset.hello,
                '.asset.hello',
                this.asset.hello
            )
        );
    } else {
        sender.asset = { hello: this.asset.hello };
        store.account.set(sender.address, sender);
    }
    return errors;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>To test that the <code>applyAsset()</code> function is working as expected, write a unit test as shown in the example here: <a href="https://github.com/LiskHQ/lisk-sdk-examples/blob/v4/hello_world/transactions/test/hello_transaction.test.js" target="_blank" rel="noopener">hello_transaction.test.js</a>:</p>
</div>
<div class="listingblock">
<div class="title">File: transactions/tests/hello_transaction.test.js</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-js hljs" data-lang="js">const HelloTransaction = require('../hello_transaction');
const { TransactionError } = require('@liskhq/lisk-transactions');
const { when } = require('jest-when');

describe('Hello Transaction', () =&gt; {
    let storeStub;
    beforeEach(() =&gt; {
        storeStub = { <i class="conum" data-value="1"></i><b>(1)</b>
            account: {
                get: jest.fn(),
                set: jest.fn(),
            },
        };
    });

    it('should save the hello string in the senders account assets', async () =&gt; { <i class="conum" data-value="2"></i><b>(2)</b>
        // Arrange
        const asset = {
            hello: 'my hello message',
        };

        const senderId = '16313739661670634666L';
        const senderPublicKey = 'c094ebee7ec0c50ebee32918655e089f6e1a604b83bcaa760293c61e0f18ab6f';
        const mockedSenderAccount = {
            address: '16313739661670634666L',
            publicKey: 'c094ebee7ec0c50ebee32918655e089f6e1a604b83bcaa760293c61e0f18ab6f',
            asset: {},
        };

        when(storeStub.account.get) <i class="conum" data-value="3"></i><b>(3)</b>
            .calledWith(senderId)
            .mockReturnValue(mockedSenderAccount);

        // Act
        const tx = new HelloTransaction({ <i class="conum" data-value="4"></i><b>(4)</b>
            senderPublicKey,
            asset,
        });
        await tx.applyAsset(storeStub); <i class="conum" data-value="5"></i><b>(5)</b>

        // Assert
        expect(storeStub.account.set).toHaveBeenCalledWith( <i class="conum" data-value="6"></i><b>(6)</b>
            mockedSenderAccount.address,
            {
                address: mockedSenderAccount.address,
                publicKey: mockedSenderAccount.publicKey,
                asset,
            }
        );

    });

    it('should reject the transaction, if the sender already has a hello string in their account.', async () =&gt; {
        // Arrange
        const asset = {
            hello: "my hello message",
        };
        const senderId = '16313739661670634666L';
        const senderPublicKey = 'c094ebee7ec0c50ebee32918655e089f6e1a604b83bcaa760293c61e0f18ab6f';
        const mockedSenderAccount = {
                address: '16313739661670634666L',
                publicKey: 'c094ebee7ec0c50ebee32918655e089f6e1a604b83bcaa760293c61e0f18ab6f',
                asset: {
                    hello: "Hello world!"
                }
            };
        const errors = [];
        errors.push(
            new TransactionError(
                'You cannot send a hello transaction multiple times',
                mockedSenderAccount.asset.hello,
                '.asset.hello',
                asset.hello
            )
        );

        when(storeStub.account.get)
            .calledWith(senderId)
            .mockReturnValue(mockedSenderAccount);

        // Act
        const tx = new HelloTransaction({
            senderPublicKey,
            asset,
        });

        const result = await tx.applyAsset(storeStub);

        // Assert
        expect(result).toMatchObject(errors);
    });
});</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>get()</code> and <code>set()</code> functions of the <code>stateStore</code> are mocked by creating <a href="https://en.wikipedia.org/wiki/Test_stub" target="_blank" rel="noopener">stubs</a> in the <code>beforeEach()</code> function.
Stubbing provides the opportunity to replace the call of a function with a custom return value.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Now the first test can begin, with a short and precise description of the actual test itself.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>When <code>storeStub.account.get</code> is called with <code>asset.senderId</code>,the return value is replaced with the <code>mockedSenderAccount</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>A new transaction is created.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>The <code>applyAsset()</code> function of the transaction is called, and the previously defined <code>storeStub</code> is passed to the <code>applyAsset()</code> function.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>The test passes if the function <code>storeStub.account.set()</code> is called with the expected parameters.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The first test verifies that the hello string is saved in the senders account assets.
Therefore, a check is performed to ensure that the <code>storeStub.account.set()</code> was called with the correct parameters:</p>
</div>
<div class="listingblock">
<div class="title">Sender address</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-js hljs" data-lang="js">mockedSenderAccount.address,</code></pre>
</div>
</div>
<div class="paragraph">
<p>and
.Updated sender account</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-js hljs" data-lang="js">{
    address: mockedSenderAccount.address,
    publicKey: 'c094ebee7ec0c50ebee32918655e089f6e1a604b83bcaa760293c61e0f18ab6f',
    asset,
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the function was called with the expected parameters, then this proves that the sender account was updated correctly.</p>
</div>
<div class="paragraph">
<p>In the second test it is necessary to verify that the transaction is rejected, in the case whereby the sender already has a hello string in their account.
Therefore, it is necessary to check if the expected <code>TransactionError</code> is returned when the <code>applyAsset()</code> is executed.</p>
</div>
<div class="listingblock">
<div class="title">Expected transaction error</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-js hljs" data-lang="js">new TransactionError(
    'You cannot send a hello transaction multiple times',
    mockedSenderAccount.asset.hello,
    '.asset.hello',
    asset.hello
)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="run-the-test-script"><a class="anchor" href="#run-the-test-script"></a>Run the test script</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To run the test from the command-line, install <a href="https://jestjs.io/docs/en/getting-started" target="_blank" rel="noopener">jest</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">npm install jest --global</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now, run the test:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">jest hello_transaction.test.js</code></pre>
</div>
</div>
<div class="paragraph">
<p>It should print the test results,
as shown in the example below:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>PASS  ./hello_transaction.test.js
  Hello Transaction
    ✓ should save the hello string in the senders account assets (10ms)
    ✓ should reject the transaction, if the sender already has a hello string in their account. (1ms)

Test Suites: 1 passed, 1 total
Tests:       2 passed, 2 total
Snapshots:   0 total
Time:        2.132s
Ran all test suites matching /hello_transaction.test.js/i.</pre>
</div>
</div>
<div class="paragraph">
<p>In the example shown above, all expectations were met and the test passed.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="what-else-needs-to-be-tested"><a class="anchor" href="#what-else-needs-to-be-tested"></a>What else needs to be tested?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Is writing unit tests really enough to ensure the functionality of a custom transaction?</p>
</div>
<div class="paragraph">
<p><strong>Short answer: The unit tests are sufficient.</strong></p>
</div>
<div class="paragraph">
<p><strong>Explanation:</strong> You may wonder if it is required to write additional functional and integration tests.
Be aware that the correct reading and writing of the data to the database is already part of the Lisk SDK software testing, and therefore it is not necessary to test it again for your new custom transaction.
Hence, unit tests are generally sufficient to test the functionality of a custom transaction.</p>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="custom-transactions.html">Create a custom transaction</a></span>
  <span class="next"><a href="interact-with-api.html">Interact with the API</a></span>
</nav>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <div class="footerdiv">
    <p>© 2022 Lisk Foundation</p>
    <!-- <div class="community-section">
      <p class="community-section__text">Follow Lisk on: </p>
      <div class="community-section__icons"> -->
    <div class="community_icons">
        <a href="https://lisk.chat" title="Discord" target="_blank" class="footer_icon icon-discord"><p>Discord</p></a>
        <a href="https://dev.lisk.com" title="Discourse" target="_blank" class="footer_icon icon-discourse"><p>Discourse</p></a>
        <a href="https://github.com/LiskHQ" title="GitHub" target="_blank" class="footer_icon icon-github"><p>GitHub</p></a>
  <!--    </div> -->
    </div>
  </div>
</footer>
<script src="../../../../_/js/site.js"></script>
<script async src="../../../../_/js/vendor/highlight.js"></script>
<script async src="../../../../_/js/vendor/tabs-block-behaviour.js"></script>
<script async src="../../../../_/js/vendor/swagger-ui.js"></script>
<script async src="../../../../_/js/vendor/component-versions.js"></script>
<script src="../../../../_/js/vendor/custom.js"></script>
  <script src="../../../../_/js/vendor/docsearch.js"></script>
  <!--<script src="../../../../_/js/vendor/docsearch.min.js"></script>-->
  <!--<script src="https://cdn.jsdelivr.net/npm/@docsearch/js@alpha"></script>-->
  <script>
    docsearch({
      container: '#docsearch',
        appId: 'C4SU57KGV9',
      apiKey: '55aa8709b04eb62f08f87571cf77547c',
      indexName: 'lisk-docs-search'
    });
    docsearch({
      container: '#docsearch-toolbar',
        appId: 'C4SU57KGV9',
      apiKey: '55aa8709b04eb62f08f87571cf77547c',
      indexName: 'lisk-docs-search'
    });
  </script>
  <!--<script>
    function focusSearchInput () { document.querySelector('#search-input').focus() }
    var search = docsearch({
        appId: 'C4SU57KGV9',
      apiKey: '55aa8709b04eb62f08f87571cf77547c',
      indexName: 'lisk-docs-search',
      inputSelector: '#search-input',
      autocompleteOptions: { hint: false, keyboardShortcuts: ['s'] },
      algoliaOptions: { hitsPerPage: 10 }
    }).autocomplete
    search.on('autocomplete:closed', function () { search.autocomplete.setVal() })
    focusSearchInput()
    window.addEventListener('load', focusSearchInput)
  </script>-->
<!--  <script>
    function focusSearchInputToolbar () { document.querySelector('#search-input-toolbar').focus() }
    var search = docsearch({
        appId: 'C4SU57KGV9',
      apiKey: '55aa8709b04eb62f08f87571cf77547c',
      indexName: 'lisk-docs-search',
      inputSelector: '#search-input-toolbar',
      autocompleteOptions: { hint: false, keyboardShortcuts: ['s'] },
      algoliaOptions: { hitsPerPage: 10 }
    }).autocomplete
    search.on('autocomplete:closed', function () { search.autocomplete.setVal() })
    focusSearchInputToolbar()
    window.addEventListener('load', focusSearchInputToolbar)
  </script>-->
  </body>
</html>
