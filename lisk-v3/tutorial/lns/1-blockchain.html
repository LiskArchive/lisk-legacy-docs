<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Chapter 1: Blockchain :: Lisk documentation</title>
    <link rel="canonical" href="https://liskhq.github.io/lisk-docs/tutorial/lns/1-blockchain.html">
    <link rel="prev" href="index.html">
    <link rel="next" href="2-frontend.html">
    <meta name="generator" content="Antora 3.1.1">

<link id="theme" rel="stylesheet" title="Default" href="../../../_/css/site.css">
<link rel="stylesheet" title="Dark" href="../../../_/css/dark-site.css">

<script>var uiRootPath = '../../../_'</script>
<script src="../../../_/js/vendor/medium-zoom.js"></script>
<script type="text/javascript" id="Cookiebot" src="https://consent.cookiebot.com/uc.js" data-cbid="e4db29b5-cd94-4bcf-87e4-04f4ca564240" data-blockingmode="manual"></script>
<!-- Matomo -->
<script>
  var _paq = window._paq = window._paq || [];
  /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="https://lisk.matomo.cloud/";
    _paq.push(['setTrackerUrl', u+'matomo.php']);
    _paq.push(['setSiteId', '2']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.async=true; g.src='//cdn.matomo.cloud/lisk.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
<!-- End Matomo Code -->
<!-- Matomo Tag Manager -->
<script>
  var _mtm = window._mtm = window._mtm || [];
  _mtm.push({'mtm.startTime': (new Date().getTime()), 'event': 'mtm.Start'});
  var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
  g.async=true; g.src='https://cdn.matomo.cloud/lisk.matomo.cloud/container_RUW6y8yf.js'; s.parentNode.insertBefore(g,s);
</script>
<!-- End Matomo Tag Manager -->
<link rel="icon" href="../../../_/img/favicon.png" type="image/x-icon">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <div class="top-logo">
        <a href="../../.." class="lisk-logo"></a>
        <a href="../../.." class="docs-logo"></a>
      </div>
      <!--<a class="navbar-item" href="https://liskhq.github.io/lisk-docs">Lisk documentation</a>-->
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">APIs</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="../../../api/lisk-node-rpc.html">Lisk node RPC API</a>
            <a class="navbar-item" href="../../../api/lisk-service-http.html">Lisk Service HTTP
              API</a>
            <a class="navbar-item" href="../../../api/lisk-service-rpc.html">Lisk Service RPC
              API</a>
            <a class="navbar-item" href="../../../api/lisk-service-pubsub.html">Lisk Service
              Pub/Sub API</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Explorers</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://lisk.observer/" target="_blank">Lisk Observer</a>
            <a class="navbar-item" href="https://liskscan.com/" target="_blank">LiskScan</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Products</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="../../../lisk-sdk/">Lisk SDK</a>
            <a class="navbar-item" href="../../../lisk-service/">Lisk Service</a>
            <a class="navbar-item" href="../../../lisk-core/">Lisk Core</a>
            <a class="navbar-item" href="https://lisk.com/wallet" target="_blank">Lisk Wallets</a>
          </div>
        </div>
        <button onclick="switch_style('toggle')" id="theme-toggle" class="theme-toggle navbar-item"></button>
        <!-- <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="#">Download</a>
          </span>
        </div> -->
      </div>
    </div>
  </nav>
</header>
<div class="toolbar" role="navigation">
  <button class="nav-toggle"></button>
  <div class="components-versions">
      <div class="page-components">
    <button class="component-menu-toggle" title="Show other documentations">Lisk Documentation</button>
    <div class="component-menu">
        <a class="component" href="../../../lisk-core/index.html">Lisk Core</a>
        <a class="component" href="../../../lisk-docs-manual/index.html">Lisk docs manual</a>
        <a class="component is-current" href="../../../index.html">Lisk Documentation</a>
        <a class="component" href="../../../lisk-sdk/index.html">Lisk SDK</a>
        <a class="component" href="../../../lisk-service/index.html">Lisk Service</a>
    </div>
  </div>
    <span></span>
    <div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">lisk-v3</button>
  <div class="version-menu">
    <a class="version" href="../../../tutorial/lns/1-blockchain.html">default</a>
    <a class="version is-current" href="1-blockchain.html">lisk-v3</a>
  </div>
</div>
  </div>
  <span></span>
  <span></span>
    <a href="../../../index.html" class="home-link"></a>
  <nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../index.html">Lisk Documentation</a></li>
    <li><a href="../index.html">Tutorials</a></li>
    <li><a href="index.html">Lisk Name Service (LNS) Tutorial</a></li>
    <li><a href="1-blockchain.html">Chapter 1: Blockchain</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/LiskHQ/lisk-docs/edit/docs-lisk-v3/docs/modules/ROOT/pages/tutorial/lns/1-blockchain.adoc">Edit this Page</a></div>
</div>

<div class="body">
<div class="nav-container" data-component="ROOT" data-version="lisk-v3">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../../index.html">Lisk Documentation</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../understand-blockchain/index.html">Understand Blockchain</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../understand-blockchain/architecture.html">SDK Architecture</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../understand-blockchain/block-life-cycle.html">Block life cycle</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../understand-blockchain/modules-assets.html">Modules and assets</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../understand-blockchain/plugins.html">Plugins</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../understand-blockchain/endpoints.html">RPC endpoints of a Lisk node</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../understand-blockchain/reducers.html">Reducers</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../understand-blockchain/codec-schema.html">Codec &amp; schema</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../understand-blockchain/lisk-protocol/index.html">Lisk Protocol</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../understand-blockchain/lisk-protocol/accounts.html">Accounts</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../understand-blockchain/lisk-protocol/blocks.html">Blocks</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../understand-blockchain/lisk-protocol/consensus-algorithm.html">Consensus algorithm</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../understand-blockchain/lisk-protocol/network.html">Network</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../understand-blockchain/lisk-protocol/transactions.html">Transactions</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../understand-blockchain/lisk-protocol/appendix.html">Appendix</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../build-blockchain/index.html">Build Blockchain</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../build-blockchain/create-blockchain-app.html">Creating a new blockchain application</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../build-blockchain/create-module.html">Creating a new module</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../build-blockchain/create-asset.html">Creating a new asset</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../build-blockchain/create-genesis-block.html">How to create a new genesis block</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../build-blockchain/create-plugin.html">Creating a new plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../build-blockchain/configure-app.html">How to configure a blockchain application</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../build-blockchain/test-app.html">Testing the blockchain application</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../build-blockchain/using-dashboard.html">Using dashboard with the blockchain application</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../build-blockchain/enable-faucet.html">How to enable a faucet for testing</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../build-blockchain/launch-test-network.html">Launching a public test network</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../run-blockchain/index.html">Run Blockchain</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../run-blockchain/account-management.html">Managing accounts</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../run-blockchain/forging.html">Enabling forging</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../run-blockchain/blockchain-reset.html">Resetting and snapshotting the blockchain</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../run-blockchain/forging-node-protection.html">Protecting a forging node</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../run-blockchain/non-forging-node-protection.html">Protecting a non-forging node</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../run-blockchain/logging.html">Managing logs</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../integrate-blockchain/index.html">Integrate Blockchain</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../integrate-blockchain/calculating-min-fee.html">Calculating the minimum fee for a transaction</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../integrate-blockchain/create-send-transactions.html">How to send a transaction to the network</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../integrate-blockchain/create-tx-offline.html">Creating transactions and signing them offline</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../integrate-blockchain/encode-decode.html">Decoding &amp; encoding data</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../integrate-blockchain/create-user-interface.html">Creating a user interface</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../index.html">Tutorials</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../nft.html">Non-fungible token (NFT) Tutorial</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../srs.html">Social Recovery System (SRS) Tutorial</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="index.html">Lisk Name Service (LNS) Tutorial</a>
<ul class="nav-list">
  <li class="nav-item is-current-page" data-depth="3">
    <a class="nav-link" href="1-blockchain.html">Chapter 1: Blockchain</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="2-frontend.html">Chapter 2: Frontend</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="3-cli.html">Chapter 3: CLI</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="4-tests.html">Chapter 4: Tests</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">APIs</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../api/lisk-node-http.html">HTTP API for Lisk nodes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../api/lisk-node-rpc.html">RPC API for Lisk nodes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../api/lisk-service-http.html">Mainnet HTTP API (Lisk Service)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../api/lisk-service-rpc.html">RPC endpoints (Lisk Service)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../api/lisk-service-pubsub.html">Publish/Subscribe API (Lisk Service)</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Products</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../lisk-sdk/v5/index.html">Lisk SDK</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../lisk-service/v0.6/index.html">Lisk Service</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../lisk-core/v3/index.html">Lisk Core</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../bug-bounty-program.html">Lisk Bug Bounty Program</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../glossary.html">Glossary</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Lisk Documentation</span>
    <span class="version">lisk-v3</span>
  </div>
  <ul class="components">
    <li class="component">
      <a class="title" href="../../../lisk-core/index.html">Lisk Core</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../lisk-core/index.html">4.0 (latest)</a>
        </li>
        <li class="version">
          <a href="../../../lisk-core/v3/index.html">3.1.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../lisk-docs-manual/index.html">Lisk docs manual</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../lisk-docs-manual/index.html">0.1.0</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <a class="title" href="../../../index.html">Lisk Documentation</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../index.html">default</a>
        </li>
        <li class="version is-current">
          <a href="../../index.html">lisk-v3</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../lisk-sdk/index.html">Lisk SDK</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../lisk-sdk/index.html">6.0 (latest)</a>
        </li>
        <li class="version">
          <a href="../../../lisk-sdk/v5/index.html">5.3.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../lisk-service/index.html">Lisk Service</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../lisk-service/index.html">0.7 (latest)</a>
        </li>
        <li class="version">
          <a href="../../../lisk-service/v0.6/index.html">0.6</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
      <h1 class="page">Chapter 1: Blockchain</h1>
    <div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#bootstrapping-the-default-application">1. Bootstrapping the default application</a></li>
<li><a href="#creating-the-lns-module-assets">2. Creating the LNS module assets</a>
<ul class="sectlevel2">
<li><a href="#register-domain">2.1. Register Domain</a>
<ul class="sectlevel3">
<li><a href="#schema">2.1.1. Schema</a></li>
<li><a href="#validation">2.1.2. Validation</a></li>
<li><a href="#state-change">2.1.3. State change</a></li>
<li><a href="#utility-functions">2.1.4. Utility functions</a>
<ul class="sectlevel4">
<li><a href="#getkeyfornodenode">getKeyForNode(node)</a></li>
<li><a href="#getnodefornamename">getNodeForName(name)</a></li>
<li><a href="#createlnsobjectstatestore-params">createLNSObject(stateStore, params)</a></li>
<li><a href="#getlnsobjectstatestore-node">getLNSObject(stateStore, node)</a></li>
</ul>
</li>
<li><a href="#schemas">2.1.5. Schemas</a>
<ul class="sectlevel4">
<li><a href="#lns-node-record-schema">LNS node record schema</a></li>
<li><a href="#lns-node-schema">LNS node schema</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#update-reverse-lookup">2.2. Update reverse lookup</a>
<ul class="sectlevel3">
<li><a href="#schema-2">2.2.1. Schema</a></li>
<li><a href="#state-change-2">2.2.2. State change</a></li>
</ul>
</li>
<li><a href="#update-records">2.3. Update records</a>
<ul class="sectlevel3">
<li><a href="#schema-3">2.3.1. Schema</a></li>
<li><a href="#validation-2">2.3.2. Validation</a></li>
<li><a href="#state-change-3">2.3.3. State change</a></li>
<li><a href="#utility-functions-2">2.3.4. Utility functions</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#creating-the-lns-module">3. Creating the LNS module</a>
<ul class="sectlevel2">
<li><a href="#account-schema">3.1. Account schema</a></li>
<li><a href="#assets">3.2. Assets</a></li>
<li><a href="#actions">3.3. Actions</a></li>
<li><a href="#reducers">3.4. Reducers</a></li>
<li><a href="#utility-functions-3">3.5. Utility functions</a></li>
<li><a href="#updating-the-genesis-block">3.6. Updating the genesis block</a></li>
</ul>
</li>
<li><a href="#connecting-the-dashboard-and-faucet-plugins">4. Connecting the Dashboard and Faucet plugins</a>
<ul class="sectlevel2">
<li><a href="#registering-the-dashboard-plugin">4.1. Registering the Dashboard plugin</a></li>
<li><a href="#registering-the-faucet-plugin">4.2. Registering the Faucet plugin</a></li>
<li><a href="#checking-the-functionality-of-the-lns-module">4.3. Checking the functionality of the LNS module</a>
<ul class="sectlevel3">
<li><a href="#create-new-account">4.3.1. Create new account</a></li>
<li><a href="#fund-new-account">4.3.2. Fund new account</a></li>
<li><a href="#register-new-domain">4.3.3. Register new domain</a></li>
<li><a href="#call-the-actions-resolvename-and-resolvenode">4.3.4. Call the actions resolveName and resolveNode</a></li>
<li><a href="#define-a-reverse-lookup-address">4.3.5. Define a reverse lookup address</a></li>
<li><a href="#update-the-records-for-a-domain-name">4.3.6. Update the records for a domain name</a></li>
<li><a href="#check-account-details">4.3.7. Check account details</a></li>
<li><a href="#perform-a-reverse-lookup-for-an-address">4.3.8. Perform a reverse lookup for an address</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Find the complete code for the LNS example application in the <a href="https://github.com/LiskHQ/lisk-sdk-examples/tree/development/tutorials/lisk-name-service" target="_blank" rel="noopener">Lisk SDK examples</a> repository:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">git clone https://github.com/LiskHQ/lisk-sdk-examples.git</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="bootstrapping-the-default-application"><a class="anchor" href="#bootstrapping-the-default-application"></a>1. Bootstrapping the default application</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Please follow the section <a href="../../build-blockchain/create-blockchain-app.html#initializing-a-new-blockchain-application" class="xref page">Initializing a new blockchain application</a> of the setup guide to bootstrap the LNS blockchain application.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Please use <code>lisk-name-service/lns</code> as the root folder for the LNS blockchain application, and <code>lns</code> as the application name.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">mkdir lisk-name-service
cd lisk-name-service
lisk init</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To customize the default blockchain application to suit our desired use case, generate the LNS module skeleton.</p>
</div>
<div class="paragraph">
<p>Create the module skeleton by executing the command <code>lisk generate:module</code> as shown below:</p>
</div>
<div class="listingblock">
<div class="title">lisk-name-service/lns/</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">lisk generate:module lns 1000</code></pre>
</div>
</div>
<div class="paragraph">
<p>The command expects two arguments:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The module name.</p>
</li>
<li>
<p>The module ID.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>This information will be used to create the corresponding module skeleton.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>├── src
│   ├── app
│   │   ├── app.ts
│   │   ├── index.ts
│   │   ├── modules
│   │   │   └── lns
│   │   │       └── lns_module.ts <i class="conum" data-value="1"></i><b>(1)</b>
│   │   ├── modules.ts
│   │   ├── plugins
│   │   └── plugins.ts</pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The newly created skeleton for the LNS module.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Read the following sections to learn how to further extend the LNS module to suit the desired use case.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="creating-the-lns-module-assets"><a class="anchor" href="#creating-the-lns-module-assets"></a>2. Creating the LNS module assets</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The first part of the module to be implemented here are the assets to handle the different transaction types <code>register</code>, <code>reverse lookup</code>, and <code>update records</code>.</p>
</div>
<div class="sect2">
<h3 id="register-domain"><a class="anchor" href="#register-domain"></a>2.1. Register Domain</h3>
<div class="paragraph">
<p>As the first step for creating the asset, use Lisk Commander again, this time to create the asset skeleton.</p>
</div>
<div class="paragraph">
<p>Execute the following command:</p>
</div>
<div class="listingblock">
<div class="title">lisk-name-service/lns/</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">lisk generate:asset lns register 1</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>├── src
│   ├── app
│   │   ├── app.ts
│   │   ├── index.ts
│   │   ├── modules
│   │   │   └── lns
│   │   │       ├── assets
│   │   │       │   └── register.ts <i class="conum" data-value="1"></i><b>(1)</b>
│   │   │       └── lns_module.ts
│   │   ├── modules.ts
│   │   ├── plugins
│   │   └── plugins.ts</pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The newly created skeleton for the <code>register</code> asset.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When you open <code>register-asset.ts</code> at this point, it will appear as shown below:</p>
</div>
<div class="listingblock">
<div class="title">src/app/modules/lns/assets/register-asset.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">import { BaseAsset, ApplyAssetContext, ValidateAssetContext } from 'lisk-sdk';

export class RegisterAsset extends BaseAsset {
  public name = 'register';
  public id = 1;

  // Define schema for asset
  public schema = {
    $id: 'lns/register-asset',
    title: 'RegisterAsset transaction asset for lns module',
    type: 'object',
    required: [],
    properties: {},
  };

  public validate({ asset }: ValidateAssetContext&lt;{}&gt;): void {
    // Validate your asset
  }

  // eslint-disable-next-line @typescript-eslint/require-await
  public async apply({ asset, transaction, stateStore }: ApplyAssetContext&lt;{}&gt;): Promise&lt;void&gt; {
    throw new Error('Asset "register" apply hook is not implemented.');
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As can be seen, the asset name and ID are already pre-filled with the values we provided when creating the asset skeleton.</p>
</div>
<div class="paragraph">
<p>For the next step, it is necessary to define the asset schema, which defines which kind of data is expected by the application to successfully register a new domain for a user account.</p>
</div>
<div class="sect3">
<h4 id="schema"><a class="anchor" href="#schema"></a>2.1.1. Schema</h4>
<div class="paragraph">
<p>Create a new folder <code>data/</code> inside the <code>lns</code> module folder.</p>
</div>
<div class="listingblock">
<div class="title">src/app/modules/lns/</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">mkdir data</code></pre>
</div>
</div>
<div class="paragraph">
<p>This folder is created to maintain a better overview, and will store all account and asset schemas which are relevant to the LNS module.</p>
</div>
<div class="listingblock">
<div class="title">src/app/modules/lns/</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">mkdir data/assets</code></pre>
</div>
</div>
<div class="paragraph">
<p>Inside the <code>data/assets</code> folder, create a new file <code>register.ts</code>, which will contain the schemas related to the <code>register</code> asset.</p>
</div>
<div class="paragraph">
<p>Firstly, define an interface for the expected asset data of a <code>register</code> transaction.
This describes in a straightforward manner, which data is expected to be in the <a href="../../glossary.html#transaction-asset" class="xref page">transaction asset</a> for the successful registration of a new domain.</p>
</div>
<div class="paragraph">
<p>The following information is required for a successful registration:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>name</code>(string): The domain name to register for the sending account.</p>
</li>
<li>
<p><code>ttl</code>(number): Time-To-Live: The amount of time required, until the records for the domain can be updated again.</p>
</li>
<li>
<p><code>registerFor</code>(number): The duration to reserve this domain for the sender account.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The corresponding interface should appear as shown below:</p>
</div>
<div class="listingblock">
<div class="title">src/app/modules/lns/data/assets/register.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">export interface RegisterAssetProps {
	name: string;
	ttl: number;
	registerFor: number;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is described in the following asset schema, which is shown below:</p>
</div>
<div class="listingblock">
<div class="title">src/app/modules/lns/data/assets/register.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">export const registerAssetPropsSchema = {
  $id: 'lns/assets/register',
  title: 'RegisterAsset transaction asset for lns module',
  type: 'object',
  required: ['name', 'ttl', 'registerFor'],
  properties: {
    name: {
      dataType: 'string',
      fieldNumber: 1,
    },
    ttl: {
      dataType: 'uint32',
      fieldNumber: 2,
    },
    registerFor: {
      dataType: 'uint32',
      fieldNumber: 3,
    },
  },
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Add the interface and asset schema to the file and save it.</p>
</div>
<div class="paragraph">
<p>Now, include the schema in the asset file:</p>
</div>
<div class="listingblock">
<div class="title">src/app/modules/lns/assets/register.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">import { BaseAsset, ApplyAssetContext, ValidateAssetContext } from 'lisk-sdk';
import { RegisterAssetProps, registerAssetPropsSchema } from '../data';

export class RegisterAsset extends BaseAsset&lt;RegisterAssetProps&gt; {
  public name = 'register';
  public id = 1;

  // Define schema for asset
  public schema = registerAssetPropsSchema;

  // ...
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="validation"><a class="anchor" href="#validation"></a>2.1.2. Validation</h4>
<div class="paragraph">
<p>Create a new file <code>constants.ts</code> inside the <code>lns</code> module folder.</p>
</div>
<div class="paragraph">
<p>This file is created to maintain a better overview, and will store all constants which are relevant to the LNS module and its' assets.</p>
</div>
<div class="paragraph">
<p>Add the following two constants.</p>
</div>
<div class="listingblock">
<div class="title">src/app/modules/lns/constants.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">export const MIN_TTL_VALUE = 60 * 60; // 1 hour
export const VALID_TLDS = ['lsk'];</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now import the constants into the <code>register</code> asset, and use them to check the validity of transaction assets:</p>
</div>
<div class="paragraph">
<p>Validate the following:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The TTL (Time-to-live), value needs to be above the minimum defined TTL value (60 * 60).</p>
</li>
<li>
<p>The <code>registerFor</code> value needs to be between 1 and 5.</p>
</li>
<li>
<p>Only second level domain names can be registered.</p>
</li>
<li>
<p>Only domains with valid TLDs (Top-Level Domain), can be registered.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The corresponding code can be seen below:</p>
</div>
<div class="listingblock">
<div class="title">src/app/modules/lns/assets/register.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">import { BaseAsset, ApplyAssetContext, ValidateAssetContext } from 'lisk-sdk';
import { RegisterAssetProps, registerAssetPropsSchema } from '../data';
import { MIN_TTL_VALUE, VALID_TLDS } from '../constants';

export class RegisterAsset extends BaseAsset&lt;RegisterAssetProps&gt; {

    // ...

  public validate({ asset }: ValidateAssetContext&lt;RegisterAssetProps&gt;): void {
		if (asset.ttl &lt; MIN_TTL_VALUE) {
			throw new Error(`Must set TTL value larger or equal to ${MIN_TTL_VALUE}`);
		}

		if (asset.registerFor &lt; 1) {
			throw new Error('You can register name at least for 1 year.');
		}

		if (asset.registerFor &gt; 5) {
			throw new Error('You can register name maximum for 5 year.');
		}

		const chunks = asset.name.split(/\./);

		if (chunks.length &gt; 2) {
			throw new Error('You can only register second level domain name.');
		}

		if (!VALID_TLDS.includes(chunks[1])) {
			throw new Error(`Invalid TLD found "${chunks[1]}". Valid TLDs are "${VALID_TLDS.join()}"`);
		}
	}

    // ...
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="state-change"><a class="anchor" href="#state-change"></a>2.1.3. State change</h4>
<div class="paragraph">
<p>If the validation of the transaction asset doesn&#8217;t throw any errors, the <code>apply()</code> function is executed, which allows state changes on the blockchain, based on the received transaction data.</p>
</div>
<div class="paragraph">
<p>The following logic is implemented in the <code>apply()</code> function:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Checks if the domain name was already registered, and throws an error if this is the case.</p>
</li>
<li>
<p>Creates a new LNS object based on the asset data of the received transaction and saves it in the blockchain.</p>
</li>
<li>
<p>Adds the namehash output of the domain name to the sender account under the key <code>lns.ownNodes</code>.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">src/app/modules/lns/assets/register.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">import { addYears } from 'date-fns';
import { BaseAsset, ApplyAssetContext, ValidateAssetContext } from 'lisk-sdk';
import { LNSAccountProps, RegisterAssetProps, registerAssetPropsSchema } from '../data';
import { createLNSObject, getLNSObject, getNodeForName } from '../storage';
import { MIN_TTL_VALUE, VALID_TLDS } from '../constants';

export class RegisterAsset extends BaseAsset&lt;RegisterAssetProps&gt; {

    // ...

    public async apply({
            asset,
            stateStore,
            transaction,
        }: ApplyAssetContext&lt;RegisterAssetProps&gt;): Promise&lt;void&gt; {
            // Get namehash output of the domain anme
            const node = getNodeForName(asset.name);

            // Check if this domain is already registered on the blockchain
            const existingDomain = await getLNSObject(stateStore, node);
            if (existingDomain) {
                throw new Error(`The name "${asset.name}" already registered`);
            }

            // Create the LNS object and save it on the blockchain
            const lnsObject = {
                name: asset.name,
                ttl: asset.ttl,
                expiry: Math.ceil(addYears(new Date(), asset.registerFor).getTime() / 1000),
                ownerAddress: transaction.senderAddress,
                records: [],
            };
            await createLNSObject(stateStore, lnsObject);

            // Get the sender account
            const sender = await stateStore.account.get&lt;LNSAccountProps&gt;(transaction.senderAddress);

            // Add the namehash output of the domain to the sender account
            sender.lns.ownNodes = [...sender.lns.ownNodes, node];

            // Save the updated sender account on the blockchain
            await stateStore.account.set(sender.address, sender);
        }
    }

    // ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Several utility functions are used inside of the apply function, which are implemented in a new file under the path <code>src/app/modules/lns/storage.ts</code>.
The implementation of these functions is explained in detail in the next section.</p>
</div>
<div class="paragraph">
<p>The <code>LNSAccountProps</code> are imported from the <code>lns/data/</code> folder.
Create a new file <code>lns/data/account_props.ts</code> which exports the <code>LNSAccountProps</code>:</p>
</div>
<div class="listingblock">
<div class="title">src/app/modules/lns/data/account_props.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">import { EMPTY_BUFFER } from "../constants";

export interface LNSAccountProps {
	lns: {
		ownNodes: Buffer[];
		reverseLookup: Buffer;
	};
}

export const lsnAccountPropsSchema = {
	$id: 'lisk/lns/lnsAccount',
	type: 'object',
	required: ['ownNodes', 'reverseLookup'],
	properties: {
		reverseLookup: {
			dataType: 'bytes',
			fieldNumber: 1,
		},
		ownNodes: {
			type: 'array',
			fieldNumber: 2,
			items: {
				dataType: 'bytes',
			},
		},
	},
	default: {
		ownNodes: [],
		reverseLookup: EMPTY_BUFFER,
	},
};</code></pre>
</div>
</div>
<div class="paragraph">
<p>Next, open the file <code>lns/constants.ts</code>, which was created in the <a href="#validation">Validation</a> step and add the following constant:</p>
</div>
<div class="listingblock">
<div class="title">src/app/modules/lns/constants.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">export const EMPTY_BUFFER = Buffer.alloc(0);
export const LNS_PREFIX = 'LNS';</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="utility-functions"><a class="anchor" href="#utility-functions"></a>2.1.4. Utility functions</h4>
<div class="paragraph">
<p>Create a new file <code>storage.ts</code> in the LNS module folder.</p>
</div>
<div class="paragraph">
<p>Install and import the following dependencies:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">npm i eth-ens-namehash date-fns axios</code></pre>
</div>
</div>
<div class="paragraph">
<p>Implement the following functions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#getkeyfornodenode">getKeyForNode(node)</a>: Get the unique database key for a specific LNS object.</p>
</li>
<li>
<p><a href="#getnodefornamename">getNodeForName(name)</a>: Construct a node(namehash output) based on the domain name.</p>
</li>
<li>
<p><a href="#createlnsobjectstatestore-params">createLNSObject(stateStore, params)</a>: A function to create a new LNS object in the database.</p>
</li>
<li>
<p><a href="#getlnsobjectstatestore-node">getLNSObject(stateStore, node)</a>: A function to get a specific LNS object from the database.</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="getkeyfornodenode"><a class="anchor" href="#getkeyfornodenode"></a>getKeyForNode(node)</h5>
<div class="listingblock">
<div class="title">src/app/modules/lns/storage.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">// eslint-disable-next-line @typescript-eslint/triple-slash-reference
/// &lt;reference path="../../../@types/eth-ens-namehash/index.d.ts" /&gt;
import * as namehash from 'eth-ens-namehash';
import { codec, StateStore } from 'lisk-sdk';
import { LNS_PREFIX } from './constants';
import { LNSNode, lnsNodeSchema } from './data/lns_node';

// Get a unique key for each LNS object
export const getKeyForNode = (node: Buffer): string =&gt; `${LNS_PREFIX}:${node.toString('hex')}`;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="getnodefornamename"><a class="anchor" href="#getnodefornamename"></a>getNodeForName(name)</h5>
<div class="listingblock">
<div class="title">src/app/modules/lns/storage.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">// Create a hash from the domain name and return it as Buffer
export const getNodeForName = (name: string): Buffer =&gt;
	Buffer.from(namehash.hash(name).slice(2), 'hex');</code></pre>
</div>
</div>
<div class="paragraph">
<p>For the creation of the name hash output, aka node, reuse the <code>hash()</code> function of the <code>eth-ens-namehash</code> NPM package.</p>
</div>
</div>
<div class="sect4">
<h5 id="createlnsobjectstatestore-params"><a class="anchor" href="#createlnsobjectstatestore-params"></a>createLNSObject(stateStore, params)</h5>
<div class="paragraph">
<p>Now implement the function to save a new LNS object in the database by reusing the above defined functions <a href="#getnodefornamename">getNodeForName(name)</a> and <a href="#getkeyfornodenode">getKeyForNode(node)</a>, and also the <a href="#lns-node-schema">LNS node schema</a> defined below.</p>
</div>
<div class="paragraph">
<p>The function  <code>createLNSObject()</code> expects the following two arguments:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>stateStore</code>: the stateStore which is passed from the LNS module later.
The stateStore allows performing state changes on the blockchain.</p>
</li>
<li>
<p><code>params</code>: the parameters which will be used to create the new LNS object.</p>
<div class="ulist">
<ul>
<li>
<p>ownerAddress</p>
</li>
<li>
<p>name</p>
</li>
<li>
<p>ttl</p>
</li>
<li>
<p>expiry</p>
</li>
<li>
<p>records</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="listingblock">
<div class="title">src/app/modules/lns/storage.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">import { chain, codec, StateStore } from 'lisk-sdk';
// ...

export const createLNSObject = async (
	stateStore: StateStore,
	params: Omit&lt;LNSNode, 'createdAt' | 'updatedAt' | 'node'&gt; &amp; { name: string },
): Promise&lt;void&gt; =&gt; {
	const { name, ...lnsObject } = params;
	const node = getNodeForName(name);

	const input: LNSNode = {
		...lnsObject,
		name,
		createdAt: Math.ceil(Date.now() / 1000),
		updatedAt: Math.ceil(Date.now() / 1000),
	};

	await stateStore.chain.set(getKeyForNode(node), codec.encode(lnsNodeSchema, input));
};</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="getlnsobjectstatestore-node"><a class="anchor" href="#getlnsobjectstatestore-node"></a>getLNSObject(stateStore, node)</h5>
<div class="paragraph">
<p>Next, implement the function <code>getLNSObject()</code>, which gets a specific LNS object from the database, based on the provided node value.</p>
</div>
<div class="paragraph">
<p>The function <code>getKeyForNode()</code> is used to get a unique key for the LNS object in the database.</p>
</div>
<div class="paragraph">
<p>The function <code>getLNSObject()</code> expects the following two arguments:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>stateStore</code>: the stateStore which is passed from the LNS module later.
The stateStore allows performing state changes on the blockchain.</p>
</li>
<li>
<p><code>node</code>: The name hash of the LNS object which is requested from the database.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="title">src/app/modules/lns/storage.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">export const getLNSObject = async (
	stateStore: StateStore,
	node: Buffer,
): Promise&lt;LNSNode | undefined&gt; =&gt; {
	const result = await stateStore.chain.get(getKeyForNode(node));

	if (!result) {
		return;
	}

	// eslint-disable-next-line consistent-return
	return codec.decode&lt;LNSNode&gt;(lnsNodeSchema, result);
};</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="schemas"><a class="anchor" href="#schemas"></a>2.1.5. Schemas</h4>
<div class="paragraph">
<p>Implement the following interfaces and schemas, which are to be used inside the utility functions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#lns-node-record-schema">LNS node record schema</a>: Interface and schema for an LNS node record.</p>
</li>
<li>
<p><a href="#lns-node-schema">LNS node schema</a>: Interface and schema for an LNS node.</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="lns-node-record-schema"><a class="anchor" href="#lns-node-record-schema"></a>LNS node record schema</h5>
<div class="paragraph">
<p>Create a new file <code>data/lns_node_records.ts</code> in the LNS module folder.</p>
</div>
<div class="paragraph">
<p>The interface for an LNS node record should appear as shown below:</p>
</div>
<div class="listingblock">
<div class="title">src/app/modules/lns/data/lns_node_records.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">export interface LNSNodeRecord {
	type: number; <i class="conum" data-value="1"></i><b>(1)</b>
	label: string; <i class="conum" data-value="2"></i><b>(2)</b>
	value: string; <i class="conum" data-value="3"></i><b>(3)</b>
}

export type LNSNodeRecordJSON = LNSNodeRecord;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>type</code>: Type of the records as a number.
<code>1</code> stands for a CNAME record, <code>2</code> stands for a TXT record.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>label</code>: Label for the record.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td><code>value</code>: Value for the record.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Based on this interface, create the corresponding schema as shown below:</p>
</div>
<div class="listingblock">
<div class="title">src/app/modules/lns/data/lns_node_records.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">export const lnsNodeRecordSchema = {
	$id: 'lisk/lns/lnsNodeRecord',
	type: 'object',
	required: ['type', 'label', 'value'],
	properties: {
		type: {
			dataType: 'uint32',
			fieldNumber: 1,
		},
		label: {
			dataType: 'string',
			fieldNumber: 2,
		},
		value: {
			dataType: 'string',
			fieldNumber: 3,
		}
	},
};</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="lns-node-schema"><a class="anchor" href="#lns-node-schema"></a>LNS node schema</h5>
<div class="paragraph">
<p>Create a new file <code>data/lns_node.ts</code> in the LNS module folder.</p>
</div>
<div class="paragraph">
<p>First, define an interface that illustrates what the LNS object will look like as shown below:</p>
</div>
<div class="listingblock">
<div class="title">src/app/modules/lns/data/lns_node.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">export interface LNSNode {
	ownerAddress: Buffer; <i class="conum" data-value="1"></i><b>(1)</b>
	name: string;<i class="conum" data-value="2"></i><b>(2)</b>
	ttl: number;<i class="conum" data-value="3"></i><b>(3)</b>
	expiry: number;<i class="conum" data-value="4"></i><b>(4)</b>
	records: LNSNodeRecord[];<i class="conum" data-value="5"></i><b>(5)</b>
	createdAt: number;<i class="conum" data-value="6"></i><b>(6)</b>
	updatedAt: number;<i class="conum" data-value="7"></i><b>(7)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>ownerAddress</code>: The address of the domain owner as a Buffer.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>name</code>: The domain name as a String.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td><code>ttl</code>: The TTL in seconds as a number.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td><code>expiry</code>: The amount of years until the domain registration expires as a number.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td><code>records</code>: A list of all existing records for this domain as an <a href="#lns-node-record-schema">LNSNodeRecord</a>.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td><code>createdAt</code>: Date of the domain registration as a number.</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td><code>updatedAt</code>: Date of the last update of the domain and its' records as a number.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Based on this interface, it is now possible to create the corresponding schema as shown below:</p>
</div>
<div class="listingblock">
<div class="title">src/app/modules/lns/data/lns_node.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">export const lnsNodeSchema = {
	$id: 'lisk/lns/lnsNode',
	type: 'object',
	required: ['ownerAddress', 'name', 'ttl', 'expiry', 'records', 'createdAt', 'updatedAt'],
	properties: {
		ownerAddress: {
			dataType: 'bytes',
			fieldNumber: 1,
		},
		name: {
			dataType: 'string',
			fieldNumber: 2,
		},
		ttl: {
			dataType: 'uint32',
			fieldNumber: 3,
		},
		expiry: {
			dataType: 'uint32',
			fieldNumber: 4,
		},
		createdAt: {
			dataType: 'uint32',
			fieldNumber: 5,
		},
		updatedAt: {
			dataType: 'uint32',
			fieldNumber: 6,
		},
		records: {
			type: 'array',
			fieldNumber: 7,
			items: {
				...lnsNodeRecordSchema,
			},
		},
	},
};</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="update-reverse-lookup"><a class="anchor" href="#update-reverse-lookup"></a>2.2. Update reverse lookup</h3>
<div class="paragraph">
<p>Now that the first asset is prepared, and the first utility functions to store and get LNS objects from the database are implemented, it is now possible to move on to implement the second required asset for updating the reverse lookup of a domain for an account.</p>
</div>
<div class="paragraph">
<p>While a 'regular' lookup involves mapping from a name to an address, a reverse lookup maps from an address back to a domain.
This allows applications to display LNS names in place of hexadecimal addresses.</p>
</div>
<div class="paragraph">
<p>As an account can register multiple domains, it is important to define which domain the address should resolve to by default.</p>
</div>
<div class="paragraph">
<p>To achieve this, the account owner needs to send a reverse lookup transaction to update the default domain, which their account address should default to.</p>
</div>
<div class="paragraph">
<p>Similar to the register asset, use Lisk Commander to first generate the asset skeleton.
Use <code>reverse_lookup</code> as the asset name and <code>2</code> as the asset ID.</p>
</div>
<div class="listingblock">
<div class="title">lisk-name-service/lns/</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">lisk generate:asset lns reverseLookup 2</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="schema-2"><a class="anchor" href="#schema-2"></a>2.2.1. Schema</h4>
<div class="paragraph">
<p>Create a new file und the path <code>src/app/modules/lns/data/assets/reverse_lookup.ts</code> and add the asset schema for the reverse lookup transaction.</p>
</div>
<div class="listingblock">
<div class="title">src/app/modules/lns/data/assets/reverse_lookup.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">export interface ReverseLookupAssetProps {
	name: string;
}

export const reverseLookupAssetPropsSchema = {
  $id: 'lns/assets/set-lookup',
  title: 'SetLookup transaction asset for lns module',
  type: 'object',
  required: ['name'],
  properties: {
    name: {
      dataType: 'string',
      fieldNumber: 1,
    },
  },
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Add the interface and asset schema to the file and save it.</p>
</div>
<div class="paragraph">
<p>Now include the schema in the asset file:</p>
</div>
<div class="listingblock">
<div class="title">src/app/modules/lns/assets/reverse_lookup_asset.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">import { ApplyAssetContext, BaseAsset } from 'lisk-sdk';
import { LNSAccountProps, ReverseLookupAssetProps, reverseLookupAssetPropsSchema } from '../data';
import { getNodeForName } from '../storage';

export class ReverseLookupAsset extends BaseAsset&lt;ReverseLookupAssetProps&gt; {
	public name = 'reverse-lookup';
	public id = 2;

	// Define schema for asset
	public schema = reverseLookupAssetPropsSchema;

  // ...
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="state-change-2"><a class="anchor" href="#state-change-2"></a>2.2.2. State change</h4>
<div class="paragraph">
<p>The validation is not required for the reverse lookup transaction asset, so it is possible to directly move on to implement the apply() function.</p>
</div>
<div class="paragraph">
<p>The following logic is implemented:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Check if the domain name was already registered and if the transaction sender owns this domain. If not then an error should be thrown.</p>
</li>
<li>
<p>Add the hash value of the domain as the reverse lookup domain to the senders account under the key <code>lns.reverseLookup</code>.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">src/app/modules/lns/assets/reverse_lookup.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">public async apply({
    asset,
    stateStore,
    transaction,
}: ApplyAssetContext&lt;ReverseLookupAssetProps&gt;): Promise&lt;void&gt; {
    const node = getNodeForName(asset.name);
    const sender = await stateStore.account.get&lt;LNSAccountProps&gt;(transaction.senderAddress);

    const exists = sender.lns.ownNodes.find(n =&gt; n.equals(node));

    if (!exists) {
        throw new Error('You can only assign lookup node which you own.');
    }

    sender.lns.reverseLookup = node;
    await stateStore.account.set(sender.address, sender);
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="update-records"><a class="anchor" href="#update-records"></a>2.3. Update records</h3>
<div class="paragraph">
<p>Finally, create the asset for updating the records of a domain.
This is the last of the three assets in the LNS module.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <a href="https://en.wikipedia.org/wiki/CNAME_record" target="_blank" rel="noopener">CNAME</a> and <a href="https://en.wikipedia.org/wiki/TXT_record" target="_blank" rel="noopener">TXT</a> records have no distinct difference in the LNS blockchain application.
Different handling of the records can be implemented at a later stage.
For example if you build any DNS provider service on top of the LNS app, then you can use CNAME and TXT records differently there.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">lisk generate:asset lns updateRecords 3</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="schema-3"><a class="anchor" href="#schema-3"></a>2.3.1. Schema</h4>
<div class="paragraph">
<p>Create a new file for schemas under the path <code>lns/data/assets/update_records.ts</code> and define the asset schema for the "update records" transaction.</p>
</div>
<div class="listingblock">
<div class="title">src/app/modules/lns/data/assets/update_records.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">import { LNSNodeRecord, lnsNodeRecordSchema } from "../lns_node_record";

export interface UpdateRecordsAssetProps {
  name: string;
  records: LNSNodeRecord[];
}

export const updateRecordsAssetPropsSchema = {
  $id: 'lns/updateRecords-asset',
  title: 'Update Records transaction asset for lns module',
  type: 'object',
  required: ['records'],
  properties: {
    name: {
      dataType: 'string',
      fieldNumber: 1,
    },
    records: {
      type: 'array',
      fieldNumber: 2,
      items: {
				...lnsNodeRecordSchema,
			},
    }
  },
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now include the schema in the asset file.</p>
</div>
<div class="listingblock">
<div class="title">src/app/modules/lns/assets/reverse_lookup_asset.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">import { ApplyAssetContext, BaseAsset, ValidateAssetContext } from 'lisk-sdk';
import { LNSAccountProps, UpdateRecordsAssetProps, updateRecordsAssetPropsSchema } from '../data';

export class UpdateRecordsAsset extends BaseAsset&lt;UpdateRecordsAssetProps&gt; {
	public name = 'update-records';
	public id = 3;

	// Define schema for asset
	public schema = updateRecordsAssetPropsSchema;

  // ...
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="validation-2"><a class="anchor" href="#validation-2"></a>2.3.2. Validation</h4>
<div class="paragraph">
<p>Open the file <code>lns/constants.ts</code>, which was created in the <a href="#validation">Validation</a> step, and add the following constants:</p>
</div>
<div class="listingblock">
<div class="title">src/app/modules/lns/constants.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">export const VALID_RECORD_TYPES = [CNAME_RECORD_TYPE, TXT_RECORD_TYPE];
export const MAX_RECORDS = 50;
export const MIN_RECORD_LABEL_LENGTH = 3;
export const MAX_RECORD_LABEL_LENGTH = 15;
export const MIN_RECORD_VALUE_LENGTH = 3;
export const MAX_RECORD_VALUE_LENGTH = 255;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now import the constants inside of <code>update_records.ts</code> and implement the <code>validate</code> function as follows:</p>
</div>
<div class="listingblock">
<div class="title">src/app/modules/lns/assets/update_records_asset.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">import { ApplyAssetContext, BaseAsset, ValidateAssetContext } from 'lisk-sdk';
import {
	MAX_RECORDS,
	MAX_RECORD_LABEL_LENGTH,
	MAX_RECORD_VALUE_LENGTH,
	MIN_RECORD_LABEL_LENGTH,
	MIN_RECORD_VALUE_LENGTH,
	VALID_RECORD_TYPES,
} from '../constants';
import { LNSAccountProps, UpdateRecordsAssetProps, updateRecordsAssetPropsSchema } from '../data';

export class UpdateRecordsAsset extends BaseAsset&lt;UpdateRecordsAssetProps&gt; {
	public name = 'update-records';
	public id = 3;

	// Define schema for asset
	public schema = updateRecordsAssetPropsSchema;

	// Define asset validation
	public validate({ asset }: ValidateAssetContext&lt;UpdateRecordsAssetProps&gt;): void {
	    // Check, if number of records to be updated is below the maximum allowed amount (here: MAX_RECORDS = 50)
		if (asset.records.length &gt; MAX_RECORDS) {
			throw new Error(`Can associate maximum ${MAX_RECORDS} records. Got ${asset.records.length}.`);
		}

		const recordKeys = new Set(asset.records.map(r =&gt; `${r.type.toString()}:${r.label}`));

		// Checks if all records are unique
		if (recordKeys.size !== asset.records.length) {
			throw new Error('Records should be unique among type and label');
		}

		for (const record of asset.records) {
		    // Checks if all records have valid record types
			if (!VALID_RECORD_TYPES.includes(record.type)) {
				throw new Error(
					`Invalid record type "${
						record.type
					}". Valid record types are ${VALID_RECORD_TYPES.join()}`,
				);
			}
			// Checks, if record labels have a valid length
			if (
				record.label.length &gt; MAX_RECORD_LABEL_LENGTH ||
				record.label.length &lt; MIN_RECORD_LABEL_LENGTH
			) {
				throw new Error(
					`Record label can be between ${MIN_RECORD_LABEL_LENGTH}-${MAX_RECORD_LABEL_LENGTH}.`,
				);
			}
            // Checks, if record values have a valid length
			if (
				record.value.length &gt; MAX_RECORD_VALUE_LENGTH ||
				record.value.length &lt; MIN_RECORD_VALUE_LENGTH
			) {
				throw new Error(
					`Record value can be between ${MIN_RECORD_VALUE_LENGTH}-${MAX_RECORD_VALUE_LENGTH}.`,
				);
			}
		}
	}

    // ...
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="state-change-3"><a class="anchor" href="#state-change-3"></a>2.3.3. State change</h4>
<div class="paragraph">
<p>The following logic is implemented:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Throw an error, if the provided domain name is not registered to an account.</p>
</li>
<li>
<p>Throw an error, if the sender of the transaction is not the owner of the registered domain name.</p>
</li>
<li>
<p>Throw an error, if the defined TTL hasn&#8217;t passed yet.</p>
</li>
<li>
<p>If no errors are thrown, update the LNS object with the new records from the asset.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">src/app/modules/lns/assets/update_records.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">import { ApplyAssetContext, BaseAsset, ValidateAssetContext } from 'lisk-sdk';
import {
	MAX_RECORDS,
	MAX_RECORD_LABEL_LENGTH,
	MAX_RECORD_VALUE_LENGTH,
	MIN_RECORD_LABEL_LENGTH,
	MIN_RECORD_VALUE_LENGTH,
	VALID_RECORD_TYPES,
} from '../constants';
import { LNSAccountProps, UpdateRecordsAssetProps, updateRecordsAssetPropsSchema } from '../data';
import { getLNSObject, updateLNSObject, getNodeForName } from '../storage';
import { isTTLPassed } from '../utils';

export class UpdateRecordsAsset extends BaseAsset&lt;UpdateRecordsAssetProps&gt; {
	public name = 'update-records';
	public id = 3;

	// ...

	public async apply({
		asset,
		stateStore,
		transaction,
	}: ApplyAssetContext&lt;UpdateRecordsAssetProps&gt;): Promise&lt;void&gt; {
	    // Get the sender account from the database
		const sender = await stateStore.account.get&lt;LNSAccountProps&gt;(transaction.senderAddress);
		// Get the hash of the name
		const node = getNodeForName(asset.name);
		// Get the LNS object from the database
		const lnsObject = await getLNSObject(stateStore, node);
		// Validate, if the corresponding LNS object exists
		if (!lnsObject) {
			throw new Error(`LNS object with name "${asset.name}" is not registered`);
		}
        // Validate, that the sender registered the LNS object
		if (!lnsObject.ownerAddress.equals(sender.address)) {
			throw new Error('Only owner of hte LNS object can update records.');
		}
        // Validate, that the TTL for this LNS object to update the records has passed
		if (!isTTLPassed(lnsObject)) {
			throw new Error('You have to wait for TTL from the last update.');
		}
        // Update the LNS object with the new records from the asset
		await updateLNSObject(stateStore, { node, records: asset.records });
	}

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The function <code>updateLNSObject()</code> is a new function which is added to the utility functions in the next section.</p>
</div>
</div>
<div class="sect3">
<h4 id="utility-functions-2"><a class="anchor" href="#utility-functions-2"></a>2.3.4. Utility functions</h4>
<div class="paragraph">
<p>Open the file <code>storage.ts</code> which was previously created in the <a href="#utility-functions">Utility functions</a> step, and define a new function <code>updateLNSObject()</code> which updates a certain LNS object in the database, based on the provided parameters.</p>
</div>
<div class="listingblock">
<div class="title">src/app/modules/lns/storage.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">export const updateLNSObject = async (
	stateStore: StateStore,
	params: Partial&lt;Omit&lt;LNSNode, 'createdAt' | 'updatedAt'&gt;&gt; &amp; { node: Buffer },
): Promise&lt;void&gt; =&gt; {
	const lnsObject = await getLNSObject(stateStore, params.node);

	if (!lnsObject) {
		throw new Error('No lns object is associated with this name');
	}

	lnsObject.ttl = params.ttl ?? lnsObject.ttl;
	lnsObject.ownerAddress = params.ownerAddress ?? lnsObject.ownerAddress;
	lnsObject.expiry = params.expiry ?? lnsObject.expiry;
	lnsObject.records = params.records ?? lnsObject.records;

	lnsObject.updatedAt = Math.ceil(Date.now() / 1000);

	await stateStore.chain.set(getKeyForNode(params.node), codec.encode(lnsNodeSchema, lnsObject));
};</code></pre>
</div>
</div>
<div class="paragraph">
<p>Create a new file <code>utils.ts</code> inside of the lns module folder, with the following two utility functions:</p>
</div>
<div class="listingblock">
<div class="title">src/app/modules/lns/utils.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">import { LNSNode } from './data';

export const isExpired = (node: LNSNode): boolean =&gt; {
	const currentTime = Math.ceil(new Date().getTime() / 1000);

	return currentTime &gt; node.expiry;
};

export const isTTLPassed = (node: LNSNode): boolean =&gt; {
	const currentTime = Math.ceil(new Date().getTime() / 1000);
	const validUpdateTime = node.updatedAt + node.ttl;

	return currentTime &gt; validUpdateTime;
};</code></pre>
</div>
</div>
<div class="paragraph">
<p>With this, all the required assets of the LNS blockchain application are implemented.
The final step is now to add them to the module, which will be performed in the next chapter, where the LNS module is implemented.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="creating-the-lns-module"><a class="anchor" href="#creating-the-lns-module"></a>3. Creating the LNS module</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To implement the LNS module, firstly view the module skeleton as shown below:</p>
</div>
<div class="listingblock">
<div class="title">lns/lns_module.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">import {
    BaseModule,
    AfterBlockApplyContext,
    TransactionApplyContext,
    BeforeBlockApplyContext,
    AfterGenesisBlockApplyContext,
    // GenesisConfig
} from 'lisk-sdk';

export class LnsModule extends BaseModule {
    public actions = {
        // Example below
        // getBalance: async (params) =&gt; this._dataAccess.account.get(params.address).token.balance,
        // getBlockByID: async (params) =&gt; this._dataAccess.blocks.get(params.id),
    };
    public reducers = {
        // Example below
        // getBalance: async (
		// 	params: Record&lt;string, unknown&gt;,
		// 	stateStore: StateStore,
		// ): Promise&lt;bigint&gt; =&gt; {
		// 	const { address } = params;
		// 	if (!Buffer.isBuffer(address)) {
		// 		throw new Error('Address must be a buffer');
		// 	}
		// 	const account = await stateStore.account.getOrDefault&lt;TokenAccount&gt;(address);
		// 	return account.token.balance;
		// },
    };
    public name = 'lns';
    public transactionAssets = [];
    public events = [
        // Example below
        // 'hello:newBlock',
    ];
    public id = 1000;

    // public constructor(genesisConfig: GenesisConfig) {
    //     super(genesisConfig);
    // }

    // Lifecycle hooks
    public async beforeBlockApply(_input: BeforeBlockApplyContext) {
        // Get any data from stateStore using block info, below is an example getting a generator
        // const generatorAddress = getAddressFromPublicKey(_input.block.header.generatorPublicKey);
		// const generator = await _input.stateStore.account.get&lt;TokenAccount&gt;(generatorAddress);
    }

    public async afterBlockApply(_input: AfterBlockApplyContext) {
        // Get any data from stateStore using block info, below is an example getting a generator
        // const generatorAddress = getAddressFromPublicKey(_input.block.header.generatorPublicKey);
		// const generator = await _input.stateStore.account.get&lt;TokenAccount&gt;(generatorAddress);
    }

    public async beforeTransactionApply(_input: TransactionApplyContext) {
        // Get any data from stateStore using transaction info, below is an example
        // const sender = await _input.stateStore.account.getOrDefault&lt;TokenAccount&gt;(_input.transaction.senderAddress);
    }

    public async afterTransactionApply(_input: TransactionApplyContext) {
        // Get any data from stateStore using transaction info, below is an example
        // const sender = await _input.stateStore.account.getOrDefault&lt;TokenAccount&gt;(_input.transaction.senderAddress);
    }

    public async afterGenesisBlockApply(_input: AfterGenesisBlockApplyContext) {
        // Get any data from genesis block, for example get all genesis accounts
        // const genesisAccounts = genesisBlock.header.asset.accounts;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As can be seen, the following values have been pre-filled when creating the LNS module with Lisk Commander in the step <a href="#bootstrapping-the-default-application">Bootstrapping the default application</a>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>name</code>: The module name (here: <code>lns</code>).</p>
</li>
<li>
<p><code>id</code>: The module ID (here: <code>1000</code>).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Now the following parts of the skeleton can be implemented:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="#account-schema">Account schema</a></p>
</li>
<li>
<p><a href="#assets">Assets</a></p>
</li>
<li>
<p><a href="#actions">Actions</a></p>
</li>
<li>
<p><a href="#reducers">Reducers</a></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The events and lifecycle hooks are not required in this use case, so the skeletons can remain as they are.</p>
</div>
<div class="sect2">
<h3 id="account-schema"><a class="anchor" href="#account-schema"></a>3.1. Account schema</h3>
<div class="paragraph">
<p>Add the account schema for the module-specific account data:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-js hljs" data-lang="js">import { lnsAccountPropsSchema } from './data';

export class LnsModule extends BaseModule {
    // ...
    public accountSchema = lnsAccountPropsSchema;
    // ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Don&#8217;t forget to add the <code>lnsAccountPropsSchema</code> to the file <code>data/account_props.ts</code>.</p>
</div>
<div class="listingblock">
<div class="title">account_props.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-js hljs" data-lang="js">export const lnsAccountPropsSchema = {
	$id: 'lisk/lns/lnsAccount',
	type: 'object',
	required: ['ownNodes', 'reverseLookup'],
	properties: {
		reverseLookup: {
			dataType: 'bytes',
			fieldNumber: 1,
		},
		ownNodes: {
			type: 'array',
			fieldNumber: 2,
			items: {
				dataType: 'bytes',
			},
		},
	},
	default: {
		ownNodes: [],
		reverseLookup: EMPTY_BUFFER,
	},
};</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="assets"><a class="anchor" href="#assets"></a>3.2. Assets</h3>
<div class="paragraph">
<p>The assets created previousely in step <a href="#creating-the-lns-module-assets">Creating the LNS module assets</a> are already added to the module.</p>
</div>
<div class="listingblock">
<div class="title">lns/lns_module.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">import { RegisterAsset } from './assets/register';
import { UpdateRecordsAsset } from './assets/update_records';
import { ReverseLookupAsset } from './assets/reverse_lookup';

export class LnsModule extends BaseModule {
    // ...
    public transactionAssets = [
		new RegisterAsset(),
		new ReverseLookupAsset(),
		new UpdateRecordsAsset(),
	];
    // ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>That is all that is required to add new assets to the LNS module.</p>
</div>
</div>
<div class="sect2">
<h3 id="actions"><a class="anchor" href="#actions"></a>3.3. Actions</h3>
<div class="paragraph">
<p>The LNS module should have the following actions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>lookupAddress</code>: returns an LNS object based on a provided account address.</p>
</li>
<li>
<p><code>resolveName</code>: returns an LNS object based on a domain name.</p>
</li>
<li>
<p><code>resolveNode</code>: returns an LNS object based on a node hash value.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>All three actions are returning an <a href="#lns-node-schema">LNS object</a>, based on different input parameters, such as: the address it is registered to, the domain name that is registered in the LNS object, or a hash of the LNS object, which is typically stored in the  user account under the key <code>lns.ownNodes</code>.</p>
</div>
<div class="paragraph">
<p>The main logic of the different actions is imported from the file <code>storage.ts</code>, and is explained in detail in the <a href="#utility-functions-3">Utility functions</a> step below.</p>
</div>
<div class="listingblock">
<div class="title">lns/lns_module.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">import {
    BaseModule,
    codec,
    AfterBlockApplyContext,
    TransactionApplyContext,
    BeforeBlockApplyContext,
    AfterGenesisBlockApplyContext,
    // GenesisConfig
} from 'lisk-sdk';
import { RegisterAsset } from './assets/register';
import { UpdateRecordsAsset } from './assets/update_records';
import { ReverseLookupAsset } from './assets/reverse_lookup';
import { LNSNode, LNSNodeJSON, lnsNodeSchema, lsnAccountPropsSchema } from './data';
import { lookupAddress, resolveName, resolveNode } from './storage';

export class LnsModule extends BaseModule {
    public actions = {
		lookupAddress: async (params: Record&lt;string, unknown&gt;): Promise&lt;LNSNodeJSON&gt; =&gt; {
			const lnsObject = await lookupAddress({
				accountGetter: this._dataAccess.getAccountByAddress.bind(this),
				chainGetter: this._dataAccess.getChainState.bind(this),
				address: Buffer.from((params as { address: string }).address, 'hex'),
			});

			return codec.toJSON(lnsNodeSchema, lnsObject);
		},
		resolveName: async (params: Record&lt;string, unknown&gt;): Promise&lt;LNSNodeJSON&gt; =&gt; {
			const lnsObject = await resolveName({
				chainGetter: this._dataAccess.getChainState.bind(this),
				name: (params as { name: string }).name,
			});

			return codec.toJSON(lnsNodeSchema, lnsObject);
		},
		resolveNode: async (params: Record&lt;string, unknown&gt;): Promise&lt;LNSNodeJSON&gt; =&gt; {
			const lnsObject = await resolveNode({
				chainGetter: this._dataAccess.getChainState.bind(this),
				node: Buffer.from((params as { node: string }).node, 'hex'),
			});

			return codec.toJSON(lnsNodeSchema, lnsObject);
		},
	};
    // ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Don&#8217;t forget to add a new interface for <code>LNSNodeJSON</code> to the file <code>data/lns_node.ts</code>.</p>
</div>
<div class="listingblock">
<div class="title">src/app/modules/lns/data/lns_node.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">// ...
export interface LNSNodeJSON {
	ownerAddress: string;
	name: string;
	ttl: number;
	expiry: number;
	records: LNSNodeRecordJSON[];
	createdAt: number;
	updatedAt: number;
}
// ...</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="reducers"><a class="anchor" href="#reducers"></a>3.4. Reducers</h3>
<div class="paragraph">
<p>The methods required in the reducers are very similar to the methods in the <a href="#actions">Actions</a> above.
The only difference is that the <code>StateStore</code> is available inside of the reducers, so it can be used instead of <code>dataAccess</code> to query the database:</p>
</div>
<div class="listingblock">
<div class="title">lns/lns_module.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">import {
    BaseModule,
    codec,
    StateStore,
    AfterBlockApplyContext,
    TransactionApplyContext,
    BeforeBlockApplyContext,
    AfterGenesisBlockApplyContext,
    // GenesisConfig
} from 'lisk-sdk';
import { RegisterAsset } from './assets/register';
import { UpdateRecordsAsset } from './assets/update_records';
import { ReverseLookupAsset } from './assets/reverse_lookup';
import { LNSNode, LNSNodeJSON, lnsNodeSchema, lsnAccountPropsSchema } from './data';
import { lookupAddress, resolveName, resolveNode } from './storage';

export class LnsModule extends BaseModule {
    // ...
    public reducers = {
		lookupAddress: async (
			params: Record&lt;string, unknown&gt;,
			stateStore: StateStore,
		): Promise&lt;LNSNode&gt; =&gt;
			lookupAddress({
				accountGetter: stateStore.account.get.bind(this),
				chainGetter: stateStore.chain.get.bind(this),
				address: (params as { address: Buffer }).address,
			}),
		resolveName: async (
			params: Record&lt;string, unknown&gt;,
			stateStore: StateStore,
		): Promise&lt;LNSNode&gt; =&gt;
			resolveName({
				chainGetter: stateStore.chain.get.bind(this),
				name: (params as { name: string }).name,
			}),
		resolveNode: async (
			params: Record&lt;string, unknown&gt;,
			stateStore: StateStore,
		): Promise&lt;LNSNode&gt; =&gt;
			resolveNode({
				chainGetter: stateStore.chain.get.bind(this),
				node: (params as { node: Buffer }).node,
			}),
	};
    // ...
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="utility-functions-3"><a class="anchor" href="#utility-functions-3"></a>3.5. Utility functions</h3>
<div class="paragraph">
<p>Add the code of the functions <code>resolveNode()</code>, resolveName()<code>, and `lookupAddress()</code> to the file <code>storage.ts</code>, to complete the implementation of the actions and reducers of the LNS module.</p>
</div>
<div class="listingblock">
<div class="title">src/app/modules/lns/storage.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">import * as namehash from 'eth-ens-namehash';
import { chain, codec, StateStore } from 'lisk-sdk';
import { EMPTY_BUFFER, LNS_PREFIX } from './constants';
import { LNSAccountProps, LNSNode, lnsNodeSchema } from './data';
import { isExpired } from './utils';

export const getKeyForNode = (node: Buffer): string =&gt; `${LNS_PREFIX}:${node.toString('hex')}`;
export const getNodeForName = (name: string): Buffer =&gt;
	Buffer.from(namehash.hash(name).slice(2), 'hex');

export const resolveNode = async ({
	chainGetter,
	node,
}: {
	chainGetter: (address: string) =&gt; Promise&lt;Buffer | undefined&gt;;
	node: Buffer;
}): Promise&lt;LNSNode&gt; =&gt; {
	const result = await chainGetter(getKeyForNode(node));

	if (!result) {
		throw new Error(`Node "${node.toString('hex')}" could not resolve.`);
	}

	const lnsNode = codec.decode&lt;LNSNode&gt;(lnsNodeSchema, result);

	if (isExpired(lnsNode)) {
		throw new Error(`Node "${node.toString('hex')}" is associated to an expired LNS object.`);
	}

	return lnsNode;
};

export const resolveName = async ({
	chainGetter,
	name,
}: {
	chainGetter: (address: string) =&gt; Promise&lt;Buffer | undefined&gt;;
	name: string;
}): Promise&lt;LNSNode&gt; =&gt; {
	const result = await chainGetter(getKeyForNode(getNodeForName(name)));

	if (!result) {
		throw new Error(`Name "${name}" could not resolve.`);
	}

	const lnsNode = codec.decode&lt;LNSNode&gt;(lnsNodeSchema, result);

	if (isExpired(lnsNode)) {
		throw new Error(`Name "${name}" is associated to an expired LNS object.`);
	}

	return lnsNode;
};

export const lookupAddress = async ({
	accountGetter,
	chainGetter,
	address,
}: {
	accountGetter: (address: Buffer) =&gt; Promise&lt;chain.Account&lt;LNSAccountProps&gt;&gt;;
	chainGetter: (address: string) =&gt; Promise&lt;Buffer | undefined&gt;;
	address: Buffer;
}): Promise&lt;LNSNode&gt; =&gt; {
	let account: chain.Account&lt;LNSAccountProps&gt;;

	try {
		account = await accountGetter(address);
	} catch {
		throw new Error(`Lookup account "${address.toString('hex')}" not found.`);
	}

	if (account.lns.reverseLookup === EMPTY_BUFFER) {
		throw new Error(`Account "${address.toString('hex')}" is not associated with any LNS object.`);
	}

	const result = await chainGetter(getKeyForNode(account.lns.reverseLookup));

	if (!result) {
		throw new Error(`Problem looking up node "${account.lns.reverseLookup.toString('hex')}"`);
	}

	const lnsNode = codec.decode&lt;LNSNode&gt;(lnsNodeSchema, result);

	if (isExpired(lnsNode)) {
		throw new Error(`Account "${address.toString('hex')}" is associated to an expired LNS object.`);
	}

	return lnsNode;
};

// ...</code></pre>
</div>
</div>
<div class="paragraph">
<p>After this final step, all required parts of the LNS module will be implemented.</p>
</div>
</div>
<div class="sect2">
<h3 id="updating-the-genesis-block"><a class="anchor" href="#updating-the-genesis-block"></a>3.6. Updating the genesis block</h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In case the LNS tutorial was cloned from the <code>lisk-sdk-examples</code> repository, this step can be skipped, as the example application already contains the correct genesis block.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If the blockchain application was newly bootstrapped with <code>lisk init</code>, it still contains a default genesis block, which does not include the account schema of the new LNS module.
Therefore it is necessary to create a new genesis block with genesis accounts that include the new account properties of the LNS module.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./bin/run genesis-block:create --output config/default</code></pre>
</div>
</div>
<div class="paragraph">
<p>Update the config with the info for the newly generated genesis delegates.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">tmp=$(mktemp)
jq '.forging.delegates = input' config/default/config.json config/default/forging_info.json &gt; "$tmp" &amp;&amp; mv "$tmp" config/default/config.json
jq '.forging += input' config/default/config.json config/default/password.json &gt; "$tmp" &amp;&amp; mv "$tmp" config/default/config.json</code></pre>
</div>
</div>
<div class="paragraph">
<p>Finally, remove the existing application data, and start the node again, to verify it is starting successfully.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">rm -r ~/.lisk</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Detailed information about this process can be found in the guide <a href="../../build-blockchain/create-genesis-block.html" class="xref page">How to create a new genesis block</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>After the genesis block and config are updated, the application should start again successfully.
To start, run the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./bin/run start</code></pre>
</div>
</div>
<div class="paragraph">
<p>Before proceeding with developing the frontend part of the LNS application, quickly check if the blockchain application is working as expected by enabling the Dashboard plugin as described in the next chapter.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="connecting-the-dashboard-and-faucet-plugins"><a class="anchor" href="#connecting-the-dashboard-and-faucet-plugins"></a>4. Connecting the Dashboard and Faucet plugins</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Dashboard plugin provides a web interface that allows developers to interact with their blockchain application during development.</p>
</div>
<div class="paragraph">
<p>The Faucet plugin provides a web interface with a faucet, allowing accounts in the network to receive free tokens conveniently.</p>
</div>
<div class="paragraph">
<p>By enabling the Dashboard and Faucet plugins in the blockchain application, it is possible to test the functionality of the application by interacting with it through the browser.</p>
</div>
<div class="paragraph">
<p>Furthermore, it will also be possible to perform the following :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>&#8230;&#8203; create new accounts with the Dashboard.</p>
</li>
<li>
<p>&#8230;&#8203; fund accounts with tokens via the Faucet.</p>
</li>
<li>
<p>&#8230;&#8203; send transactions to the LNS application to &#8230;&#8203;</p>
<div class="ulist">
<ul>
<li>
<p>&#8230;&#8203; register new domain names.</p>
</li>
<li>
<p>&#8230;&#8203; set the domain name for a reverse lookup.</p>
</li>
<li>
<p>&#8230;&#8203; update the records of a domain name.</p>
</li>
</ul>
</div>
</li>
<li>
<p>&#8230;&#8203; call actions on the LNS application to &#8230;&#8203;</p>
<div class="ulist">
<ul>
<li>
<p>&#8230;&#8203; perform a reverse lookup for an account address.</p>
</li>
<li>
<p>&#8230;&#8203; return an LNS object based on the domain name.</p>
</li>
<li>
<p>&#8230;&#8203; return an LNS object based on the LNS object hash.</p>
</li>
<li>
<p>&#8230;&#8203; perform a reverse lookup for an account address.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Before the Dashboard and Faucet plugins can be used for this purpose, it is firstly required to install them and to register them with the LNS application, which is performed in the next step.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>More information about the Dashboard plugin can be found in the development guide <a href="../../build-blockchain/using-dashboard.html" class="xref page">Using dashboard with the blockchain application</a> or on the reference page of the <a href="../../../lisk-sdk/v5/plugins/dashboard-plugin.html" class="xref page">Dashboard plugin</a>.</p>
</div>
<div class="paragraph">
<p>More information about the Faucet plugin can be found on the reference page of the <a href="../../../lisk-sdk/v5/plugins/faucet-plugin.html" class="xref page">Faucet plugin</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="registering-the-dashboard-plugin"><a class="anchor" href="#registering-the-dashboard-plugin"></a>4.1. Registering the Dashboard plugin</h3>
<div class="paragraph">
<p>Install the dashboard plugin:</p>
</div>
<div class="listingblock">
<div class="title">lisk-name-service/</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">npm i @liskhq/lisk-framework-dashboard-plugin</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now open <code>plugins.ts</code>, import the Dashboard plugin, and register it with the application as shown below:</p>
</div>
<div class="listingblock">
<div class="title">lisk-name-service/lns/src/app/plugins.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">import { Application } from 'lisk-sdk';
import { DashboardPlugin } from "@liskhq/lisk-framework-dashboard-plugin";

export const registerPlugins = (app: Application): void =&gt; {

    app.registerPlugin(DashboardPlugin);
};</code></pre>
</div>
</div>
<div class="paragraph">
<p>Save and close <code>plugins.ts</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="registering-the-faucet-plugin"><a class="anchor" href="#registering-the-faucet-plugin"></a>4.2. Registering the Faucet plugin</h3>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
This step can be skipped if you do not create a new account in the <a href="#create-new-account">Create new account</a> step, and would rather use one of the existing genesis accounts instead.
Genesis accounts normally have an initial amount of tokens in their balance, so in this case it is not necessary for them to receive funds via the faucet.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Install the faucet plugin:</p>
</div>
<div class="listingblock">
<div class="title">lisk-name-service/</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">npm i @liskhq/lisk-framework-faucet-plugin</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now open <code>plugins.ts</code>, import the Faucet plugin, and register it with the application as shown below:</p>
</div>
<div class="listingblock">
<div class="title">lisk-name-service/lns/src/app/plugins.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">import { Application } from 'lisk-sdk';
import { DashboardPlugin } from "@liskhq/lisk-framework-dashboard-plugin";
import { FaucetPlugin } from "@liskhq/lisk-framework-faucet-plugin";

export const registerPlugins = (app: Application): void =&gt; {

    app.registerPlugin(DashboardPlugin);
    app.registerPlugin(FaucetPlugin);
};</code></pre>
</div>
</div>
<div class="paragraph">
<p>Save and close <code>plugins.ts</code>.</p>
</div>
<div class="paragraph">
<p>Choose one of the genesis delegate to be the faucet account, e.g. the first account in <code>lisk-name-service/.secret/accounts.json</code>.</p>
</div>
<div class="listingblock">
<div class="title">lisk-name-service/.secret/accounts.json</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-js hljs" data-lang="js">[
	{
		"passphrase": "brush swamp sign omit cabin review menu tent spend shy plug strategy",
		"address": "49e8b0411cd96a17a72f88dfe802179b4113924f"
	},
	// ...
]</code></pre>
</div>
</div>
<div class="paragraph">
<p>Use Lisk Commander to encrypt the passphrase of the account with a password.
Save the password securely as it is needed to enable and disable the faucet later.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ lisk passphrase:encrypt
? Please enter passphrase:  [hidden]
? Please re-enter passphrase:  [hidden]
? Please enter password:  [hidden] <i class="conum" data-value="1"></i><b>(1)</b>
? Please re-enter password:  [hidden]
{"encryptedPassphrase":"iterations=1000000&amp;cipherText=643bfbf1b6f1dc0ce740dd9fc9f27a682e476dc5de4e6c023deded4d3efe2822346226541106b42638db5ba46e0ae0a338cb78fb40bce67fdec7abbca68e20624fa6b0d7&amp;iv=8a9c461744b9e70a8ba65edd&amp;salt=3fe00b03d10b7002841857c1f028196e&amp;tag=c57a798ef65f5a7be617d8737828fd58&amp;version=1"}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Choose a simple password to encrypt the passphrase symmetrically.
The password will be required later to enable the faucet plugin through the action <code>faucet:authorize</code>.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Open the config file of the LNS application which is located under the path <code>~/.lisk/lns/config/default/config.json</code> and scroll down to the bottom of the file.
Add the required configuration options for the faucet plugin under the key <code>plugins.faucet</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>encryptedPassphrase</code>: The encrypted passphrase of the account that will provide the tokens for the faucet.</p>
</li>
<li>
<p><code>captchaSecretkey</code>: The secret API key for the captcha.</p>
</li>
<li>
<p><code>captchaSitekey</code>: The API site key for the captcha.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <a href="https://developers.google.com/recaptcha/docs/faq#id-like-to-run-automated-tests-with-recaptcha.-what-should-i-do" target="_blank" rel="noopener">free site key and secret key for reCAPTCHA</a> are used below for testing purposes.</p>
</div>
<div class="listingblock">
<div class="title">~/.lisk/lns/config/default/config.json</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">"plugins": {
    "faucet": {
        "encryptedPassphrase": "iterations=1000000&amp;cipherText=643bfbf1b6f1dc0ce740dd9fc9f27a682e476dc5de4e6c023deded4d3efe2822346226541106b42638db5ba46e0ae0a338cb78fb40bce67fdec7abbca68e20624fa6b0d7&amp;iv=8a9c461744b9e70a8ba65edd&amp;salt=3fe00b03d10b7002841857c1f028196e&amp;tag=c57a798ef65f5a7be617d8737828fd58&amp;version=1",
        "captchaSecretkey": "6LeIxAcTAAAAAGG-vFI1TnRWxMZNFuojJ4WifJWe",
        "captchaSitekey": "6LeIxAcTAAAAAJcZVRqyHh71UMIEGNQ_MXjiZKhI"
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The last step to use the Faucet plugin is to enable it via the action <code>faucet:authorize</code>.
This can be achieved with the Dashboard plugin.</p>
</div>
<div class="paragraph">
<p>Start the blockchain application again, with WebSocket API enabled:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./bin/run start --api-ws</code></pre>
</div>
</div>
<div class="paragraph">
<p>Wait until the application start is completed.</p>
</div>
<div class="paragraph">
<p>Go to <a href="http://localhost:4005" class="bare">http://localhost:4005</a> to access the dashboard.</p>
</div>
<div class="paragraph">
<p>Now go to the <code>Call actions</code> section on the Dashboard, and select the action <code>faucet:authorize</code>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/tutorials/lns/faucet-authorize-action.png" alt="faucet:authorize" width="400" height="100">
</div>
</div>
<div class="paragraph">
<p>The action expects a boolean as an input, defining if the plugin should be enabled, and also a password to decrypt the encrypted passphrase that was saved in <code>config.json</code> above.</p>
</div>
<div class="paragraph">
<p>Add the following JSON object to the field for the asset data:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
    "enable": true,
    "password": "myPassword" <i class="conum" data-value="1"></i><b>(1)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Change this to the password used above to encrypt the passphrase in the Faucet plugin configuration.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Click on the <kbd>Submit</kbd> button to invoke the action.
It should now be possible to see a confirmation that the action was invoked successfully.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/tutorials/lns/faucet-authorize-success.png" alt="faucet:authorize-success" width="400" height="100">
</div>
</div>
<div class="paragraph">
<p>It is now possible to use the faucet under <a href="http://localhost:4004" class="bare">http://localhost:4004</a> .</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/tutorials/lns/faucet.png" alt="Faucet" width="400" height="100">
</div>
</div>
</div>
<div class="sect2">
<h3 id="checking-the-functionality-of-the-lns-module"><a class="anchor" href="#checking-the-functionality-of-the-lns-module"></a>4.3. Checking the functionality of the LNS module</h3>
<div class="paragraph">
<p>Now navigate to the dashboard under <a href="http://localhost:4005" class="bare">http://localhost:4005</a>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/tutorials/lns/dashboard.png" alt="Dashboard" width="400" height="100">
</div>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
The Dashboard is only storing data for the current browser session.
Reloading the page will delete all temporary data in the accounts, block, and transaction logs of the Dashboard.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="create-new-account"><a class="anchor" href="#create-new-account"></a>4.3.1. Create new account</h4>
<div class="paragraph">
<p>Click on the <kbd>Generate new account</kbd> button in the top right corner of the page to create a new account:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/tutorials/lns/new-account.png" alt="new-account" width="400" height="100">
</div>
</div>
<div class="paragraph">
<p>The new account will also appear in the <code>My Accounts</code> section.
Clicking on the account will open the above window with the account credentials again.</p>
</div>
</div>
<div class="sect3">
<h4 id="fund-new-account"><a class="anchor" href="#fund-new-account"></a>4.3.2. Fund new account</h4>
<div class="paragraph">
<p>Before it is possible to send any transactions, it is first necessary to receive a certain amount of tokens to the new account.
The tokens will be used to pay the transaction fees for the different transaction we are going to send.</p>
</div>
<div class="paragraph">
<p>Copy the Lisk32 address of the newly created account, go to the Faucet page, and receive tokens by pasting the address, checking the captcha, and clicking on the <kbd>Request</kbd> button.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/tutorials/lns/faucet-send.png" alt="faucet-send" width="400" height="100">
</div>
</div>
<div class="paragraph">
<p>If the tokens were transferred successfully, the following confirmation message will appear as shown below:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/tutorials/lns/faucet-fund-success.png" alt="faucet-fund-success" width="400" height="100">
</div>
</div>
<div class="paragraph">
<p>Back on the Dashboard, it is possible to see the transfer transaction from the Faucet in the transactions log:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/tutorials/lns/transactions1.png" alt="transactions1" width="400" height="100">
</div>
</div>
</div>
<div class="sect3">
<h4 id="register-new-domain"><a class="anchor" href="#register-new-domain"></a>4.3.3. Register new domain</h4>
<div class="paragraph">
<p>Now use the new account to register a domain name to it, which will be used as human-readable identifier for this account.</p>
</div>
<div class="paragraph">
<p>Scroll down to the <code>Send transaction</code> section and select <code>lns:register</code> from the dropdown menu.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/tutorials/lns/send-tx-lns-register-dropdown.png" alt="send-tx-lns-register-dropdown" width="400" height="100">
</div>
</div>
<div class="paragraph">
<p>Paste the passphrase of the newly created account, and add the <a href="#schema">required asset data</a> for the <code>lns:register</code> transaction.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/tutorials/lns/send-tx-lns-register.png" alt="send-tx-lns-register" width="400" height="100">
</div>
</div>
<div class="paragraph">
<p>Click on the <kbd>Submit</kbd> button to post the transaction.
If the transaction was transferred successfully, the following confirmation message will show up:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/tutorials/lns/send-tx-lns-register-success.png" alt="send-tx-lns-register-success" width="400" height="100">
</div>
</div>
</div>
<div class="sect3">
<h4 id="call-the-actions-resolvename-and-resolvenode"><a class="anchor" href="#call-the-actions-resolvename-and-resolvenode"></a>4.3.4. Call the actions resolveName and resolveNode</h4>
<div class="paragraph">
<p>Once the <code>lns:register</code> transaction is applied, (which should be the case after ~10 seconds), a new LNS object for the domain name should be created, and a hash of this object should be added to the senders account.</p>
</div>
<div class="paragraph">
<p>This new LNS object can be queried by invoking the two actions <code>lns:resolveName</code> and <code>lns:resolveNode</code> which were previously defined in the section <a href="#actions">Actions</a>.
Navigate to the section <code>Call action</code> on the dashboard and select <code>lns:resolveName</code> from the dropdown menu.
Provide the expected input for the action in the field below:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/tutorials/lns/call-action-lns-resolvename.png" alt="call-action-lns-resolvename" width="400" height="100">
</div>
</div>
<div class="paragraph">
<p>This should return the corresponding LNS object, which was just created by registering the domain name in the previous step:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/tutorials/lns/call-action-lns-resolvename-success.png" alt="call-action-lns-resolvename-success" width="400" height="100">
</div>
</div>
<div class="paragraph">
<p>Now select <code>lns:resolveNode</code> from the dropdown menu.
Provide the expected input for the action in the field below:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/tutorials/lns/call-action-lns-resolvenode.png" alt="call-action-lns-resolvenode" width="400" height="100">
</div>
</div>
<div class="paragraph">
<p>If this returns the same result as <code>lns:resolveName</code>, it is verified that both actions work as expected.</p>
</div>
</div>
<div class="sect3">
<h4 id="define-a-reverse-lookup-address"><a class="anchor" href="#define-a-reverse-lookup-address"></a>4.3.5. Define a reverse lookup address</h4>
<div class="paragraph">
<p>Now add the newly created domain name as the reverse lookup address for our account.</p>
</div>
<div class="paragraph">
<p>This will inform the LNS app to which domain name the address should resolve to by default.
This criteria is important as a single account can register many different domain names at once.</p>
</div>
<div class="paragraph">
<p>In the <code>Send transaction</code> section, select <code>lns:reverse-lookup</code> from the dropdown menu.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/tutorials/lns/send-tx-lns-reverselookup-dropdown.png" alt="lns-reverselookup-dropdown" width="400" height="100">
</div>
</div>
<div class="paragraph">
<p>Paste the passphrase of the account as before, and add the <a href="#schema-2">required asset data</a> for the <code>lns:reverse-lookup</code> transaction.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/tutorials/lns/send-tx-lns-reverselookup.png" alt="lns-reverselookup" width="400" height="100">
</div>
</div>
<div class="paragraph">
<p>Click on the <kbd>Submit</kbd> button to post the transaction.
If the transaction was transferred successfully, the following confirmation message will appear as shown below:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/tutorials/lns/send-tx-lns-reverselookup-success.png" alt="lns-reverselookup-success" width="400" height="100">
</div>
</div>
<div class="paragraph">
<p>In the section <code>Recent Transactions</code> on the dashboard, it is possible to see an overview regarding all the sent transactions so far:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/tutorials/lns/transactions2.png" alt="transactions2" width="400" height="100">
</div>
</div>
</div>
<div class="sect3">
<h4 id="update-the-records-for-a-domain-name"><a class="anchor" href="#update-the-records-for-a-domain-name"></a>4.3.6. Update the records for a domain name</h4>
<div class="paragraph">
<p>Now, last but not least, test the <code>lns:update-records</code> transaction, which allows a user to update the records of a registered domain name.
At the beginning, there are no existing records yet, so it is now possible to create the first one as described below.</p>
</div>
<div class="paragraph">
<p>As performed previously, paste the passphrase of the account, and add the <a href="#schema-3">required asset data</a> for the <code>lns:update-records</code> transaction.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/tutorials/lns/send-tx-lns-update-records.png" alt="lns-update-records" width="400" height="100">
</div>
</div>
<div class="paragraph">
<p>Click on the <kbd>Submit</kbd> button to post the transaction.
If the transaction was transferred successfully, the following confirmation message will appear as shown below:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/tutorials/lns/send-tx-lns-update-records-success.png" alt="lns-update-records-success" width="400" height="100">
</div>
</div>
<div class="paragraph">
<p>In the section the <code>Recent Transactions</code> on the dashboard displaying the overview of all sent transactions, will now appear as shown below:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/tutorials/lns/transactions3.png" alt="transactions3" width="400" height="100">
</div>
</div>
</div>
<div class="sect3">
<h4 id="check-account-details"><a class="anchor" href="#check-account-details"></a>4.3.7. Check account details</h4>
<div class="paragraph">
<p>With the action <code>app:getAccount</code>, it is possible to get the data of an account based on its' address.</p>
</div>
<div class="paragraph">
<p>Please be aware that the action expects the account address in hexadecimal representation (not Lisk32), as shown in the example below:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/tutorials/lns/call-action-app-getaccount.png" alt="call-action-app-getaccount" width="400" height="100">
</div>
</div>
<div class="paragraph">
<p>As a result, an object is received which contains all the account data.
The data for the <code>lns</code> module is added at the bottom.
The domain name hash is already added to the property <code>lns.ownNodes</code>, and the <code>lns.reverseLookup</code> property also points to this LNS object.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/tutorials/lns/call-action-app-getaccount-success.png" alt="call-action-app-getaccount-success" width="400" height="100">
</div>
</div>
</div>
<div class="sect3">
<h4 id="perform-a-reverse-lookup-for-an-address"><a class="anchor" href="#perform-a-reverse-lookup-for-an-address"></a>4.3.8. Perform a reverse lookup for an address</h4>
<div class="paragraph">
<p>Finally, check if the reverse lookup of the account address is working as expected.
In the section <code>Call action</code>, select <code>lns:lookupAddress</code> from the dropdown menu and provide the address in the input field, again, the address needs to be in hexadecimal representation.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/tutorials/lns/call-action-lns-lookupaddress.png" alt="lns-lookupaddress" width="400" height="100">
</div>
</div>
<div class="paragraph">
<p>The reverse lookup was successful, if the expected LNS object is returned.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/tutorials/lns/call-action-lns-resolvenode-success.png" alt="lns-lookupaddress-success" width="400" height="100">
</div>
</div>
<div class="paragraph">
<p>All important features of the LNS blockchain application have now been successfully tested with help of the Dashboard plugin.</p>
</div>
</div>
</div>
</div>
</div>
  <nav class="pagination">
  <span class="prev"><a href="index.html">Lisk Name Service (LNS) Tutorial</a></span>
  <span class="next"><a href="2-frontend.html">Chapter 2: Frontend</a></span>
</nav>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <div class="footerdiv">
    <p>© 2023 Lisk Foundation</p>
    <!-- <div class="community-section">
      <p class="community-section__text">Follow Lisk on: </p>
      <div class="community-section__icons"> -->
    <div class="community_icons">
      <a href="https://lisk.chat" title="Discord" target="_blank" class="footer_icon icon-discord"><p>Discord</p></a>
      <a href="https://dev.lisk.com" title="Discourse" target="_blank" class="footer_icon icon-discourse"><p>Discourse</p></a>
      <a href="https://github.com/LiskHQ" title="GitHub" target="_blank" class="footer_icon icon-github"><p>GitHub</p></a>
      <!--    </div> -->
    </div>
  </div>
</footer>
<script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
<script async src="../../../_/js/vendor/glossary.js"></script>
<script async src="../../../_/js/vendor/tabs-block-behaviour.js"></script>
<script async src="../../../_/js/vendor/swagger-ui.js"></script>
<script async src="../../../_/js/vendor/component-versions.js"></script>
<script src="../../../_/js/vendor/custom.js"></script>

  </body>
</html>
